const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bp4oiTTd.js","assets/index-ow1R_qFW.css","assets/index-BqrU-htq.js"])))=>i.map(i=>d[i]);
import{c as S,r as l,j as s,B as i,d as n,ac as P,X as A,Y as d,a4 as x,Z as g,e as E,g as f,bH as p,dE as L,f as m,C as y,a_ as B,bA as v,b7 as b,t as C,u as z,A as T,T as F,I as q,b as D}from"./index-Bp4oiTTd.js";import{C as R}from"./Card-CqCVDSy1.js";import{C as M}from"./CardContent-BsEX79yU.js";import{S as j}from"./shield-BWCLBdfz.js";import{F as N}from"./folder-C81CAi5A.js";import{F as O}from"./file-text-DZ4vpcFj.js";import{I as V}from"./image-BjcbBBct.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],G=S("circle-x",X),H=()=>{const[r,a]=l.useState({granted:!1,message:"",loading:!0}),[o,h]=l.useState(!1),u=async()=>{try{a(t=>({...t,loading:!0}));const e=await v.checkPermissions();a({granted:e.granted,message:e.message,loading:!1})}catch(e){a({granted:!1,message:"检查权限失败: "+(e instanceof Error?e.message:String(e)),loading:!1})}},I=async()=>{try{h(!0);const e=await v.requestPermissions();a({granted:e.granted,message:e.message,loading:!1}),e.granted||a(t=>({...t,message:'权限被拒绝。请在系统设置中手动授予"所有文件访问权限"。'}))}catch(e){a({granted:!1,message:"请求权限失败: "+(e instanceof Error?e.message:String(e)),loading:!1})}finally{h(!1)}},w=async()=>{try{const{Capacitor:e}=await b(async()=>{const{Capacitor:t}=await import("./index-Bp4oiTTd.js").then(c=>c.hA);return{Capacitor:t}},__vite__mapDeps([0,1]));if(e.isNativePlatform()){const{Browser:t}=await b(async()=>{const{Browser:c}=await import("./index-BqrU-htq.js");return{Browser:c}},__vite__mapDeps([2,0,1]));await t.open({url:"app-settings:"})}else C.info("请前往：设置 > 应用 > AetherLink > 权限 > 文件和媒体 > 允许管理所有文件","权限设置指导")}catch{C.info("请手动前往：设置 > 应用 > AetherLink > 权限 > 文件和媒体 > 允许管理所有文件","权限设置指导")}};l.useEffect(()=>{u()},[]);const _=()=>r.loading?s.jsx(y,{size:24}):r.granted?s.jsx(p,{color:"success"}):s.jsx(G,{color:"error"}),k=()=>r.loading?"info":r.granted?"success":"error";return s.jsx(R,{children:s.jsxs(M,{children:[s.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[s.jsx(j,{size:24}),s.jsx(n,{variant:"h6",children:"文件访问权限"}),s.jsx(P,{icon:_(),label:r.granted?"已授权":"未授权",color:k(),variant:"outlined"})]}),s.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"为了使用文件管理功能，应用需要访问设备存储的权限。"}),s.jsxs(i,{sx:{mb:2},children:[s.jsx(n,{variant:"subtitle2",sx:{mb:1},children:"权限用途："}),s.jsxs(A,{dense:!0,children:[s.jsxs(d,{children:[s.jsx(x,{children:s.jsx(N,{size:20})}),s.jsx(g,{primary:"浏览文件和文件夹",secondary:"查看设备上的文件结构"})]}),s.jsxs(d,{children:[s.jsx(x,{children:s.jsx(O,{size:20})}),s.jsx(g,{primary:"编辑文本文件",secondary:"查看和编辑代码、文档等文件"})]}),s.jsxs(d,{children:[s.jsx(x,{children:s.jsx(V,{size:20})}),s.jsx(g,{primary:"访问媒体文件",secondary:"查看图片、视频、音频文件"})]})]})]}),s.jsx(E,{sx:{my:2}}),r.message&&s.jsx(f,{severity:r.granted?"success":"warning",sx:{mb:2},icon:r.granted?s.jsx(p,{}):s.jsx(L,{}),children:r.message}),s.jsxs(i,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[!r.granted&&s.jsx(m,{variant:"contained",onClick:I,disabled:o||r.loading,startIcon:o?s.jsx(y,{size:16}):s.jsx(j,{}),children:o?"请求中...":"授权文件访问"}),s.jsx(m,{variant:"outlined",onClick:u,disabled:r.loading,startIcon:s.jsx(j,{}),children:"检查权限状态"}),!r.granted&&s.jsx(m,{variant:"outlined",onClick:w,startIcon:s.jsx(B,{}),children:"手动设置"})]}),!r.granted&&s.jsx(f,{severity:"info",sx:{mt:2},children:s.jsxs(n,{variant:"body2",children:[s.jsx("strong",{children:"如果自动授权失败："}),s.jsx("br",{}),'1. 点击"手动设置"按钮',s.jsx("br",{}),'2. 在系统设置中找到"文件和媒体"权限',s.jsx("br",{}),'3. 开启"允许管理所有文件"选项']})})]})})},$=()=>{const r=z(),a=()=>{r("/settings/workspace")};return s.jsxs(i,{sx:{height:"100vh",display:"flex",flexDirection:"column"},children:[s.jsx(T,{position:"static",color:"default",elevation:1,children:s.jsxs(F,{children:[s.jsx(q,{edge:"start",onClick:a,sx:{mr:2},children:s.jsx(D,{})}),s.jsx(n,{variant:"h6",component:"div",sx:{flexGrow:1},children:"文件访问权限"})]})}),s.jsx(i,{sx:{flex:1,overflow:"auto",p:2},children:s.jsx(H,{})})]})};export{$ as default};
