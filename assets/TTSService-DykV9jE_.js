const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bp4oiTTd.js","assets/index-ow1R_qFW.css"])))=>i.map(i=>d[i]);
import{gG as Td,b7 as wd}from"./index-Bp4oiTTd.js";var te={},re={},ke={},ie={},M={},Zi={},ne={},Yi={},ze={},Hi={},Es;function mp(){if(Es)return Hi;Es=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.default=i;let r;const t=new Uint8Array(16);function i(){if(!r&&(r=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(t)}return Hi}var Me={},Ne={},je={},Is;function _d(){if(Is)return je;Is=1,Object.defineProperty(je,"__esModule",{value:!0}),je.default=void 0;var r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;return je.default=r,je}var As;function Ji(){if(As)return Ne;As=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.default=void 0;var r=t(_d());function t(o){return o&&o.__esModule?o:{default:o}}function i(o){return typeof o=="string"&&r.default.test(o)}var u=i;return Ne.default=u,Ne}var Ts;function Gi(){if(Ts)return Me;Ts=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.default=void 0,Me.unsafeStringify=u;var r=t(Ji());function t(n){return n&&n.__esModule?n:{default:n}}const i=[];for(let n=0;n<256;++n)i.push((n+256).toString(16).slice(1));function u(n,e=0){return i[n[e+0]]+i[n[e+1]]+i[n[e+2]]+i[n[e+3]]+"-"+i[n[e+4]]+i[n[e+5]]+"-"+i[n[e+6]]+i[n[e+7]]+"-"+i[n[e+8]]+i[n[e+9]]+"-"+i[n[e+10]]+i[n[e+11]]+i[n[e+12]]+i[n[e+13]]+i[n[e+14]]+i[n[e+15]]}function o(n,e=0){const s=u(n,e);if(!(0,r.default)(s))throw TypeError("Stringified UUID is invalid");return s}var a=o;return Me.default=a,Me}var ws;function bd(){if(ws)return ze;ws=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.default=void 0;var r=i(mp()),t=Gi();function i(c){return c&&c.__esModule?c:{default:c}}let u,o,a=0,n=0;function e(c,p,h){let d=p&&h||0;const l=p||new Array(16);c=c||{};let f=c.node||u,v=c.clockseq!==void 0?c.clockseq:o;if(f==null||v==null){const R=c.random||(c.rng||r.default)();f==null&&(f=u=[R[0]|1,R[1],R[2],R[3],R[4],R[5]]),v==null&&(v=o=(R[6]<<8|R[7])&16383)}let g=c.msecs!==void 0?c.msecs:Date.now(),S=c.nsecs!==void 0?c.nsecs:n+1;const m=g-a+(S-n)/1e4;if(m<0&&c.clockseq===void 0&&(v=v+1&16383),(m<0||g>a)&&c.nsecs===void 0&&(S=0),S>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=g,n=S,o=v,g+=122192928e5;const C=((g&268435455)*1e4+S)%4294967296;l[d++]=C>>>24&255,l[d++]=C>>>16&255,l[d++]=C>>>8&255,l[d++]=C&255;const P=g/4294967296*1e4&268435455;l[d++]=P>>>8&255,l[d++]=P&255,l[d++]=P>>>24&15|16,l[d++]=P>>>16&255,l[d++]=v>>>8|128,l[d++]=v&255;for(let R=0;R<6;++R)l[d+R]=f[R];return p||(0,t.unsafeStringify)(l)}var s=e;return ze.default=s,ze}var Le={},X={},qe={},_s;function Cp(){if(_s)return qe;_s=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=void 0;var r=t(Ji());function t(o){return o&&o.__esModule?o:{default:o}}function i(o){if(!(0,r.default)(o))throw TypeError("Invalid UUID");let a;const n=new Uint8Array(16);return n[0]=(a=parseInt(o.slice(0,8),16))>>>24,n[1]=a>>>16&255,n[2]=a>>>8&255,n[3]=a&255,n[4]=(a=parseInt(o.slice(9,13),16))>>>8,n[5]=a&255,n[6]=(a=parseInt(o.slice(14,18),16))>>>8,n[7]=a&255,n[8]=(a=parseInt(o.slice(19,23),16))>>>8,n[9]=a&255,n[10]=(a=parseInt(o.slice(24,36),16))/1099511627776&255,n[11]=a/4294967296&255,n[12]=a>>>24&255,n[13]=a>>>16&255,n[14]=a>>>8&255,n[15]=a&255,n}var u=i;return qe.default=u,qe}var bs;function yp(){if(bs)return X;bs=1,Object.defineProperty(X,"__esModule",{value:!0}),X.URL=X.DNS=void 0,X.default=n;var r=Gi(),t=i(Cp());function i(e){return e&&e.__esModule?e:{default:e}}function u(e){e=unescape(encodeURIComponent(e));const s=[];for(let c=0;c<e.length;++c)s.push(e.charCodeAt(c));return s}const o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";X.DNS=o;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";X.URL=a;function n(e,s,c){function p(h,d,l,f){var v;if(typeof h=="string"&&(h=u(h)),typeof d=="string"&&(d=(0,t.default)(d)),((v=d)===null||v===void 0?void 0:v.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let g=new Uint8Array(16+h.length);if(g.set(d),g.set(h,d.length),g=c(g),g[6]=g[6]&15|s,g[8]=g[8]&63|128,l){f=f||0;for(let S=0;S<16;++S)l[f+S]=g[S];return l}return(0,r.unsafeStringify)(g)}try{p.name=e}catch{}return p.DNS=o,p.URL=a,p}return X}var Be={},Ms;function Md(){if(Ms)return Be;Ms=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.default=void 0;function r(l){if(typeof l=="string"){const f=unescape(encodeURIComponent(l));l=new Uint8Array(f.length);for(let v=0;v<f.length;++v)l[v]=f.charCodeAt(v)}return t(u(o(l),l.length*8))}function t(l){const f=[],v=l.length*32,g="0123456789abcdef";for(let S=0;S<v;S+=8){const m=l[S>>5]>>>S%32&255,C=parseInt(g.charAt(m>>>4&15)+g.charAt(m&15),16);f.push(C)}return f}function i(l){return(l+64>>>9<<4)+14+1}function u(l,f){l[f>>5]|=128<<f%32,l[i(f)-1]=f;let v=1732584193,g=-271733879,S=-1732584194,m=271733878;for(let C=0;C<l.length;C+=16){const P=v,R=g,w=S,D=m;v=s(v,g,S,m,l[C],7,-680876936),m=s(m,v,g,S,l[C+1],12,-389564586),S=s(S,m,v,g,l[C+2],17,606105819),g=s(g,S,m,v,l[C+3],22,-1044525330),v=s(v,g,S,m,l[C+4],7,-176418897),m=s(m,v,g,S,l[C+5],12,1200080426),S=s(S,m,v,g,l[C+6],17,-1473231341),g=s(g,S,m,v,l[C+7],22,-45705983),v=s(v,g,S,m,l[C+8],7,1770035416),m=s(m,v,g,S,l[C+9],12,-1958414417),S=s(S,m,v,g,l[C+10],17,-42063),g=s(g,S,m,v,l[C+11],22,-1990404162),v=s(v,g,S,m,l[C+12],7,1804603682),m=s(m,v,g,S,l[C+13],12,-40341101),S=s(S,m,v,g,l[C+14],17,-1502002290),g=s(g,S,m,v,l[C+15],22,1236535329),v=c(v,g,S,m,l[C+1],5,-165796510),m=c(m,v,g,S,l[C+6],9,-1069501632),S=c(S,m,v,g,l[C+11],14,643717713),g=c(g,S,m,v,l[C],20,-373897302),v=c(v,g,S,m,l[C+5],5,-701558691),m=c(m,v,g,S,l[C+10],9,38016083),S=c(S,m,v,g,l[C+15],14,-660478335),g=c(g,S,m,v,l[C+4],20,-405537848),v=c(v,g,S,m,l[C+9],5,568446438),m=c(m,v,g,S,l[C+14],9,-1019803690),S=c(S,m,v,g,l[C+3],14,-187363961),g=c(g,S,m,v,l[C+8],20,1163531501),v=c(v,g,S,m,l[C+13],5,-1444681467),m=c(m,v,g,S,l[C+2],9,-51403784),S=c(S,m,v,g,l[C+7],14,1735328473),g=c(g,S,m,v,l[C+12],20,-1926607734),v=p(v,g,S,m,l[C+5],4,-378558),m=p(m,v,g,S,l[C+8],11,-2022574463),S=p(S,m,v,g,l[C+11],16,1839030562),g=p(g,S,m,v,l[C+14],23,-35309556),v=p(v,g,S,m,l[C+1],4,-1530992060),m=p(m,v,g,S,l[C+4],11,1272893353),S=p(S,m,v,g,l[C+7],16,-155497632),g=p(g,S,m,v,l[C+10],23,-1094730640),v=p(v,g,S,m,l[C+13],4,681279174),m=p(m,v,g,S,l[C],11,-358537222),S=p(S,m,v,g,l[C+3],16,-722521979),g=p(g,S,m,v,l[C+6],23,76029189),v=p(v,g,S,m,l[C+9],4,-640364487),m=p(m,v,g,S,l[C+12],11,-421815835),S=p(S,m,v,g,l[C+15],16,530742520),g=p(g,S,m,v,l[C+2],23,-995338651),v=h(v,g,S,m,l[C],6,-198630844),m=h(m,v,g,S,l[C+7],10,1126891415),S=h(S,m,v,g,l[C+14],15,-1416354905),g=h(g,S,m,v,l[C+5],21,-57434055),v=h(v,g,S,m,l[C+12],6,1700485571),m=h(m,v,g,S,l[C+3],10,-1894986606),S=h(S,m,v,g,l[C+10],15,-1051523),g=h(g,S,m,v,l[C+1],21,-2054922799),v=h(v,g,S,m,l[C+8],6,1873313359),m=h(m,v,g,S,l[C+15],10,-30611744),S=h(S,m,v,g,l[C+6],15,-1560198380),g=h(g,S,m,v,l[C+13],21,1309151649),v=h(v,g,S,m,l[C+4],6,-145523070),m=h(m,v,g,S,l[C+11],10,-1120210379),S=h(S,m,v,g,l[C+2],15,718787259),g=h(g,S,m,v,l[C+9],21,-343485551),v=a(v,P),g=a(g,R),S=a(S,w),m=a(m,D)}return[v,g,S,m]}function o(l){if(l.length===0)return[];const f=l.length*8,v=new Uint32Array(i(f));for(let g=0;g<f;g+=8)v[g>>5]|=(l[g/8]&255)<<g%32;return v}function a(l,f){const v=(l&65535)+(f&65535);return(l>>16)+(f>>16)+(v>>16)<<16|v&65535}function n(l,f){return l<<f|l>>>32-f}function e(l,f,v,g,S,m){return a(n(a(a(f,l),a(g,m)),S),v)}function s(l,f,v,g,S,m,C){return e(f&v|~f&g,l,f,S,m,C)}function c(l,f,v,g,S,m,C){return e(f&g|v&~g,l,f,S,m,C)}function p(l,f,v,g,S,m,C){return e(f^v^g,l,f,S,m,C)}function h(l,f,v,g,S,m,C){return e(v^(f|~g),l,f,S,m,C)}var d=r;return Be.default=d,Be}var Os;function Od(){if(Os)return Le;Os=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.default=void 0;var r=i(yp()),t=i(Md());function i(a){return a&&a.__esModule?a:{default:a}}var o=(0,r.default)("v3",48,t.default);return Le.default=o,Le}var xe={},Fe={},Ds;function Dd(){if(Ds)return Fe;Ds=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.default=void 0;var t={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};return Fe.default=t,Fe}var ks;function kd(){if(ks)return xe;ks=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.default=void 0;var r=u(Dd()),t=u(mp()),i=Gi();function u(n){return n&&n.__esModule?n:{default:n}}function o(n,e,s){if(r.default.randomUUID&&!e&&!n)return r.default.randomUUID();n=n||{};const c=n.random||(n.rng||t.default)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,e){s=s||0;for(let p=0;p<16;++p)e[s+p]=c[p];return e}return(0,i.unsafeStringify)(c)}var a=o;return xe.default=a,xe}var Ue={},We={},zs;function zd(){if(zs)return We;zs=1,Object.defineProperty(We,"__esModule",{value:!0}),We.default=void 0;function r(o,a,n,e){switch(o){case 0:return a&n^~a&e;case 1:return a^n^e;case 2:return a&n^a&e^n&e;case 3:return a^n^e}}function t(o,a){return o<<a|o>>>32-a}function i(o){const a=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof o=="string"){const p=unescape(encodeURIComponent(o));o=[];for(let h=0;h<p.length;++h)o.push(p.charCodeAt(h))}else Array.isArray(o)||(o=Array.prototype.slice.call(o));o.push(128);const e=o.length/4+2,s=Math.ceil(e/16),c=new Array(s);for(let p=0;p<s;++p){const h=new Uint32Array(16);for(let d=0;d<16;++d)h[d]=o[p*64+d*4]<<24|o[p*64+d*4+1]<<16|o[p*64+d*4+2]<<8|o[p*64+d*4+3];c[p]=h}c[s-1][14]=(o.length-1)*8/Math.pow(2,32),c[s-1][14]=Math.floor(c[s-1][14]),c[s-1][15]=(o.length-1)*8&4294967295;for(let p=0;p<s;++p){const h=new Uint32Array(80);for(let S=0;S<16;++S)h[S]=c[p][S];for(let S=16;S<80;++S)h[S]=t(h[S-3]^h[S-8]^h[S-14]^h[S-16],1);let d=n[0],l=n[1],f=n[2],v=n[3],g=n[4];for(let S=0;S<80;++S){const m=Math.floor(S/20),C=t(d,5)+r(m,l,f,v)+g+a[m]+h[S]>>>0;g=v,v=f,f=t(l,30)>>>0,l=d,d=C}n[0]=n[0]+d>>>0,n[1]=n[1]+l>>>0,n[2]=n[2]+f>>>0,n[3]=n[3]+v>>>0,n[4]=n[4]+g>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var u=i;return We.default=u,We}var Ns;function Nd(){if(Ns)return Ue;Ns=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.default=void 0;var r=i(yp()),t=i(zd());function i(a){return a&&a.__esModule?a:{default:a}}var o=(0,r.default)("v5",80,t.default);return Ue.default=o,Ue}var Ve={},js;function jd(){if(js)return Ve;js=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.default=void 0;var r="00000000-0000-0000-0000-000000000000";return Ve.default=r,Ve}var He={},Ls;function Ld(){if(Ls)return He;Ls=1,Object.defineProperty(He,"__esModule",{value:!0}),He.default=void 0;var r=t(Ji());function t(o){return o&&o.__esModule?o:{default:o}}function i(o){if(!(0,r.default)(o))throw TypeError("Invalid UUID");return parseInt(o.slice(14,15),16)}var u=i;return He.default=u,He}var qs;function qd(){return qs||(qs=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return n.default}});var t=p(bd()),i=p(Od()),u=p(kd()),o=p(Nd()),a=p(jd()),n=p(Ld()),e=p(Ji()),s=p(Gi()),c=p(Cp());function p(h){return h&&h.__esModule?h:{default:h}}}(Yi)),Yi}var Bs;function we(){if(Bs)return ne;Bs=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.createNoDashGuid=ne.createGuid=void 0;const r=qd(),t=()=>r.v4();ne.createGuid=t;const i=()=>t().replace(new RegExp("-","g"),"").toUpperCase();return ne.createNoDashGuid=i,ne}var xs;function xi(){return xs||(xs=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.PlatformEvent=r.EventType=void 0;const t=we();(function(u){u[u.Debug=0]="Debug",u[u.Info=1]="Info",u[u.Warning=2]="Warning",u[u.Error=3]="Error",u[u.None=4]="None"})(r.EventType||(r.EventType={}));class i{constructor(o,a){this.privName=o,this.privEventId=t.createNoDashGuid(),this.privEventTime=new Date().toISOString(),this.privEventType=a,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}r.PlatformEvent=i}(Zi)),Zi}var Fs;function Bd(){if(Fs)return M;Fs=1,Object.defineProperty(M,"__esModule",{value:!0}),M.AudioStreamNodeErrorEvent=M.AudioStreamNodeDetachedEvent=M.AudioStreamNodeAttachedEvent=M.AudioStreamNodeAttachingEvent=M.AudioStreamNodeEvent=M.AudioSourceErrorEvent=M.AudioSourceOffEvent=M.AudioSourceReadyEvent=M.AudioSourceInitializingEvent=M.AudioSourceEvent=void 0;const r=xi();class t extends r.PlatformEvent{constructor(d,l,f=r.EventType.Info){super(d,f),this.privAudioSourceId=l}get audioSourceId(){return this.privAudioSourceId}}M.AudioSourceEvent=t;class i extends t{constructor(d){super("AudioSourceInitializingEvent",d)}}M.AudioSourceInitializingEvent=i;class u extends t{constructor(d){super("AudioSourceReadyEvent",d)}}M.AudioSourceReadyEvent=u;class o extends t{constructor(d){super("AudioSourceOffEvent",d)}}M.AudioSourceOffEvent=o;class a extends t{constructor(d,l){super("AudioSourceErrorEvent",d,r.EventType.Error),this.privError=l}get error(){return this.privError}}M.AudioSourceErrorEvent=a;class n extends t{constructor(d,l,f){super(d,l),this.privAudioNodeId=f}get audioNodeId(){return this.privAudioNodeId}}M.AudioStreamNodeEvent=n;class e extends n{constructor(d,l){super("AudioStreamNodeAttachingEvent",d,l)}}M.AudioStreamNodeAttachingEvent=e;class s extends n{constructor(d,l){super("AudioStreamNodeAttachedEvent",d,l)}}M.AudioStreamNodeAttachedEvent=s;class c extends n{constructor(d,l){super("AudioStreamNodeDetachedEvent",d,l)}}M.AudioStreamNodeDetachedEvent=c;class p extends n{constructor(d,l,f){super("AudioStreamNodeErrorEvent",d,l),this.privError=f}get error(){return this.privError}}return M.AudioStreamNodeErrorEvent=p,M}var O={},Us;function xd(){if(Us)return O;Us=1,Object.defineProperty(O,"__esModule",{value:!0}),O.ConnectionMessageSentEvent=O.ConnectionMessageReceivedEvent=O.ConnectionEstablishErrorEvent=O.ConnectionErrorEvent=O.ConnectionClosedEvent=O.ConnectionEstablishedEvent=O.ConnectionStartEvent=O.ConnectionEvent=O.ServiceEvent=void 0;const r=xi();class t extends r.PlatformEvent{constructor(h,d,l=r.EventType.Info){super(h,l),this.privJsonResult=d}get jsonString(){return this.privJsonResult}}O.ServiceEvent=t;class i extends r.PlatformEvent{constructor(h,d,l=r.EventType.Info){super(h,l),this.privConnectionId=d}get connectionId(){return this.privConnectionId}}O.ConnectionEvent=i;class u extends i{constructor(h,d,l){super("ConnectionStartEvent",h),this.privUri=d,this.privHeaders=l}get uri(){return this.privUri}get headers(){return this.privHeaders}}O.ConnectionStartEvent=u;class o extends i{constructor(h){super("ConnectionEstablishedEvent",h)}}O.ConnectionEstablishedEvent=o;class a extends i{constructor(h,d,l){super("ConnectionClosedEvent",h,r.EventType.Debug),this.privReason=l,this.privStatusCode=d}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}O.ConnectionClosedEvent=a;class n extends i{constructor(h,d,l){super("ConnectionErrorEvent",h,r.EventType.Debug),this.privMessage=d,this.privType=l}get message(){return this.privMessage}get type(){return this.privType}}O.ConnectionErrorEvent=n;class e extends i{constructor(h,d,l){super("ConnectionEstablishErrorEvent",h,r.EventType.Error),this.privStatusCode=d,this.privReason=l}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}O.ConnectionEstablishErrorEvent=e;class s extends i{constructor(h,d,l){super("ConnectionMessageReceivedEvent",h),this.privNetworkReceivedTime=d,this.privMessage=l}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}O.ConnectionMessageReceivedEvent=s;class c extends i{constructor(h,d,l){super("ConnectionMessageSentEvent",h),this.privNetworkSentTime=d,this.privMessage=l}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}return O.ConnectionMessageSentEvent=c,O}var en={},$={},Ws;function K(){if(Ws)return $;Ws=1,Object.defineProperty($,"__esModule",{value:!0}),$.ObjectDisposedError=$.InvalidOperationError=$.ArgumentNullError=void 0;class r extends Error{constructor(o){super(o),this.name="ArgumentNull",this.message=o}}$.ArgumentNullError=r;class t extends Error{constructor(o){super(o),this.name="InvalidOperation",this.message=o}}$.InvalidOperationError=t;class i extends Error{constructor(o,a){super(a),this.name=o+"ObjectDisposed",this.message=a}}return $.ObjectDisposedError=i,$}var Vs;function Rp(){return Vs||(Vs=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ConnectionMessage=r.MessageType=void 0;const t=K(),i=we();var u;(function(a){a[a.Text=0]="Text",a[a.Binary=1]="Binary"})(u=r.MessageType||(r.MessageType={}));class o{constructor(n,e,s,c){if(this.privBody=null,n===u.Text&&e&&typeof e!="string")throw new t.InvalidOperationError("Payload must be a string");if(n===u.Binary&&e&&!(e instanceof ArrayBuffer))throw new t.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=n,this.privBody=e,this.privHeaders=s||{},this.privId=c||i.createNoDashGuid(),this.messageType){case u.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case u.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===u.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===u.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}r.ConnectionMessage=o}(en)),en}var Ke={},Hs;function Fd(){if(Hs)return Ke;Hs=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.ConnectionOpenResponse=void 0;let r=class{constructor(i,u){this.privStatusCode=i,this.privReason=u}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};return Ke.ConnectionOpenResponse=r,Ke}var $e={},Ks;function Ud(){if(Ks)return $e;Ks=1,Object.defineProperty($e,"__esModule",{value:!0}),$e.DeferralMap=void 0;let r=class{constructor(){this.privMap={}}add(i,u){this.privMap[i]=u}getId(i){return this.privMap[i]}complete(i,u){try{this.privMap[i].resolve(u)}catch(o){this.privMap[i].reject(o)}finally{this.privMap[i]=void 0}}};return $e.DeferralMap=r,$e}var se={},$s;function Pp(){if($s)return se;$s=1,Object.defineProperty(se,"__esModule",{value:!0}),se.SendingAgentContextMessageEvent=se.DialogEvent=void 0;const r=xi();class t extends r.PlatformEvent{constructor(o,a=r.EventType.Info){super(o,a)}}se.DialogEvent=t;class i extends t{constructor(o){super("SendingAgentContextMessageEvent"),this.privAgentConfig=o}get agentConfig(){return this.privAgentConfig}}return se.SendingAgentContextMessageEvent=i,se}var Je={},Ge={},Js;function Ep(){if(Js)return Ge;Js=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.EventSource=void 0;const r=K(),t=we();let i=class{constructor(o){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=o}onEvent(o){if(this.isDisposed())throw new r.ObjectDisposedError("EventSource");if(this.metadata)for(const a in this.metadata)a&&o.metadata&&(o.metadata[a]||(o.metadata[a]=this.metadata[a]));for(const a in this.privEventListeners)a&&this.privEventListeners[a]&&this.privEventListeners[a](o)}attach(o){const a=t.createNoDashGuid();return this.privEventListeners[a]=o,{detach:()=>(delete this.privEventListeners[a],Promise.resolve())}}attachListener(o){return this.attach(a=>o.onEvent(a))}attachConsoleListener(o){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(a=>o.onEvent(a)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};return Ge.EventSource=i,Ge}var Gs;function Wd(){if(Gs)return Je;Gs=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.Events=void 0;const r=K(),t=Ep();let i=class rs{static setEventSource(o){if(!o)throw new r.ArgumentNullError("eventSource");rs.privInstance=o}static get instance(){return rs.privInstance}};return Je.Events=i,i.privInstance=new t.EventSource,Je}var tn={},Qs;function Vd(){return Qs||(Qs=1,Object.defineProperty(tn,"__esModule",{value:!0})),tn}var rn={},Xs;function Hd(){return Xs||(Xs=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ConnectionState=void 0,function(t){t[t.None=0]="None",t[t.Connected=1]="Connected",t[t.Connecting=2]="Connecting",t[t.Disconnected=3]="Disconnected"}(r.ConnectionState||(r.ConnectionState={}))}(rn)),rn}var nn={},Zs;function Kd(){return Zs||(Zs=1,Object.defineProperty(nn,"__esModule",{value:!0})),nn}var sn={},Ys;function $d(){return Ys||(Ys=1,Object.defineProperty(sn,"__esModule",{value:!0})),sn}var on={},eo;function Jd(){return eo||(eo=1,Object.defineProperty(on,"__esModule",{value:!0})),on}var an={},to;function Gd(){return to||(to=1,Object.defineProperty(an,"__esModule",{value:!0})),an}var cn={},ro;function Qd(){return ro||(ro=1,Object.defineProperty(cn,"__esModule",{value:!0})),cn}var un={},io;function Xd(){return io||(io=1,Object.defineProperty(un,"__esModule",{value:!0})),un}var pn={},no;function Zd(){return no||(no=1,Object.defineProperty(pn,"__esModule",{value:!0})),pn}var hn={},so;function Yd(){return so||(so=1,Object.defineProperty(hn,"__esModule",{value:!0})),hn}var Qe={},oo;function Ip(){if(oo)return Qe;oo=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.List=void 0;const r=K();let t=class Ie{constructor(u){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],u)for(const o of u)this.privList.push(o)}get(u){return this.throwIfDisposed(),this.privList[u]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(u){this.throwIfDisposed(),this.insertAt(this.privList.length,u)}insertAt(u,o){this.throwIfDisposed(),u===0?this.privList.unshift(o):u===this.privList.length?this.privList.push(o):this.privList.splice(u,0,o),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(u){return this.throwIfDisposed(),this.remove(u,1)[0]}remove(u,o){this.throwIfDisposed();const a=this.privList.splice(u,o);return this.triggerSubscriptions(this.privRemoveSubscriptions),a}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(u){this.throwIfDisposed();const o=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[o]=u,{detach:()=>(delete this.privAddSubscriptions[o],Promise.resolve())}}onRemoved(u){this.throwIfDisposed();const o=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[o]=u,{detach:()=>(delete this.privRemoveSubscriptions[o],Promise.resolve())}}onDisposed(u){this.throwIfDisposed();const o=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[o]=u,{detach:()=>(delete this.privDisposedSubscriptions[o],Promise.resolve())}}join(u){return this.throwIfDisposed(),this.privList.join(u)}toArray(){const u=Array();return this.privList.forEach(o=>{u.push(o)}),u}any(u){return this.throwIfDisposed(),u?this.where(u).length()>0:this.length()>0}all(u){return this.throwIfDisposed(),this.where(u).length()===this.length()}forEach(u){this.throwIfDisposed();for(let o=0;o<this.length();o++)u(this.privList[o],o)}select(u){this.throwIfDisposed();const o=[];for(let a=0;a<this.privList.length;a++)o.push(u(this.privList[a],a));return new Ie(o)}where(u){this.throwIfDisposed();const o=new Ie;for(let a=0;a<this.privList.length;a++)u(this.privList[a],a)&&o.add(this.privList[a]);return o}orderBy(u){this.throwIfDisposed();const a=this.toArray().sort(u);return new Ie(a)}orderByDesc(u){return this.throwIfDisposed(),this.orderBy((o,a)=>u(a,o))}clone(){return this.throwIfDisposed(),new Ie(this.toArray())}concat(u){return this.throwIfDisposed(),new Ie(this.privList.concat(u.toArray()))}concatArray(u){return this.throwIfDisposed(),new Ie(this.privList.concat(u))}isDisposed(){return this.privList==null}dispose(u){this.isDisposed()||(this.privDisposeReason=u,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new r.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(u){if(u)for(const o in u)o&&u[o]()}};return Qe.List=t,Qe}var dn={},ao;function Ap(){return ao||(ao=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.marshalPromiseToCallbacks=r.Sink=r.Deferred=r.PromiseResultEventSource=r.PromiseResult=r.PromiseState=void 0;var t;(function(e){e[e.None=0]="None",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"})(t=r.PromiseState||(r.PromiseState={}));class i{constructor(s){this.throwIfError=()=>{if(this.isError)throw this.error},s.on(c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=c)},c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=c)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}r.PromiseResult=i;class u{constructor(){this.setResult=s=>{this.privOnSetResult(s)},this.setError=s=>{this.privOnSetError(s)},this.on=(s,c)=>{this.privOnSetResult=s,this.privOnSetError=c}}}r.PromiseResultEventSource=u;class o{constructor(){this.resolve=s=>(this.privResolve(s),this),this.reject=s=>(this.privReject(s),this),this.privPromise=new Promise((s,c)=>{this.privResolve=s,this.privReject=c})}get promise(){return this.privPromise}}r.Deferred=o;class a{constructor(){this.privState=t.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new u,this.privPromiseResult=new i(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(s){if(this.privState!==t.None)throw new Error("'Cannot resolve a completed promise'");this.privState=t.Resolved,this.privPromiseResultEvents.setResult(s);for(let c=0;c<this.privSuccessHandlers.length;c++)this.executeSuccessCallback(s,this.privSuccessHandlers[c],this.privErrorHandlers[c]);this.detachHandlers()}reject(s){if(this.privState!==t.None)throw new Error("'Cannot reject a completed promise'");this.privState=t.Rejected,this.privPromiseResultEvents.setError(s);for(const c of this.privErrorHandlers)this.executeErrorCallback(s,c);this.detachHandlers()}on(s,c){s==null&&(s=()=>{}),this.privState===t.None?(this.privSuccessHandlers.push(s),this.privErrorHandlers.push(c)):(this.privState===t.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,s,c):this.privState===t.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,c),this.detachHandlers())}executeSuccessCallback(s,c,p){try{c(s)}catch(h){this.executeErrorCallback(`'Unhandled callback error: ${h}'`,p)}}executeErrorCallback(s,c){if(c)try{c(s)}catch(p){throw new Error(`'Unhandled callback error: ${p}. InnerError: ${s}'`)}else throw new Error(`'Unhandled error: ${s}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}r.Sink=a;function n(e,s,c){e.then(p=>{try{s&&s(p)}catch(h){if(c)try{if(h instanceof Error){const d=h;c(d.name+": "+d.message)}else c(h)}catch{}}},p=>{if(c)try{if(p instanceof Error){const h=p;c(h.name+": "+h.message)}else c(p)}catch{}})}r.marshalPromiseToCallbacks=n}(dn)),dn}var Xe={},co;function Tp(){if(co)return Xe;co=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.Queue=void 0;const r=K(),t=Ip(),i=Ap();var u;(function(a){a[a.Dequeue=0]="Dequeue",a[a.Peek=1]="Peek"})(u||(u={}));let o=class{constructor(n){this.privPromiseStore=new t.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=n||new t.List,this.privDetachables=[],this.privSubscribers=new t.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(n){this.throwIfDispose(),this.enqueueFromPromise(new Promise(e=>e(n)))}enqueueFromPromise(n){this.throwIfDispose(),n.then(e=>{this.privList.add(e)},()=>{})}dequeue(){this.throwIfDispose();const n=new i.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:n,type:u.Dequeue}),this.drain()),n.promise}peek(){this.throwIfDispose();const n=new i.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:n,type:u.Peek}),this.drain()),n.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(n,e){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=e,this.privIsDisposing=!0;const s=this.privSubscribers;if(s){for(;s.length()>0;)s.removeFirst().deferral.resolve(void 0);this.privSubscribers===s&&(this.privSubscribers=s)}for(const c of this.privDetachables)await c.detach();if(this.privPromiseStore.length()>0&&n){const c=[];return this.privPromiseStore.toArray().forEach(p=>{c.push(p)}),Promise.all(c).finally(()=>{this.privSubscribers=null,this.privList.forEach(p=>{n(p)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(n){await this.drainAndDispose(null,n)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const n=this.privSubscribers,e=this.privList;if(n&&e){for(;e.length()>0&&n.length()>0&&!this.privIsDisposing;){const s=n.removeFirst();if(s.type===u.Peek)s.deferral.resolve(e.first());else{const c=e.removeFirst();s.deferral.resolve(c)}}this.privSubscribers===n&&(this.privSubscribers=n),this.privList===e&&(this.privList=e)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new r.InvalidOperationError(this.privDisposeReason):new r.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new r.InvalidOperationError("Queue disposing")}};return Xe.Queue=o,Xe}var Ze={},uo;function el(){if(uo)return Ze;uo=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.RawWebsocketMessage=void 0;const r=Rp(),t=K(),i=we();let u=class{constructor(a,n,e){if(this.privPayload=null,!n)throw new t.ArgumentNullError("payload");if(a===r.MessageType.Binary&&Object.getPrototypeOf(n).constructor.name!=="ArrayBuffer")throw new t.InvalidOperationError("Payload must be ArrayBuffer");if(a===r.MessageType.Text&&typeof n!="string")throw new t.InvalidOperationError("Payload must be a string");this.privMessageType=a,this.privPayload=n,this.privId=e||i.createNoDashGuid()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===r.MessageType.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===r.MessageType.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};return Ze.RawWebsocketMessage=u,Ze}var Ye={},po;function tl(){if(po)return Ye;po=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.RiffPcmEncoder=void 0;let r=class{constructor(i,u){this.privActualSampleRate=i,this.privDesiredSampleRate=u}encode(i){const u=this.downSampleAudioFrame(i,this.privActualSampleRate,this.privDesiredSampleRate);if(!u)return null;const o=u.length*2,a=new ArrayBuffer(o),n=new DataView(a);return this.floatTo16BitPCM(n,0,u),a}setString(i,u,o){for(let a=0;a<o.length;a++)i.setUint8(u+a,o.charCodeAt(a))}floatTo16BitPCM(i,u,o){for(let a=0;a<o.length;a++,u+=2){const n=Math.max(-1,Math.min(1,o[a]));i.setInt16(u,n<0?n*32768:n*32767,!0)}}downSampleAudioFrame(i,u,o){if(!i)return null;if(o===u||o>u)return i;const a=u/o,n=Math.round(i.length/a),e=new Float32Array(n);let s=0,c=0;for(;c<n;){const p=Math.round((c+1)*a);let h=0,d=0;for(;s<p&&s<i.length;)h+=i[s++],d++;e[c++]=h/d}return e}};return Ye.RiffPcmEncoder=r,Ye}var et={},ho;function rl(){if(ho)return et;ho=1,Object.defineProperty(et,"__esModule",{value:!0}),et.Stream=void 0;const r=K(),t=we(),i=Tp();let u=class{constructor(a){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=a||t.createNoDashGuid(),this.privReaderQueue=new i.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(a){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(a)}catch{}}read(){if(this.privIsReadEnded)throw new r.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async a=>((a===void 0||a.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),a))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new i.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new r.InvalidOperationError("Stream closed")}};return et.Stream=u,et}var ln={},lo;function hs(){return lo||(lo=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.TranslationStatus=void 0,function(t){t[t.Success=0]="Success",t[t.Error=1]="Error"}(r.TranslationStatus||(r.TranslationStatus={}))}(ln)),ln}var tt={},vo;function il(){if(vo)return tt;vo=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.ChunkedArrayBufferStream=void 0;const r=I();let t=class extends r.Stream{constructor(u,o){super(o),this.privTargetChunkSize=Math.round(u),this.privNextBufferReadyBytes=0}writeStreamChunk(u){if(u.isEnd||this.privNextBufferReadyBytes===0&&u.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(u);return}let o=0;for(;o<u.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=u.timeReceived);const a=Math.min(u.buffer.byteLength-o,this.privTargetChunkSize-this.privNextBufferReadyBytes),n=new Uint8Array(this.privNextBufferToWrite),e=new Uint8Array(u.buffer.slice(o,a+o));n.set(e,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=a,o+=a,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return tt.ChunkedArrayBufferStream=t,tt}var vn={},fo;function nl(){return fo||(fo=1,Object.defineProperty(vn,"__esModule",{value:!0})),vn}var rt={},go;function sl(){if(go)return rt;go=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.Timeout=void 0;let r=class Z{static load(){const i=new Map([[0,()=>{}]]),u=new Map,a="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),n=new Worker(a);return n.addEventListener("message",({data:c})=>{if(Z.isCallNotification(c)){const{params:{timerId:p}}=c,h=i.get(p);if(typeof h=="number"){const d=u.get(h);if(d===void 0||d!==p)throw new Error("The timer is in an undefined state.")}else if(typeof h<"u")h(),i.delete(p);else throw new Error("The timer is in an undefined state.")}else if(Z.isClearResponse(c)){const{id:p}=c,h=u.get(p);if(h===void 0)throw new Error("The timer is in an undefined state.");u.delete(p),i.delete(h)}else{const{error:{message:p}}=c;throw new Error(p)}}),{clearTimeout:c=>{const p=Math.random();u.set(p,c),i.set(c,p),n.postMessage({id:p,method:"clear",params:{timerId:c}})},setTimeout:(c,p)=>{const h=Math.random();return i.set(h,c),n.postMessage({id:null,method:"set",params:{delay:p,now:performance.now(),timerId:h}}),h}}}static loadWorkerTimers(){return()=>(Z.workerTimers!==null||(Z.workerTimers=Z.load()),Z.workerTimers)}static isCallNotification(i){return i.method!==void 0&&i.method==="call"}static isClearResponse(i){return i.error===null&&typeof i.id=="number"}};return rt.Timeout=r,r.workerTimers=null,r.clearTimeout=t=>r.timers().clearTimeout(t),r.setTimeout=(t,i)=>r.timers().setTimeout(t,i),r.timers=r.loadWorkerTimers(),rt}var T={},So;function ol(){if(So)return T;So=1,Object.defineProperty(T,"__esModule",{value:!0}),T.OCSPCacheUpdateErrorEvent=T.OCSPResponseRetrievedEvent=T.OCSPCacheFetchErrorEvent=T.OCSPVerificationFailedEvent=T.OCSPCacheHitEvent=T.OCSPCacheEntryNeedsRefreshEvent=T.OCSPCacheEntryExpiredEvent=T.OCSPWSUpgradeStartedEvent=T.OCSPStapleReceivedEvent=T.OCSPCacheUpdateCompleteEvent=T.OCSPDiskCacheStoreEvent=T.OCSPMemoryCacheStoreEvent=T.OCSPCacheUpdateNeededEvent=T.OCSPDiskCacheHitEvent=T.OCSPCacheMissEvent=T.OCSPMemoryCacheHitEvent=T.OCSPEvent=void 0;const r=xi();class t extends r.PlatformEvent{constructor(C,P,R){super(C,P),this.privSignature=R}}T.OCSPEvent=t;class i extends t{constructor(C){super("OCSPMemoryCacheHitEvent",r.EventType.Debug,C)}}T.OCSPMemoryCacheHitEvent=i;class u extends t{constructor(C){super("OCSPCacheMissEvent",r.EventType.Debug,C)}}T.OCSPCacheMissEvent=u;class o extends t{constructor(C){super("OCSPDiskCacheHitEvent",r.EventType.Debug,C)}}T.OCSPDiskCacheHitEvent=o;class a extends t{constructor(C){super("OCSPCacheUpdateNeededEvent",r.EventType.Debug,C)}}T.OCSPCacheUpdateNeededEvent=a;class n extends t{constructor(C){super("OCSPMemoryCacheStoreEvent",r.EventType.Debug,C)}}T.OCSPMemoryCacheStoreEvent=n;class e extends t{constructor(C){super("OCSPDiskCacheStoreEvent",r.EventType.Debug,C)}}T.OCSPDiskCacheStoreEvent=e;class s extends t{constructor(C){super("OCSPCacheUpdateCompleteEvent",r.EventType.Debug,C)}}T.OCSPCacheUpdateCompleteEvent=s;class c extends t{constructor(){super("OCSPStapleReceivedEvent",r.EventType.Debug,"")}}T.OCSPStapleReceivedEvent=c;class p extends t{constructor(C){super("OCSPWSUpgradeStartedEvent",r.EventType.Debug,C)}}T.OCSPWSUpgradeStartedEvent=p;class h extends t{constructor(C,P){super("OCSPCacheEntryExpiredEvent",r.EventType.Debug,C),this.privExpireTime=P}}T.OCSPCacheEntryExpiredEvent=h;class d extends t{constructor(C,P,R){super("OCSPCacheEntryNeedsRefreshEvent",r.EventType.Debug,C),this.privExpireTime=R,this.privStartTime=P}}T.OCSPCacheEntryNeedsRefreshEvent=d;class l extends t{constructor(C,P,R){super("OCSPCacheHitEvent",r.EventType.Debug,C),this.privExpireTime=R,this.privExpireTimeString=new Date(R).toLocaleDateString(),this.privStartTime=P,this.privStartTimeString=new Date(P).toLocaleTimeString()}}T.OCSPCacheHitEvent=l;class f extends t{constructor(C,P){super("OCSPVerificationFailedEvent",r.EventType.Debug,C),this.privError=P}}T.OCSPVerificationFailedEvent=f;class v extends t{constructor(C,P){super("OCSPCacheFetchErrorEvent",r.EventType.Debug,C),this.privError=P}}T.OCSPCacheFetchErrorEvent=v;class g extends t{constructor(C){super("OCSPResponseRetrievedEvent",r.EventType.Debug,C)}}T.OCSPResponseRetrievedEvent=g;class S extends t{constructor(C,P){super("OCSPCacheUpdateErrorEvent",r.EventType.Debug,C),this.privError=P}}return T.OCSPCacheUpdateErrorEvent=S,T}var it={},mo;function al(){if(mo)return it;mo=1,Object.defineProperty(it,"__esModule",{value:!0}),it.BackgroundEvent=void 0;const r=I();class t extends r.PlatformEvent{constructor(u){super("BackgroundEvent",r.EventType.Error),this.privError=u}get error(){return this.privError}}return it.BackgroundEvent=t,it}var Co;function I(){return Co||(Co=1,function(r){var t=ie&&ie.__createBinding||(Object.create?function(o,a,n,e){e===void 0&&(e=n),Object.defineProperty(o,e,{enumerable:!0,get:function(){return a[n]}})}:function(o,a,n,e){e===void 0&&(e=n),o[e]=a[n]}),i=ie&&ie.__exportStar||function(o,a){for(var n in o)n!=="default"&&!a.hasOwnProperty(n)&&t(a,o,n)};Object.defineProperty(r,"__esModule",{value:!0}),i(Bd(),r),i(xd(),r),i(Rp(),r),i(Fd(),r),i(Ud(),r),i(Pp(),r),i(K(),r),i(Wd(),r),i(Ep(),r),i(we(),r),i(Vd(),r),i(Hd(),r),i(Kd(),r),i($d(),r),i(Jd(),r),i(Gd(),r),i(Qd(),r),i(Xd(),r),i(Zd(),r),i(Yd(),r),i(Ip(),r),i(xi(),r),i(Ap(),r),i(Tp(),r),i(el(),r),i(tl(),r),i(rl(),r);var u=hs();Object.defineProperty(r,"TranslationStatus",{enumerable:!0,get:function(){return u.TranslationStatus}}),i(il(),r),i(nl(),r),i(sl(),r),i(ol(),r),i(al(),r)}(ie)),ie}var nt={},yo;function N(){if(yo)return nt;yo=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.HeaderNames=void 0;let r=class{};return nt.HeaderNames=r,r.AuthKey="Ocp-Apim-Subscription-Key",r.Authorization="Authorization",r.SpIDAuthKey="Apim-Subscription-Id",r.ConnectionId="X-ConnectionId",r.ContentType="Content-Type",r.CustomCommandsAppId="X-CommandsAppId",r.Path="Path",r.RequestId="X-RequestId",r.RequestStreamId="X-StreamId",r.RequestTimestamp="X-Timestamp",nt}var st={},Ro;function ds(){if(Ro)return st;Ro=1,Object.defineProperty(st,"__esModule",{value:!0}),st.AuthInfo=void 0;class r{constructor(i,u){this.privHeaderName=i,this.privToken=u}get headerName(){return this.privHeaderName}get token(){return this.privToken}}return st.AuthInfo=r,st}var Po;function cl(){if(Po)return ke;Po=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.CognitiveSubscriptionKeyAuthentication=void 0;const r=I(),t=N(),i=ds();let u=class{constructor(a){if(!a)throw new r.ArgumentNullError("subscriptionKey");this.privAuthInfo=new i.AuthInfo(t.HeaderNames.AuthKey,a)}fetch(a){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(a){return Promise.resolve(this.privAuthInfo)}};return ke.CognitiveSubscriptionKeyAuthentication=u,ke}var ot={},Eo;function ul(){if(Eo)return ot;Eo=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.CognitiveTokenAuthentication=void 0;const r=I(),t=ds(),i=N();let u=class is{constructor(a,n){if(!a)throw new r.ArgumentNullError("fetchCallback");if(!n)throw new r.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=a,this.privFetchOnExpiryCallback=n}fetch(a){return this.privFetchCallback(a).then(n=>new t.AuthInfo(i.HeaderNames.Authorization,n===void 0?void 0:is.privTokenPrefix+n))}fetchOnExpiry(a){return this.privFetchOnExpiryCallback(a).then(n=>new t.AuthInfo(i.HeaderNames.Authorization,n===void 0?void 0:is.privTokenPrefix+n))}};return ot.CognitiveTokenAuthentication=u,u.privTokenPrefix="Bearer ",ot}var fn={},Io;function pl(){return Io||(Io=1,Object.defineProperty(fn,"__esModule",{value:!0})),fn}var gn={},Ao;function hl(){return Ao||(Ao=1,Object.defineProperty(gn,"__esModule",{value:!0})),gn}var at={},oe={},U={};const dl={},ll=Object.freeze(Object.defineProperty({__proto__:null,default:dl},Symbol.toStringTag,{value:"Module"})),Te=Td(ll);var Sn={},To;function wp(){return To||(To=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.LogLevel=void 0;const t=I();Object.defineProperty(r,"LogLevel",{enumerable:!0,get:function(){return t.EventType}})}(Sn)),Sn}var ct={},wo;function A(){if(wo)return ct;wo=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.Contracts=void 0;let r=class Ae{static throwIfNullOrUndefined(i,u){if(i==null)throw new Error("throwIfNullOrUndefined:"+u)}static throwIfNull(i,u){if(i===null)throw new Error("throwIfNull:"+u)}static throwIfNullOrWhitespace(i,u){if(Ae.throwIfNullOrUndefined(i,u),(""+i).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+u)}static throwIfNullOrTooLong(i,u,o){if(Ae.throwIfNullOrUndefined(i,u),(""+i).length>o)throw new Error("throwIfNullOrTooLong:"+u+" (more than "+o.toString()+" characters)")}static throwIfNullOrTooShort(i,u,o){if(Ae.throwIfNullOrUndefined(i,u),(""+i).length<o)throw new Error("throwIfNullOrTooShort:"+u+" (less than "+o.toString()+" characters)")}static throwIfDisposed(i){if(i)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(i,u){if(Ae.throwIfNullOrUndefined(i,u),i.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+u);for(const o of i)Ae.throwIfNullOrWhitespace(o,u)}static throwIfFileDoesNotExist(i,u){Ae.throwIfNullOrWhitespace(i,u)}static throwIfNotUndefined(i,u){if(i!==void 0)throw new Error("throwIfNotUndefined:"+u)}};return ct.Contracts=r,ct}var _o;function vl(){if(_o)return U;_o=1;var r=U&&U.__createBinding||(Object.create?function(e,s,c,p){p===void 0&&(p=c),Object.defineProperty(e,p,{enumerable:!0,get:function(){return s[c]}})}:function(e,s,c,p){p===void 0&&(p=c),e[p]=s[c]}),t=U&&U.__setModuleDefault||(Object.create?function(e,s){Object.defineProperty(e,"default",{enumerable:!0,value:s})}:function(e,s){e.default=s}),i=U&&U.__importStar||function(e){if(e&&e.__esModule)return e;var s={};if(e!=null)for(var c in e)c!=="default"&&Object.hasOwnProperty.call(e,c)&&r(s,e,c);return t(s,e),s};Object.defineProperty(U,"__esModule",{value:!0}),U.ConsoleLoggingListener=void 0;const u=i(Te),o=wp(),a=A();let n=class{constructor(s=o.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=s}set logPath(s){a.Contracts.throwIfNullOrUndefined(u.openSync,`
File System access not available`),this.privLogPath=s}set enableConsoleOutput(s){this.privEnableConsoleOutput=s}onEvent(s){if(s.eventType>=this.privLogLevelFilter){const c=this.toString(s);if(this.logCallback&&this.logCallback(c),this.privLogPath&&u.writeFileSync(this.privLogPath,c+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(s.eventType){case o.LogLevel.Debug:console.debug(c);break;case o.LogLevel.Info:console.info(c);break;case o.LogLevel.Warning:console.warn(c);break;case o.LogLevel.Error:console.error(c);break;default:console.log(c);break}}}toString(s){const c=[`${s.eventTime}`,`${s.name}`],p=s;for(const h in p)if(h&&s.hasOwnProperty(h)&&h!=="eventTime"&&h!=="eventType"&&h!=="eventId"&&h!=="name"&&h!=="constructor"){const d=p[h];let l="<NULL>";d!=null&&(typeof d=="number"||typeof d=="string"?l=d.toString():l=JSON.stringify(d)),c.push(`${h}: ${l}`)}return c.join(" | ")}};return U.ConsoleLoggingListener=n,U}var mn={},bo;function fl(){return bo||(bo=1,Object.defineProperty(mn,"__esModule",{value:!0})),mn}var Cn={},yn={},Mo;function _e(){return Mo||(Mo=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.AudioStreamFormatImpl=r.AudioStreamFormat=r.AudioFormatTag=void 0;var t;(function(o){o[o.PCM=1]="PCM",o[o.MuLaw=2]="MuLaw",o[o.Siren=3]="Siren",o[o.MP3=4]="MP3",o[o.SILKSkype=5]="SILKSkype",o[o.OGG_OPUS=6]="OGG_OPUS",o[o.WEBM_OPUS=7]="WEBM_OPUS",o[o.ALaw=8]="ALaw",o[o.FLAC=9]="FLAC",o[o.OPUS=10]="OPUS",o[o.AMR_WB=11]="AMR_WB",o[o.G722=12]="G722"})(t=r.AudioFormatTag||(r.AudioFormatTag={}));class i{static getDefaultInputFormat(){return u.getDefaultInputFormat()}static getWaveFormat(a,n,e,s){return new u(a,n,e,s)}static getWaveFormatPCM(a,n,e){return new u(a,n,e)}}r.AudioStreamFormat=i;class u extends i{constructor(a=16e3,n=16,e=1,s=t.PCM){super();let c=!0;switch(s){case t.PCM:this.formatTag=1;break;case t.ALaw:this.formatTag=6;break;case t.MuLaw:this.formatTag=7;break;default:c=!1}if(this.bitsPerSample=n,this.samplesPerSec=a,this.channels=e,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),c){this.privHeader=new ArrayBuffer(44);const p=new DataView(this.privHeader);this.setString(p,0,"RIFF"),p.setUint32(4,0,!0),this.setString(p,8,"WAVEfmt "),p.setUint32(16,16,!0),p.setUint16(20,this.formatTag,!0),p.setUint16(22,this.channels,!0),p.setUint32(24,this.samplesPerSec,!0),p.setUint32(28,this.avgBytesPerSec,!0),p.setUint16(32,this.channels*(this.bitsPerSample/8),!0),p.setUint16(34,this.bitsPerSample,!0),this.setString(p,36,"data"),p.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new u}static getAudioContext(a){const n=window.AudioContext||window.webkitAudioContext||!1;if(n)return a!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new n({sampleRate:a}):new n;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(a,n,e){for(let s=0;s<e.length;s++)a.setUint8(n+s,e.charCodeAt(s))}}r.AudioStreamFormatImpl=u}(yn)),yn}var Oo;function gl(){return Oo||(Oo=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.MicAudioSource=r.AudioWorkletSourceURLPropertyName=void 0;const t=E(),i=I(),u=_e();r.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class o{constructor(n,e,s,c){this.privRecorder=n,this.deviceId=e,this.privStreams={},this.privOutputChunkSize=o.AUDIOFORMAT.avgBytesPerSec/10,this.privId=s||i.createNoDashGuid(),this.privEvents=new i.EventSource,this.privMediaStream=c||null,this.privIsClosing=!1}get format(){return Promise.resolve(o.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new i.Deferred;try{this.createAudioContext()}catch(s){if(s instanceof Error){const c=s;this.privInitializeDeferral.reject(c.name+": "+c.message)}else this.privInitializeDeferral.reject(s);return this.privInitializeDeferral.promise}const n=window.navigator;let e=n.getUserMedia||n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia;if(n.mediaDevices&&(e=(s,c,p)=>{n.mediaDevices.getUserMedia(s).then(c).catch(p)}),e){const s=()=>{this.onEvent(new i.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new i.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):e({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},c=>{this.privMediaStream=c,this.onEvent(new i.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},c=>{const p=`Error occurred during microphone initialization: ${c}`;this.privInitializeDeferral.reject(p),this.onEvent(new i.AudioSourceErrorEvent(this.privId,p))})};this.privContext.state==="suspended"?this.privContext.resume().then(s).catch(c=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${c}`)}):s()}else{const s="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(s),this.onEvent(new i.AudioSourceErrorEvent(s,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(n){return this.onEvent(new i.AudioStreamNodeAttachingEvent(this.privId,n)),this.listen(n).then(e=>(this.onEvent(new i.AudioStreamNodeAttachedEvent(this.privId,n)),{detach:async()=>(e.readEnded(),delete this.privStreams[n],this.onEvent(new i.AudioStreamNodeDetachedEvent(this.privId,n)),this.turnOff()),id:()=>n,read:()=>e.read()}))}detach(n){n&&this.privStreams[n]&&(this.privStreams[n].close(),delete this.privStreams[n],this.onEvent(new i.AudioStreamNodeDetachedEvent(this.privId,n)))}async turnOff(){for(const n in this.privStreams)if(n){const e=this.privStreams[n];e&&e.close()}this.onEvent(new i.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(n=>({bitspersample:o.AUDIOFORMAT.bitsPerSample,channelcount:o.AUDIOFORMAT.channels,connectivity:t.connectivity.Unknown,manufacturer:"Speech SDK",model:n,samplerate:o.AUDIOFORMAT.samplesPerSec,type:t.type.Microphones}))}setProperty(n,e){if(n===r.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(e);else throw new Error("Property '"+n+"' is not supported on Microphone.")}getMicrophoneLabel(){const n="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(n);this.privMicrophoneLabel=n;const e=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(e===void 0)return Promise.resolve(this.privMicrophoneLabel);const s=new i.Deferred;return navigator.mediaDevices.enumerateDevices().then(c=>{for(const p of c)if(p.deviceId===e){this.privMicrophoneLabel=p.label;break}s.resolve(this.privMicrophoneLabel)},()=>s.resolve(this.privMicrophoneLabel)),s.promise}async listen(n){await this.turnOn();const e=new i.ChunkedArrayBufferStream(this.privOutputChunkSize,n);this.privStreams[n]=e;try{this.privRecorder.record(this.privContext,this.privMediaStream,e)}catch(c){throw this.onEvent(new i.AudioStreamNodeErrorEvent(this.privId,n,c)),c}return e}onEvent(n){this.privEvents.onEvent(n),i.Events.instance.onEvent(n)}createAudioContext(){this.privContext||(this.privContext=u.AudioStreamFormatImpl.getAudioContext(o.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let n=!1;"close"in this.privContext&&(n=!0),n?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}r.MicAudioSource=o,o.AUDIOFORMAT=u.AudioStreamFormat.getDefaultInputFormat()}(Cn)),Cn}var ut={},Do;function Sl(){if(Do)return ut;Do=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.FileAudioSource=void 0;const r=E(),t=I(),i=_e();let u=class{constructor(a,n,e){this.privStreams={},this.privHeaderEnd=44,this.privId=e||t.createNoDashGuid(),this.privEvents=new t.EventSource,this.privSource=a,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=a.name:this.privFilename=n||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const a=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new t.AudioSourceErrorEvent(a,"")),Promise.reject(a)}this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(a){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,a));const n=await this.upload(a);return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,a)),Promise.resolve({detach:async()=>{n.readEnded(),delete this.privStreams[a],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,a)),await this.turnOff()},id:()=>a,read:()=>n.read()})}detach(a){a&&this.privStreams[a]&&(this.privStreams[a].close(),delete this.privStreams[a],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,a)))}turnOff(){for(const a in this.privStreams)if(a){const n=this.privStreams[a];n&&!n.isClosed&&n.close()}return this.onEvent(new t.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(a=>Promise.resolve({bitspersample:a.bitsPerSample,channelcount:a.channels,connectivity:r.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:a.samplesPerSec,type:r.type.File}))}readHeader(){const n=this.privSource.slice(0,4296),e=new t.Deferred,s=c=>{const p=new DataView(c),h=S=>String.fromCharCode(p.getUint8(S),p.getUint8(S+1),p.getUint8(S+2),p.getUint8(S+3));if(h(0)!=="RIFF"){e.reject("Invalid WAV header in file, RIFF was not found");return}if(h(8)!=="WAVE"||h(12)!=="fmt "){e.reject("Invalid WAV header in file, WAVEfmt was not found");return}const d=p.getInt32(16,!0),l=p.getUint16(22,!0),f=p.getUint32(24,!0),v=p.getUint16(34,!0);let g=36+Math.max(d-16,0);for(;h(g)!=="data";g+=2)if(g>4288){e.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=g+8,e.resolve(i.AudioStreamFormat.getWaveFormatPCM(f,v,l))};if(typeof window<"u"&&typeof Blob<"u"&&n instanceof Blob){const c=new FileReader;c.onload=p=>{const h=p.target.result;s(h)},c.readAsArrayBuffer(n)}else{const c=n;s(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength))}return e.promise}async upload(a){const n=e=>{const s=`Error occurred while processing '${this.privFilename}'. ${e}`;throw this.onEvent(new t.AudioStreamNodeErrorEvent(this.privId,a,s)),new Error(s)};try{await this.turnOn();const e=await this.privAudioFormatPromise,s=new t.ChunkedArrayBufferStream(e.avgBytesPerSec/10,a);this.privStreams[a]=s;const c=this.privSource.slice(this.privHeaderEnd),p=h=>{s.isClosed||(s.writeStreamChunk({buffer:h,isEnd:!1,timeReceived:Date.now()}),s.close())};if(typeof window<"u"&&typeof Blob<"u"&&c instanceof Blob){const h=new FileReader;h.onerror=d=>n(d.toString()),h.onload=d=>{const l=d.target.result;p(l)},h.readAsArrayBuffer(c)}else{const h=c;p(h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength))}return s}catch(e){n(e)}}onEvent(a){this.privEvents.onEvent(a),t.Events.instance.onEvent(a)}};return ut.FileAudioSource=u,ut}var pt={},ko;function ml(){if(ko)return pt;ko=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.PcmRecorder=void 0;const r=I();class t{constructor(u){this.privStopInputOnRelease=u}record(u,o,a){const e=new r.RiffPcmEncoder(u.sampleRate,16e3),s=u.createMediaStreamSource(o),c=()=>{const h=(()=>{let d=0;try{return u.createScriptProcessor(d,1,1)}catch{d=2048;let f=u.sampleRate;for(;d<16384&&f>=32e3;)d<<=1,f>>=1;return u.createScriptProcessor(d,1,1)}})();h.onaudioprocess=d=>{const l=d.inputBuffer.getChannelData(0);if(a&&!a.isClosed){const f=e.encode(l);f&&a.writeStreamChunk({buffer:f,isEnd:!1,timeReceived:Date.now()})}},s.connect(h),h.connect(u.destination),this.privMediaResources={scriptProcessorNode:h,source:s,stream:o}},p=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(u.audioWorklet&&!p){if(!this.privSpeechProcessorScript){const h=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,d=new Blob([h],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(d)}u.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const h=new AudioWorkletNode(u,"speech-processor");h.port.onmessage=d=>{const l=d.data;if(a&&!a.isClosed){const f=e.encode(l);f&&a.writeStreamChunk({buffer:f,isEnd:!1,timeReceived:Date.now()})}},s.connect(h),h.connect(u.destination),this.privMediaResources={scriptProcessorNode:h,source:s,stream:o}}).catch(()=>{c()})}else try{c()}catch(h){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${h}`)}}releaseMediaResources(u){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(u.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(o=>o.stop()),this.privMediaResources.source=null))}setWorkletUrl(u){this.privSpeechProcessorScript=u}}return pt.PcmRecorder=t,pt}var ht={},B={},zo;function _p(){if(zo)return B;zo=1;var r=B&&B.__createBinding||(Object.create?function(d,l,f,v){v===void 0&&(v=f),Object.defineProperty(d,v,{enumerable:!0,get:function(){return l[f]}})}:function(d,l,f,v){v===void 0&&(v=f),d[v]=l[f]}),t=B&&B.__setModuleDefault||(Object.create?function(d,l){Object.defineProperty(d,"default",{enumerable:!0,value:l})}:function(d,l){d.default=l}),i=B&&B.__importStar||function(d){if(d&&d.__esModule)return d;var l={};if(d!=null)for(var f in d)f!=="default"&&Object.hasOwnProperty.call(d,f)&&r(l,d,f);return t(l,d),l},u=B&&B.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(B,"__esModule",{value:!0}),B.WebsocketMessageAdapter=void 0;const o=i(Te),a=i(Te),n=u(Te),e=u(Te),s=u(Te),c=N(),p=I();let h=class ns{constructor(l,f,v,g,S,m){if(!l)throw new p.ArgumentNullError("uri");if(!v)throw new p.ArgumentNullError("messageFormatter");this.proxyInfo=g,this.privConnectionEvents=new p.EventSource,this.privConnectionId=f,this.privMessageFormatter=v,this.privConnectionState=p.ConnectionState.None,this.privUri=l,this.privHeaders=S,this.privEnableCompression=m,this.privHeaders[c.HeaderNames.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===p.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new p.Deferred,this.privCertificateValidatedDeferral=new p.Deferred,this.privConnectionState=p.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!ns.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{const l={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve(),l.agent=this.getAgent();let v=new URL(this.privUri).protocol;v?.toLocaleLowerCase()==="wss:"?v="https:":v?.toLocaleLowerCase()==="ws:"&&(v="http:"),l.agent.protocol=v,this.privWebsocketClient=new s.default(this.privUri,l)}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new p.Queue,this.privDisconnectDeferral=new p.Deferred,this.privSendMessageQueue=new p.Queue,this.processSendQueue().catch(l=>{p.Events.instance.onEvent(new p.BackgroundEvent(l))})}catch(l){return this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(500,l)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new p.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=p.ConnectionState.Connected,this.onEvent(new p.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(200,""))},l=>{this.privConnectionEstablishDeferral.reject(l)})},this.privWebsocketClient.onerror=l=>{this.onEvent(new p.ConnectionErrorEvent(this.privConnectionId,l.message,l.type)),this.privLastErrorReceived=l.message},this.privWebsocketClient.onclose=l=>{this.privConnectionState===p.ConnectionState.Connecting?(this.privConnectionState=p.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(l.code,l.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=p.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new p.ConnectionClosedEvent(this.privConnectionId,l.code,l.reason))),this.onClose(l.code,l.reason).catch(f=>{p.Events.instance.onEvent(new p.BackgroundEvent(f))})},this.privWebsocketClient.onmessage=l=>{const f=new Date().toISOString();if(this.privConnectionState===p.ConnectionState.Connected){const v=new p.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(v.promise),l.data instanceof ArrayBuffer){const g=new p.RawWebsocketMessage(p.MessageType.Binary,l.data);this.privMessageFormatter.toConnectionMessage(g).then(S=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,f,S)),v.resolve(S)},S=>{v.reject(`Invalid binary message format. Error: ${S}`)})}else{const g=new p.RawWebsocketMessage(p.MessageType.Text,l.data);this.privMessageFormatter.toConnectionMessage(g).then(S=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,f,S)),v.resolve(S)},S=>{v.reject(`Invalid text message format. Error: ${S}`)})}}},this.privConnectionEstablishDeferral.promise}send(l){if(this.privConnectionState!==p.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${p.ConnectionState[this.privConnectionState]} state`);const f=new p.Deferred,v=new p.Deferred;return this.privSendMessageQueue.enqueueFromPromise(v.promise),this.privMessageFormatter.fromConnectionMessage(l).then(g=>{v.resolve({Message:l,RawWebsocketMessage:g,sendStatusDeferral:f})},g=>{v.reject(`Error formatting the message. ${g}`)}),f.promise}read(){return this.privConnectionState!==p.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(l){if(this.privWebsocketClient)this.privConnectionState!==p.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,l||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(l){try{if(!l)return Promise.resolve();if(this.onEvent(new p.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),l.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(l.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+l.Message.id+" "+new Error().stack);return Promise.resolve()}catch(f){return Promise.reject(`websocket send error: ${f}`)}}async onClose(l,f){const v=`Connection closed. ${l}: ${f}`;this.privConnectionState=p.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},v),await this.privSendMessageQueue.drainAndDispose(g=>{g.sendStatusDeferral.reject(v)},v)}async processSendQueue(){for(;;){const f=await this.privSendMessageQueue.dequeue();if(!f)return;try{await this.sendRawMessage(f),f.sendStatusDeferral.resolve()}catch(v){f.sendStatusDeferral.reject(v)}}}onEvent(l){this.privConnectionEvents.onEvent(l),p.Events.instance.onEvent(l)}getAgent(){const l=new n.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(l.proxyInfo=this.proxyInfo),l}static GetProxyAgent(l){const f={host:l.HostName,port:l.Port};return l.UserName?f.headers={"Proxy-Authentication":"Basic "+new Buffer(`${l.UserName}:${l.Password===void 0?"":l.Password}`).toString("base64")}:f.headers={},f.headers.requestOCSP="true",new e.default(f)}createConnection(l,f){let v;if(f={...f,requestOCSP:!0,servername:f.host},this.proxyInfo){const S=ns.GetProxyAgent(this.proxyInfo);v=new Promise((m,C)=>{S.callback(l,f,(P,R)=>{P?C(P):m(R)})})}else f.secureEndpoint?v=Promise.resolve(a.connect(f)):v=Promise.resolve(o.connect(f));return v}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};return B.WebsocketMessageAdapter=h,h.forceNpmWebSocket=!1,B}var No;function Cl(){if(No)return ht;No=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.WebsocketConnection=void 0;const r=I(),t=_p();let i=class{constructor(o,a,n,e,s,c=!1,p){if(this.privIsDisposed=!1,!o)throw new r.ArgumentNullError("uri");if(!e)throw new r.ArgumentNullError("messageFormatter");this.privMessageFormatter=e;let h="",d=0;if(a){for(const l in a)if(l){h+=d===0&&o.indexOf("?")===-1?"?":"&";const f=encodeURIComponent(l);h+=f;let v=a[l];v&&(v=encodeURIComponent(v),h+=`=${v}`),d++}}if(n){for(const l in n)if(l){h+=d===0&&o.indexOf("?")===-1?"?":"&";const f=encodeURIComponent(n[l]);h+=`${l}=${f}`,d++}}this.privUri=o+h,this.privId=p||r.createNoDashGuid(),this.privConnectionMessageAdapter=new t.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,s,n,c)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(o){return this.privConnectionMessageAdapter.send(o)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};return ht.WebsocketConnection=i,ht}var dt={},jo;function yl(){if(jo)return dt;jo=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.ReplayableAudioNode=void 0;let r=class{constructor(u,o){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=u,this.privBytesPerSecond=o}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const u=this.privReplayOffset-this.privBufferStartOffset;let o=Math.round(u*this.privBytesPerSecond*1e-7);o%2!==0&&o++;let a=0;for(;a<this.privBuffers.length&&o>=this.privBuffers[a].chunk.buffer.byteLength;)o-=this.privBuffers[a++].chunk.buffer.byteLength;if(a<this.privBuffers.length){const n=this.privBuffers[a].chunk.buffer.slice(o);return this.privReplayOffset+=n.byteLength/this.privBytesPerSecond*1e7,a===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:n,isEnd:!1,timeReceived:this.privBuffers[a].chunk.timeReceived})}}return this.privAudioNode.read().then(u=>(u&&u.buffer&&(this.privBuffers.push(new t(u,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=u.buffer.byteLength),u))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(u){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=u;const o=u-this.privBufferStartOffset;let a=Math.round(o*this.privBytesPerSecond*1e-7),n=0;for(;n<this.privBuffers.length&&a>=this.privBuffers[n].chunk.buffer.byteLength;)a-=this.privBuffers[n++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(u-a/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(n)}findTimeAtOffset(u){if(u<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const o of this.privBuffers){const a=o.byteOffset/this.privBytesPerSecond*1e7,n=a+o.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(u>=a&&u<=n)return o.chunk.timeReceived}return 0}};dt.ReplayableAudioNode=r;class t{constructor(u,o,a){this.chunk=u,this.serial=o,this.byteOffset=a}}return dt}var lt={},Rn={},J={},W={},Lo;function bp(){if(Lo)return W;Lo=1;var r=W&&W.__createBinding||(Object.create?function(n,e,s,c){c===void 0&&(c=s),Object.defineProperty(n,c,{enumerable:!0,get:function(){return e[s]}})}:function(n,e,s,c){c===void 0&&(c=s),n[c]=e[s]}),t=W&&W.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),i=W&&W.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var s in n)s!=="default"&&Object.hasOwnProperty.call(n,s)&&r(e,n,s);return t(e,n),e};Object.defineProperty(W,"__esModule",{value:!0}),W.AudioFileWriter=void 0;const u=i(Te),o=A();let a=class{constructor(e){o.Contracts.throwIfNullOrUndefined(u.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=u.openSync(e,"w")}set format(e){o.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let s=0;this.privAudioFormat.hasHeader&&(s=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=u.createWriteStream("",{fd:this.privFd,start:s,autoClose:!1}))}write(e){o.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),u.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),u.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};return W.AudioFileWriter=a,W}var x={},qo;function Mp(){if(qo)return x;qo=1,Object.defineProperty(x,"__esModule",{value:!0}),x.PullAudioInputStreamImpl=x.PullAudioInputStream=x.PushAudioInputStreamImpl=x.PushAudioInputStream=x.AudioInputStream=void 0;const r=E(),t=I(),i=we(),u=y(),o=_e();let a=class{constructor(){}static createPushStream(h){return n.create(h)}static createPullStream(h,d){return s.create(h,d)}};x.AudioInputStream=a;class n extends a{static create(h){return new e(h)}}x.PushAudioInputStream=n;class e extends n{constructor(h){super(),h===void 0?this.privFormat=o.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=h,this.privEvents=new t.EventSource,this.privId=i.createNoDashGuid(),this.privStream=new t.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(h){this.privStream.writeStreamChunk({buffer:h,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(h){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,h)),await this.turnOn();const d=this.privStream;return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,h)),{detach:async()=>(this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,h)),this.turnOff()),id:()=>h,read:()=>d.read()}}detach(h){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,h))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:r.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:r.type.Stream})}onEvent(h){this.privEvents.onEvent(h),t.Events.instance.onEvent(h)}toBuffer(h){const d=Buffer.alloc(h.byteLength),l=new Uint8Array(h);for(let f=0;f<d.length;++f)d[f]=l[f];return d}}x.PushAudioInputStreamImpl=e;class s extends a{constructor(){super()}static create(h,d){return new c(h,d)}}x.PullAudioInputStream=s;class c extends s{constructor(h,d){super(),d===void 0?this.privFormat=u.AudioStreamFormat.getDefaultInputFormat():this.privFormat=d,this.privEvents=new t.EventSource,this.privId=i.createNoDashGuid(),this.privCallback=h,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(h){return this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,h)),await this.turnOn(),this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,h)),{detach:()=>(this.privCallback.close(),this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,h)),this.turnOff()),id:()=>h,read:()=>{let d=0,l;for(;d<this.privBufferSize;){const f=new ArrayBuffer(this.privBufferSize-d),v=this.privCallback.read(f);if(l===void 0?l=f:new Int8Array(l).set(new Int8Array(f),d),v===0)break;d+=v}return Promise.resolve({buffer:l.slice(0,d),isEnd:this.privIsClosed||d===0,timeReceived:Date.now()})}}}detach(h){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,h))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:r.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:r.type.Stream})}onEvent(h){this.privEvents.onEvent(h),t.Events.instance.onEvent(h)}}return x.PullAudioInputStreamImpl=c,x}var F={},vt={},Pn={},Bo;function Op(){return Bo||(Bo=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SpeechSynthesisOutputFormat=void 0,function(t){t[t.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",t[t.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",t[t.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",t[t.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",t[t.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",t[t.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",t[t.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",t[t.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",t[t.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",t[t.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",t[t.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",t[t.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",t[t.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",t[t.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",t[t.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",t[t.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",t[t.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",t[t.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",t[t.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",t[t.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",t[t.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",t[t.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",t[t.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",t[t.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",t[t.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",t[t.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",t[t.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",t[t.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",t[t.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",t[t.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",t[t.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",t[t.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",t[t.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",t[t.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",t[t.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",t[t.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",t[t.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",t[t.AmrWb16000Hz=37]="AmrWb16000Hz",t[t.G72216Khz64Kbps=38]="G72216Khz64Kbps"}(r.SpeechSynthesisOutputFormat||(r.SpeechSynthesisOutputFormat={}))}(Pn)),Pn}var xo;function Fi(){if(xo)return vt;xo=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.AudioOutputFormatImpl=void 0;const r=Op(),t=_e();class i extends t.AudioStreamFormatImpl{constructor(o,a,n,e,s,c,p,h,d){super(n,c,a,o),this.formatTag=o,this.avgBytesPerSec=e,this.blockAlign=s,this.priAudioFormatString=p,this.priRequestAudioFormatString=h,this.priHasHeader=d}static fromSpeechSynthesisOutputFormat(o){return o===void 0?i.getDefaultOutputFormat():i.fromSpeechSynthesisOutputFormatString(i.SpeechSynthesisOutputFormatToString[o])}static fromSpeechSynthesisOutputFormatString(o){switch(o){case"raw-8khz-8bit-mono-mulaw":return new i(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,o,o,!1);case"riff-16khz-16kbps-mono-siren":return new i(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,o,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new i(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,o,o,!1);case"audio-16khz-32kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,16e3,4096,2,16,o,o,!1);case"audio-16khz-128kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,16e3,16384,2,16,o,o,!1);case"audio-16khz-64kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,16e3,8192,2,16,o,o,!1);case"audio-24khz-48kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,24e3,6144,2,16,o,o,!1);case"audio-24khz-96kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,24e3,12288,2,16,o,o,!1);case"audio-24khz-160kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,24e3,20480,2,16,o,o,!1);case"raw-16khz-16bit-mono-truesilk":return new i(t.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,o,o,!1);case"riff-8khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,o,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,o,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new i(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,o,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,o,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,o,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,o,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new i(t.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,o,o,!1);case"ogg-24khz-16bit-mono-opus":return new i(t.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,o,o,!1);case"raw-48khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,o,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,o,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,48e3,12288,2,16,o,o,!1);case"audio-48khz-192kbitrate-mono-mp3":return new i(t.AudioFormatTag.MP3,1,48e3,24576,2,16,o,o,!1);case"ogg-48khz-16bit-mono-opus":return new i(t.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,o,o,!1);case"webm-16khz-16bit-mono-opus":return new i(t.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,o,o,!1);case"webm-24khz-16bit-mono-opus":return new i(t.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,o,o,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new i(t.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,o,o,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new i(t.AudioFormatTag.OPUS,1,16e3,4e3,2,16,o,o,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new i(t.AudioFormatTag.OPUS,1,24e3,6e3,2,16,o,o,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new i(t.AudioFormatTag.OPUS,1,24e3,3e3,2,16,o,o,!1);case"audio-24khz-16bit-mono-flac":return new i(t.AudioFormatTag.FLAC,1,24e3,24e3,2,16,o,o,!1);case"audio-48khz-16bit-mono-flac":return new i(t.AudioFormatTag.FLAC,1,48e3,3e4,2,16,o,o,!1);case"raw-24khz-16bit-mono-truesilk":return new i(t.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,o,o,!1);case"raw-8khz-8bit-mono-alaw":return new i(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,o,o,!1);case"riff-8khz-8bit-mono-alaw":return new i(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,o,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,22050,44100,2,16,o,o,!1);case"riff-22050hz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,22050,44100,2,16,o,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,44100,88200,2,16,o,o,!1);case"riff-44100hz-16bit-mono-pcm":return new i(t.AudioFormatTag.PCM,1,44100,88200,2,16,o,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new i(t.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,o,o,!1);case"g722-16khz-64kbps":return new i(t.AudioFormatTag.G722,1,16e3,8e3,2,16,o,o,!1);case"riff-16khz-16bit-mono-pcm":default:return new i(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return i.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(o){if(this.priHasHeader){const a=new DataView(this.privHeader);a.setUint32(4,o+this.privHeader.byteLength-8,!0),a.setUint32(40,o,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(o){if(!this.hasHeader)return o;this.updateHeader(o.byteLength);const a=new Uint8Array(o.byteLength+this.header.byteLength);return a.set(new Uint8Array(this.header),0),a.set(new Uint8Array(o),this.header.byteLength),a.buffer}}return vt.AudioOutputFormatImpl=i,i.SpeechSynthesisOutputFormatToString={[r.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[r.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[r.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[r.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[r.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[r.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[r.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[r.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[r.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[r.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[r.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[r.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[r.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[r.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[r.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[r.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[r.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"},vt}var Fo;function Oe(){if(Fo)return F;Fo=1,Object.defineProperty(F,"__esModule",{value:!0}),F.PushAudioOutputStreamImpl=F.PushAudioOutputStream=F.PullAudioOutputStreamImpl=F.PullAudioOutputStream=F.AudioOutputStream=void 0;const r=I(),t=A(),i=Fi();let u=class{constructor(){}static createPullStream(){return o.create()}};F.AudioOutputStream=u;class o extends u{static create(){return new a}}F.PullAudioOutputStream=o;class a extends o{constructor(){super(),this.privId=r.createNoDashGuid(),this.privStream=new r.Stream}set format(c){c==null&&(this.privFormat=i.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=c}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(c){const p=new Int8Array(c);let h=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>c.byteLength)return p.set(this.privLastChunkView.slice(0,c.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(c.byteLength),Promise.resolve(c.byteLength);p.set(this.privLastChunkView),h=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;h<c.byteLength&&!this.privStream.isReadEnded;){const d=await this.privStream.read();if(d!==void 0&&!d.isEnd){let l;d.buffer.byteLength>c.byteLength-h?(l=d.buffer.slice(0,c.byteLength-h),this.privLastChunkView=new Int8Array(d.buffer.slice(c.byteLength-h))):l=d.buffer,p.set(new Int8Array(l),h),h+=l.byteLength}else this.privStream.readEnded()}return h}write(c){t.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:c,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}F.PullAudioOutputStreamImpl=a;class n extends u{constructor(){super()}static create(c){return new e(c)}}F.PushAudioOutputStream=n;class e extends n{constructor(c){super(),this.privId=r.createNoDashGuid(),this.privCallback=c}set format(c){}write(c){this.privCallback.write&&this.privCallback.write(c)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}return F.PushAudioOutputStreamImpl=e,F}var Uo;function kp(){if(Uo)return J;Uo=1,Object.defineProperty(J,"__esModule",{value:!0}),J.AudioOutputConfigImpl=J.AudioConfigImpl=J.AudioConfig=void 0;const r=k(),t=A(),i=y(),u=bp(),o=Mp(),a=Oe();let n=class Dp{static fromDefaultMicrophoneInput(){const p=new r.PcmRecorder(!0);return new e(new r.MicAudioSource(p))}static fromMicrophoneInput(p){const h=new r.PcmRecorder(!0);return new e(new r.MicAudioSource(h,p))}static fromWavFileInput(p,h="unnamedBuffer.wav"){return new e(new r.FileAudioSource(p,h))}static fromStreamInput(p){if(p instanceof i.PullAudioInputStreamCallback)return new e(new o.PullAudioInputStreamImpl(p));if(p instanceof i.AudioInputStream)return new e(p);if(typeof MediaStream<"u"&&p instanceof MediaStream){const h=new r.PcmRecorder(!1);return new e(new r.MicAudioSource(h,null,null,p))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new s(new i.SpeakerAudioDestination)}static fromSpeakerOutput(p){if(p===void 0)return Dp.fromDefaultSpeakerOutput();if(p instanceof i.SpeakerAudioDestination)return new s(p);throw new Error("Not Supported Type")}static fromAudioFileOutput(p){return new s(new u.AudioFileWriter(p))}static fromStreamOutput(p){if(p instanceof i.PushAudioOutputStreamCallback)return new s(new a.PushAudioOutputStreamImpl(p));if(p instanceof i.PushAudioOutputStream)return new s(p);if(p instanceof i.PullAudioOutputStream)return new s(p);throw new Error("Not Supported Type")}};J.AudioConfig=n;class e extends n{constructor(p){super(),this.privSource=p}get format(){return this.privSource.format}close(p,h){this.privSource.turnOff().then(()=>{p&&p()},d=>{h&&h(d)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(p){return this.privSource.attach(p)}detach(p){return this.privSource.detach(p)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(p,h){if(t.Contracts.throwIfNull(h,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(p,h);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(p,h){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(p,h);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}J.AudioConfigImpl=e;class s extends n{constructor(p){super(),this.privDestination=p}set format(p){this.privDestination.format=p}write(p){this.privDestination.write(p)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return J.AudioOutputConfigImpl=s,J}var En={},Wo;function Rl(){return Wo||(Wo=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.CancellationReason=void 0,function(t){t[t.Error=0]="Error",t[t.EndOfStream=1]="EndOfStream"}(r.CancellationReason||(r.CancellationReason={}))}(En)),En}var ft={},Vo;function Pl(){if(Vo)return ft;Vo=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.PullAudioInputStreamCallback=void 0;let r=class{};return ft.PullAudioInputStreamCallback=r,ft}var gt={},Ho;function El(){if(Ho)return gt;Ho=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.PushAudioOutputStreamCallback=void 0;let r=class{};return gt.PushAudioOutputStreamCallback=r,gt}var St={},Ko;function Il(){if(Ko)return St;Ko=1,Object.defineProperty(St,"__esModule",{value:!0}),St.KeywordRecognitionModel=void 0;const r=A();let t=class{constructor(){this.privDisposed=!1}static fromFile(u){throw r.Contracts.throwIfFileDoesNotExist(u,"fileName"),new Error("Not yet implemented.")}static fromStream(u){throw r.Contracts.throwIfNull(u,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};return St.KeywordRecognitionModel=t,St}var mt={},$o;function Al(){if($o)return mt;$o=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.SessionEventArgs=void 0;let r=class{constructor(i){this.privSessionId=i}get sessionId(){return this.privSessionId}};return mt.SessionEventArgs=r,mt}var Ct={},Jo;function Tl(){if(Jo)return Ct;Jo=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.RecognitionEventArgs=void 0;const r=y();let t=class extends r.SessionEventArgs{constructor(u,o){super(o),this.privOffset=u}get offset(){return this.privOffset}};return Ct.RecognitionEventArgs=t,Ct}var In={},Go;function wl(){return Go||(Go=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.OutputFormat=void 0,function(t){t[t.Simple=0]="Simple",t[t.Detailed=1]="Detailed"}(r.OutputFormat||(r.OutputFormat={}))}(In)),In}var yt={},Qo;function _l(){if(Qo)return yt;Qo=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.IntentRecognitionEventArgs=void 0;const r=y();let t=class extends r.RecognitionEventArgs{constructor(u,o,a){super(o,a),this.privResult=u}get result(){return this.privResult}};return yt.IntentRecognitionEventArgs=t,yt}var Rt={},Xo;function bl(){if(Xo)return Rt;Xo=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.RecognitionResult=void 0;let r=class{constructor(i,u,o,a,n,e,s,c,p,h){this.privResultId=i,this.privReason=u,this.privText=o,this.privDuration=a,this.privOffset=n,this.privLanguage=e,this.privLanguageDetectionConfidence=s,this.privErrorDetails=c,this.privJson=p,this.privProperties=h}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};return Rt.RecognitionResult=r,Rt}var Pt={},Zo;function Ml(){if(Zo)return Pt;Zo=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.SpeechRecognitionResult=void 0;const r=y();let t=class extends r.RecognitionResult{constructor(u,o,a,n,e,s,c,p,h,d,l){super(u,o,a,n,e,s,c,h,d,l),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return Pt.SpeechRecognitionResult=t,Pt}var Et={},Yo;function Ol(){if(Yo)return Et;Yo=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.IntentRecognitionResult=void 0;const r=y();let t=class extends r.SpeechRecognitionResult{constructor(u,o,a,n,e,s,c,p,h,d,l){super(o,a,n,e,s,c,p,void 0,h,d,l),this.privIntentId=u}get intentId(){return this.privIntentId}};return Et.IntentRecognitionResult=t,Et}var ae={},ea;function Dl(){if(ea)return ae;ea=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.LanguageUnderstandingModelImpl=ae.LanguageUnderstandingModel=void 0;const r=A();let t=class{constructor(){}static fromEndpoint(o){r.Contracts.throwIfNull(o,"uri"),r.Contracts.throwIfNullOrWhitespace(o.hostname,"uri");const a=new i,n=o.host.indexOf(".");if(n===-1)throw new Error("Could not determine region from endpoint");a.region=o.host.substr(0,n);const e=o.pathname.lastIndexOf("/")+1;if(e===-1)throw new Error("Could not determine appId from endpoint");if(a.appId=o.pathname.substr(e),a.subscriptionKey=o.searchParams.get("subscription-key"),a.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return a}static fromAppId(o){r.Contracts.throwIfNullOrWhitespace(o,"appId");const a=new i;return a.appId=o,a}static fromSubscription(o,a,n){r.Contracts.throwIfNullOrWhitespace(o,"subscriptionKey"),r.Contracts.throwIfNullOrWhitespace(a,"appId"),r.Contracts.throwIfNullOrWhitespace(n,"region");const e=new i;return e.appId=a,e.region=n,e.subscriptionKey=o,e}};ae.LanguageUnderstandingModel=t;class i extends t{}return ae.LanguageUnderstandingModelImpl=i,ae}var G={},ta;function kl(){if(ta)return G;ta=1,Object.defineProperty(G,"__esModule",{value:!0}),G.MeetingTranscriptionEventArgs=G.ConversationTranscriptionEventArgs=G.SpeechRecognitionEventArgs=void 0;const r=y();let t=class extends r.RecognitionEventArgs{constructor(a,n,e){super(n,e),this.privResult=a}get result(){return this.privResult}};G.SpeechRecognitionEventArgs=t;class i extends r.RecognitionEventArgs{constructor(a,n,e){super(n,e),this.privResult=a}get result(){return this.privResult}}G.ConversationTranscriptionEventArgs=i;class u extends t{}return G.MeetingTranscriptionEventArgs=u,G}var It={},At={},ra;function Ui(){if(ra)return At;ra=1,Object.defineProperty(At,"__esModule",{value:!0}),At.CancellationEventArgsBase=void 0;const r=y();let t=class extends r.RecognitionEventArgs{constructor(u,o,a,n,e){super(n,e),this.privReason=u,this.privErrorDetails=o,this.privErrorCode=a}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return At.CancellationEventArgsBase=t,At}var ia;function zl(){if(ia)return It;ia=1,Object.defineProperty(It,"__esModule",{value:!0}),It.SpeechRecognitionCanceledEventArgs=void 0;const r=Ui();let t=class extends r.CancellationEventArgsBase{};return It.SpeechRecognitionCanceledEventArgs=t,It}var Tt={},na;function Nl(){if(na)return Tt;na=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.TranslationRecognitionEventArgs=void 0;const r=y();let t=class extends r.RecognitionEventArgs{constructor(u,o,a){super(o,a),this.privResult=u}get result(){return this.privResult}};return Tt.TranslationRecognitionEventArgs=t,Tt}var wt={},sa;function jl(){if(sa)return wt;sa=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.TranslationSynthesisEventArgs=void 0;const r=y();let t=class extends r.SessionEventArgs{constructor(u,o){super(o),this.privResult=u}get result(){return this.privResult}};return wt.TranslationSynthesisEventArgs=t,wt}var _t={},oa;function Np(){if(oa)return _t;oa=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.TranslationRecognitionResult=void 0;const r=y();let t=class zp extends r.SpeechRecognitionResult{constructor(u,o,a,n,e,s,c,p,h,d,l){super(o,a,n,e,s,c,p,void 0,h,d,l),this.privTranslations=u}static fromSpeechRecognitionResult(u){return new zp(void 0,u.resultId,u.reason,u.text,u.duration,u.offset,u.language,u.languageDetectionConfidence,u.errorDetails,u.json,u.properties)}get translations(){return this.privTranslations}};return _t.TranslationRecognitionResult=t,_t}var bt={},aa;function Ll(){if(aa)return bt;aa=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.TranslationSynthesisResult=void 0;let r=class{constructor(i,u){this.privReason=i,this.privAudio=u}get audio(){return this.privAudio}get reason(){return this.privReason}};return bt.TranslationSynthesisResult=r,bt}var An={},ca;function ql(){return ca||(ca=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ResultReason=void 0,function(t){t[t.NoMatch=0]="NoMatch",t[t.Canceled=1]="Canceled",t[t.RecognizingSpeech=2]="RecognizingSpeech",t[t.RecognizedSpeech=3]="RecognizedSpeech",t[t.RecognizedKeyword=4]="RecognizedKeyword",t[t.RecognizingIntent=5]="RecognizingIntent",t[t.RecognizedIntent=6]="RecognizedIntent",t[t.TranslatingSpeech=7]="TranslatingSpeech",t[t.TranslatedSpeech=8]="TranslatedSpeech",t[t.SynthesizingAudio=9]="SynthesizingAudio",t[t.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",t[t.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",t[t.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",t[t.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",t[t.RecognizedSpeakers=14]="RecognizedSpeakers",t[t.RecognizedSpeaker=15]="RecognizedSpeaker",t[t.ResetVoiceProfile=16]="ResetVoiceProfile",t[t.DeletedVoiceProfile=17]="DeletedVoiceProfile",t[t.VoicesListRetrieved=18]="VoicesListRetrieved",t[t.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",t[t.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",t[t.TranslatedInstantMessage=21]="TranslatedInstantMessage",t[t.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"}(r.ResultReason||(r.ResultReason={}))}(An)),An}var ce={},ua;function Bl(){if(ua)return ce;ua=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.SpeechConfigImpl=ce.SpeechConfig=void 0;const r=E(),t=A(),i=y();let u=class{constructor(){}static fromSubscription(n,e){t.Contracts.throwIfNullOrWhitespace(n,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(e,"region");const s=new o;return s.setProperty(i.PropertyId.SpeechServiceConnection_Region,e),s.setProperty(i.PropertyId.SpeechServiceConnection_IntentRegion,e),s.setProperty(i.PropertyId.SpeechServiceConnection_Key,n),s}static fromEndpoint(n,e){t.Contracts.throwIfNull(n,"endpoint");const s=new o;return s.setProperty(i.PropertyId.SpeechServiceConnection_Endpoint,n.href),e!==void 0&&s.setProperty(i.PropertyId.SpeechServiceConnection_Key,e),s}static fromHost(n,e){t.Contracts.throwIfNull(n,"hostName");const s=new o;return s.setProperty(i.PropertyId.SpeechServiceConnection_Host,n.protocol+"//"+n.hostname+(n.port===""?"":":"+n.port)),e!==void 0&&s.setProperty(i.PropertyId.SpeechServiceConnection_Key,e),s}static fromAuthorizationToken(n,e){t.Contracts.throwIfNull(n,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(e,"region");const s=new o;return s.setProperty(i.PropertyId.SpeechServiceConnection_Region,e),s.setProperty(i.PropertyId.SpeechServiceConnection_IntentRegion,e),s.authorizationToken=n,s}close(){}};ce.SpeechConfig=u;class o extends u{constructor(){super(),this.privProperties=new i.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=i.OutputFormat.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){this.privProperties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,n)}get speechRecognitionLanguage(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(n){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,n)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(n){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,n)}get outputFormat(){return i.OutputFormat[this.privProperties.getProperty(r.OutputFormatPropertyName,void 0)]}set outputFormat(n){this.privProperties.setProperty(r.OutputFormatPropertyName,i.OutputFormat[n])}get endpointId(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(n){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_EndpointId,n)}setProperty(n,e){t.Contracts.throwIfNull(e,"value"),this.privProperties.setProperty(n,e)}getProperty(n,e){return this.privProperties.getProperty(n,e)}setProxy(n,e,s,c){this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyHostName],n),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPort],e),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyUserName],s),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPassword],c)}setServiceProperty(n,e){const s=JSON.parse(this.privProperties.getProperty(r.ServicePropertiesPropertyName,"{}"));s[n]=e,this.privProperties.setProperty(r.ServicePropertiesPropertyName,JSON.stringify(s))}setProfanity(n){this.privProperties.setProperty(i.PropertyId.SpeechServiceResponse_ProfanityOption,i.ProfanityOption[n])}enableAudioLogging(){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(r.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(r.ForceDictationPropertyName,"true")}clone(){const n=new o;return n.privProperties=this.privProperties.clone(),n}get speechSynthesisLanguage(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(n){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage,n)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(n){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthVoice,n)}get speechSynthesisOutputFormat(){return i.SpeechSynthesisOutputFormat[this.privProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(n){this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,i.SpeechSynthesisOutputFormat[n])}}return ce.SpeechConfigImpl=o,ce}var ue={},pa;function xl(){if(pa)return ue;pa=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.SpeechTranslationConfigImpl=ue.SpeechTranslationConfig=void 0;const r=E(),t=A(),i=y();let u=class extends i.SpeechConfig{constructor(){super()}static fromSubscription(n,e){t.Contracts.throwIfNullOrWhitespace(n,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(e,"region");const s=new o;return s.properties.setProperty(i.PropertyId.SpeechServiceConnection_Key,n),s.properties.setProperty(i.PropertyId.SpeechServiceConnection_Region,e),s}static fromAuthorizationToken(n,e){t.Contracts.throwIfNullOrWhitespace(n,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(e,"region");const s=new o;return s.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,n),s.properties.setProperty(i.PropertyId.SpeechServiceConnection_Region,e),s}static fromHost(n,e){t.Contracts.throwIfNull(n,"hostName");const s=new o;return s.setProperty(i.PropertyId.SpeechServiceConnection_Host,n.protocol+"//"+n.hostname+(n.port===""?"":":"+n.port)),e!==void 0&&s.setProperty(i.PropertyId.SpeechServiceConnection_Key,e),s}static fromEndpoint(n,e){t.Contracts.throwIfNull(n,"endpoint"),t.Contracts.throwIfNull(e,"subscriptionKey");const s=new o;return s.properties.setProperty(i.PropertyId.SpeechServiceConnection_Endpoint,n.href),s.properties.setProperty(i.PropertyId.SpeechServiceConnection_Key,e),s}};ue.SpeechTranslationConfig=u;class o extends u{constructor(){super(),this.privSpeechProperties=new i.PropertyCollection,this.outputFormat=i.OutputFormat.Simple}set authorizationToken(n){t.Contracts.throwIfNullOrWhitespace(n,"value"),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,n)}set speechRecognitionLanguage(n){t.Contracts.throwIfNullOrWhitespace(n,"value"),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,n)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return i.OutputFormat[this.privSpeechProperties.getProperty(r.OutputFormatPropertyName,void 0)]}set outputFormat(n){this.privSpeechProperties.setProperty(r.OutputFormatPropertyName,i.OutputFormat[n])}get endpointId(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(n){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_EndpointId,n)}addTargetLanguage(n){t.Contracts.throwIfNullOrWhitespace(n,"value");const e=this.targetLanguages;e.includes(n)||(e.push(n),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,e.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(n){t.Contracts.throwIfNullOrWhitespace(n,"value"),this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,n)}get region(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_Region)}setProxy(n,e,s,c){this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyHostName],n),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPort],e),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyUserName],s),this.setProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_ProxyPassword],c)}getProperty(n,e){return this.privSpeechProperties.getProperty(n,e)}setProperty(n,e){this.privSpeechProperties.setProperty(n,e)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(n,e){const s=JSON.parse(this.privSpeechProperties.getProperty(r.ServicePropertiesPropertyName,"{}"));s[n]=e,this.privSpeechProperties.setProperty(r.ServicePropertiesPropertyName,JSON.stringify(s))}setProfanity(n){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceResponse_ProfanityOption,i.ProfanityOption[n])}enableAudioLogging(){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(r.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(n){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthLanguage,n)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(n){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthVoice,n)}get speechSynthesisOutputFormat(){return i.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(n){this.privSpeechProperties.setProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,i.SpeechSynthesisOutputFormat[n])}}return ue.SpeechTranslationConfigImpl=o,ue}var Mt={},ha;function Lp(){if(ha)return Mt;ha=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.PropertyCollection=void 0;const r=y();let t=class jp{constructor(){this.privKeys=[],this.privValues=[]}getProperty(u,o){let a;typeof u=="string"?a=u:a=r.PropertyId[u];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===a)return this.privValues[n];if(o!==void 0)return String(o)}setProperty(u,o){let a;typeof u=="string"?a=u:a=r.PropertyId[u];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===a){this.privValues[n]=o;return}this.privKeys.push(a),this.privValues.push(o)}clone(){const u=new jp;for(let o=0;o<this.privKeys.length;o++)u.privKeys.push(this.privKeys[o]),u.privValues.push(this.privValues[o]);return u}mergeTo(u){this.privKeys.forEach(o=>{if(u.getProperty(o,void 0)===void 0){const a=this.getProperty(o);u.setProperty(o,a)}})}get keys(){return this.privKeys}};return Mt.PropertyCollection=t,Mt}var Tn={},da;function ls(){return da||(da=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.PropertyId=void 0,function(t){t[t.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",t[t.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",t[t.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",t[t.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",t[t.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",t[t.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",t[t.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",t[t.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",t[t.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",t[t.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",t[t.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",t[t.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",t[t.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",t[t.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",t[t.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",t[t.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",t[t.Speech_SessionId=16]="Speech_SessionId",t[t.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",t[t.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",t[t.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",t[t.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",t[t.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",t[t.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",t[t.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",t[t.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",t[t.CancellationDetails_Reason=25]="CancellationDetails_Reason",t[t.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",t[t.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",t[t.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",t[t.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",t[t.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",t[t.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",t[t.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",t[t.Speech_SegmentationMaximumTimeMs=33]="Speech_SegmentationMaximumTimeMs",t[t.Speech_SegmentationStrategy=34]="Speech_SegmentationStrategy",t[t.SpeechServiceConnection_EnableAudioLogging=35]="SpeechServiceConnection_EnableAudioLogging",t[t.SpeechServiceConnection_LanguageIdMode=36]="SpeechServiceConnection_LanguageIdMode",t[t.SpeechServiceConnection_RecognitionEndpointVersion=37]="SpeechServiceConnection_RecognitionEndpointVersion",t[t.SpeechServiceConnection_SpeakerIdMode=38]="SpeechServiceConnection_SpeakerIdMode",t[t.SpeechServiceResponse_ProfanityOption=39]="SpeechServiceResponse_ProfanityOption",t[t.SpeechServiceResponse_PostProcessingOption=40]="SpeechServiceResponse_PostProcessingOption",t[t.SpeechServiceResponse_RequestWordLevelTimestamps=41]="SpeechServiceResponse_RequestWordLevelTimestamps",t[t.SpeechServiceResponse_StablePartialResultThreshold=42]="SpeechServiceResponse_StablePartialResultThreshold",t[t.SpeechServiceResponse_OutputFormatOption=43]="SpeechServiceResponse_OutputFormatOption",t[t.SpeechServiceResponse_TranslationRequestStablePartialResult=44]="SpeechServiceResponse_TranslationRequestStablePartialResult",t[t.SpeechServiceResponse_RequestWordBoundary=45]="SpeechServiceResponse_RequestWordBoundary",t[t.SpeechServiceResponse_RequestPunctuationBoundary=46]="SpeechServiceResponse_RequestPunctuationBoundary",t[t.SpeechServiceResponse_RequestSentenceBoundary=47]="SpeechServiceResponse_RequestSentenceBoundary",t[t.SpeechServiceResponse_DiarizeIntermediateResults=48]="SpeechServiceResponse_DiarizeIntermediateResults",t[t.Conversation_ApplicationId=49]="Conversation_ApplicationId",t[t.Conversation_DialogType=50]="Conversation_DialogType",t[t.Conversation_Initial_Silence_Timeout=51]="Conversation_Initial_Silence_Timeout",t[t.Conversation_From_Id=52]="Conversation_From_Id",t[t.Conversation_Conversation_Id=53]="Conversation_Conversation_Id",t[t.Conversation_Custom_Voice_Deployment_Ids=54]="Conversation_Custom_Voice_Deployment_Ids",t[t.Conversation_Speech_Activity_Template=55]="Conversation_Speech_Activity_Template",t[t.Conversation_Request_Bot_Status_Messages=56]="Conversation_Request_Bot_Status_Messages",t[t.Conversation_Agent_Connection_Id=57]="Conversation_Agent_Connection_Id",t[t.SpeechServiceConnection_Host=58]="SpeechServiceConnection_Host",t[t.ConversationTranslator_Host=59]="ConversationTranslator_Host",t[t.ConversationTranslator_Name=60]="ConversationTranslator_Name",t[t.ConversationTranslator_CorrelationId=61]="ConversationTranslator_CorrelationId",t[t.ConversationTranslator_Token=62]="ConversationTranslator_Token",t[t.PronunciationAssessment_ReferenceText=63]="PronunciationAssessment_ReferenceText",t[t.PronunciationAssessment_GradingSystem=64]="PronunciationAssessment_GradingSystem",t[t.PronunciationAssessment_Granularity=65]="PronunciationAssessment_Granularity",t[t.PronunciationAssessment_EnableMiscue=66]="PronunciationAssessment_EnableMiscue",t[t.PronunciationAssessment_Json=67]="PronunciationAssessment_Json",t[t.PronunciationAssessment_Params=68]="PronunciationAssessment_Params",t[t.SpeakerRecognition_Api_Version=69]="SpeakerRecognition_Api_Version",t[t.WebWorkerLoadType=70]="WebWorkerLoadType",t[t.TalkingAvatarService_WebRTC_SDP=71]="TalkingAvatarService_WebRTC_SDP"}(r.PropertyId||(r.PropertyId={}))}(Tn)),Tn}var Ot={},la;function Fl(){if(la)return Ot;la=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Recognizer=void 0;const r=E(),t=I(),i=A(),u=y();let o=class qp{constructor(n,e,s){this.audioConfig=n!==void 0?n:u.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=e.clone(),this.privConnectionFactory=s,this.implCommonRecognizerSetup()}close(n,e){i.Contracts.throwIfDisposed(this.privDisposed),t.marshalPromiseToCallbacks(this.dispose(!0),n,e)}get internalData(){return this.privReco}async dispose(n){this.privDisposed||(this.privDisposed=!0,n&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return r.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(n){r.ServiceRecognizerBase.telemetryDataEnabled=n}implCommonRecognizerSetup(){let n=typeof window<"u"?"Browser":"Node",e="unknown",s="unknown";typeof navigator<"u"&&(n=n+"/"+navigator.platform,e=navigator.userAgent,s=navigator.appVersion);const c=this.createRecognizerConfig(new r.SpeechServiceConfig(new r.Context(new r.OS(n,e,s))));this.privReco=this.createServiceRecognizer(qp.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,c)}async recognizeOnceAsyncImpl(n){i.Contracts.throwIfDisposed(this.privDisposed);const e=new t.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(n,e.resolve,e.reject);const s=await e.promise;return await this.implRecognizerStop(),s}async startContinuousRecognitionAsyncImpl(n){i.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(n,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){i.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuthFromProperties(n){const e=n.getProperty(u.PropertyId.SpeechServiceConnection_Key,void 0);return e&&e!==""?new r.CognitiveSubscriptionKeyAuthentication(e):new r.CognitiveTokenAuthentication(()=>{const c=n.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)},()=>{const c=n.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)})}};return Ot.Recognizer=o,Ot}var Dt={},va;function Ul(){if(va)return Dt;va=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.SpeechRecognizer=void 0;const r=E(),t=I(),i=A(),u=y();let o=class Bp extends u.Recognizer{constructor(n,e){const s=n;i.Contracts.throwIfNull(s,"speechConfig"),i.Contracts.throwIfNullOrWhitespace(s.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage),u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),super(e,s.properties,new r.SpeechConnectionFactory),this.privDisposedRecognizer=!1}static FromConfig(n,e,s){const c=n;return e.properties.mergeTo(c.properties),new Bp(n,s)}get endpointId(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){i.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,n)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.OutputFormatPropertyName,u.OutputFormat[u.OutputFormat.Simple])===u.OutputFormat[u.OutputFormat.Simple]?u.OutputFormat.Simple:u.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(n,e){t.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(r.RecognitionMode.Interactive),n,e)}startContinuousRecognitionAsync(n,e){t.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(r.RecognitionMode.Conversation),n,e)}stopContinuousRecognitionAsync(n,e){t.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),n,e)}startKeywordRecognitionAsync(n,e,s){i.Contracts.throwIfNull(n,"model"),s&&s("Not yet implemented.")}stopKeywordRecognitionAsync(n){n&&n()}close(n,e){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),n,e)}async dispose(n){this.privDisposedRecognizer||(n&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(n))}createRecognizerConfig(n){return new r.RecognizerConfig(n,this.privProperties)}createServiceRecognizer(n,e,s,c){const p=s;return new r.SpeechServiceRecognizer(n,e,p,c,this)}};return Dt.SpeechRecognizer=o,Dt}var kt={},fa;function Wl(){if(fa)return kt;fa=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.IntentRecognizer=void 0;const r=E(),t=I(),i=A(),u=y();let o=class extends u.Recognizer{constructor(n,e){i.Contracts.throwIfNullOrUndefined(n,"speechConfig");const s=n;i.Contracts.throwIfNullOrUndefined(s,"speechConfig"),super(e,s.properties,new r.IntentConnectionFactory),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=s.properties,i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage),u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,n)}get properties(){return this.privProperties}recognizeOnceAsync(n,e){if(i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const s=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",s.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(s.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}t.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(r.RecognitionMode.Interactive),n,e)}startContinuousRecognitionAsync(n,e){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const s=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",s.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(s.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}t.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(r.RecognitionMode.Conversation),n,e)}stopContinuousRecognitionAsync(n,e){t.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),n,e)}startKeywordRecognitionAsync(n,e,s){i.Contracts.throwIfNull(n,"model"),s&&s("Not yet implemented.")}stopKeywordRecognitionAsync(n,e){if(n)try{n()}catch(s){e&&e(s)}}addIntent(n,e){i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),i.Contracts.throwIfNullOrWhitespace(e,"intentId"),i.Contracts.throwIfNullOrWhitespace(n,"simplePhrase"),this.privAddedIntents.push([e,n])}addIntentWithLanguageModel(n,e,s){i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),i.Contracts.throwIfNullOrWhitespace(n,"intentId"),i.Contracts.throwIfNull(e,"model");const c=e;i.Contracts.throwIfNullOrWhitespace(c.appId,"model.appId"),this.privAddedLmIntents[n]=new r.AddedLmIntent(c,s)}addAllIntents(n,e){i.Contracts.throwIfNull(n,"model");const s=n;i.Contracts.throwIfNullOrWhitespace(s.appId,"model.appId"),this.privUmbrellaIntent=new r.AddedLmIntent(s,e)}close(n,e){i.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),n,e)}createRecognizerConfig(n){return new r.RecognizerConfig(n,this.privProperties)}createServiceRecognizer(n,e,s,c){const p=s;return new r.IntentServiceRecognizer(n,e,p,c,this)}async dispose(n){this.privDisposedIntentRecognizer||n&&(this.privDisposedIntentRecognizer=!0,await super.dispose(n))}buildSpeechContext(){let n,e,s;const c=[];this.privUmbrellaIntent!==void 0&&(n=this.privUmbrellaIntent.modelImpl.appId,e=this.privUmbrellaIntent.modelImpl.region,s=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const p of Object.keys(this.privAddedLmIntents)){const h=this.privAddedLmIntents[p];if(n===void 0)n=h.modelImpl.appId;else if(n!==h.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(e===void 0)e=h.modelImpl.region;else if(e!==h.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(s===void 0)s=h.modelImpl.subscriptionKey;else if(s!==h.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const d="luis/"+n+"-PRODUCTION#"+p;c.push(d)}return{Intent:{id:n,key:s===void 0?this.privProperties.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_Key]):s,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?c:["luis/"+n+"-PRODUCTION"]}}};return kt.IntentRecognizer=o,kt}var wn={},ga;function Vl(){return ga||(ga=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.VoiceProfileType=void 0,function(t){t[t.TextIndependentIdentification=0]="TextIndependentIdentification",t[t.TextDependentVerification=1]="TextDependentVerification",t[t.TextIndependentVerification=2]="TextIndependentVerification"}(r.VoiceProfileType||(r.VoiceProfileType={}))}(wn)),wn}var zt={},Nt={},pe={},Sa;function xp(){if(Sa)return pe;Sa=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.ConnectionMessageImpl=pe.ConnectionMessage=void 0;const r=N(),t=I(),i=Lp(),u=ls();let o=class{};pe.ConnectionMessage=o;class a{constructor(e){this.privConnectionMessage=e,this.privProperties=new i.PropertyCollection,this.privConnectionMessage.headers[r.HeaderNames.ConnectionId]&&this.privProperties.setProperty(u.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[r.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(s=>{this.privProperties.setProperty(s,this.privConnectionMessage.headers[s])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(e=>e.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===t.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===t.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return pe.ConnectionMessageImpl=a,pe}var ma;function Fp(){if(ma)return Nt;ma=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.Connection=void 0;const r=E(),t=I(),i=xp(),u=A(),o=y();let a=class ss{static fromRecognizer(e){const s=e.internalData,c=new ss;return c.privInternalData=s,c.setupEvents(),c}static fromSynthesizer(e){const s=e.internalData,c=new ss;return c.privInternalData=s,c.setupEvents(),c}openConnection(e,s){t.marshalPromiseToCallbacks(this.privInternalData.connect(),e,s)}closeConnection(e,s){if(this.privInternalData instanceof r.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");t.marshalPromiseToCallbacks(this.privInternalData.disconnect(),e,s)}setMessageProperty(e,s,c){if(u.Contracts.throwIfNullOrWhitespace(s,"propertyName"),this.privInternalData instanceof r.ServiceRecognizerBase){if(e.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(s,c)}else if(this.privInternalData instanceof r.SynthesisAdapterBase){if(e.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(s,c)}}sendMessageAsync(e,s,c,p){t.marshalPromiseToCallbacks(this.privInternalData.sendNetworkMessage(e,s),c,p)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(e=>{e.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new o.ConnectionEventArgs(e.connectionId)):e.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new o.ConnectionEventArgs(e.connectionId)):e.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new o.ConnectionMessageEventArgs(new i.ConnectionMessageImpl(e.message))):e.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new o.ConnectionMessageEventArgs(new i.ConnectionMessageImpl(e.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(e=>{this.receivedServiceMessage&&this.receivedServiceMessage(new o.ServiceEventArgs(e.jsonString,e.name))})}};return Nt.Connection=a,Nt}var Ca;function Hl(){if(Ca)return zt;Ca=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.TranslationRecognizer=void 0;const r=E(),t=I(),i=Fp(),u=A(),o=y();let a=class Up extends o.Recognizer{constructor(e,s,c){const p=e;u.Contracts.throwIfNull(p,"speechConfig"),super(s,p.properties,c||new r.TranslationConnectionFactory),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&u.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationVoice),o.PropertyId[o.PropertyId.SpeechServiceConnection_TranslationVoice]),u.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages),o.PropertyId[o.PropertyId.SpeechServiceConnection_TranslationToLanguages]),u.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage),o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(e,s,c){const p=e;return s.properties.mergeTo(p.properties),s.properties.getProperty(o.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===r.AutoDetectSourceLanguagesOpenRangeOptionName&&p.properties.setProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new Up(e,c)}get speechRecognitionLanguage(){return u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,e)}recognizeOnceAsync(e,s){u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),t.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(r.RecognitionMode.Interactive),e,s)}startContinuousRecognitionAsync(e,s){t.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(r.RecognitionMode.Conversation),e,s)}stopContinuousRecognitionAsync(e,s){t.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,s)}removeTargetLanguage(e){if(u.Contracts.throwIfNullOrUndefined(e,"language to be removed"),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const s=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),c=s.indexOf(e);c>-1&&(s.splice(c,1),this.properties.setProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,s.join(",")),this.updateLanguages(s))}}addTargetLanguage(e){u.Contracts.throwIfNullOrUndefined(e,"language to be added");let s=[];this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(s=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),s.includes(e)||(s.push(e),this.properties.setProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,s.join(",")))):(this.properties.setProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,e),s=[e]),this.updateLanguages(s)}close(e,s){u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),e,s)}onConnection(){}async dispose(e){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,e&&(await this.implRecognizerStop(),await super.dispose(e)))}createRecognizerConfig(e){return new r.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,s,c,p){const h=c;return new r.TranslationServiceRecognizer(e,s,h,p,this)}updateLanguages(e){const s=i.Connection.fromRecognizer(this);s&&(s.setMessageProperty("speech.context","translationcontext",{to:e}),s.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:e})))}};return zt.TranslationRecognizer=a,zt}var jt={},ya;function Kl(){if(ya)return jt;ya=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.Translations=void 0;const r=y();let t=class{constructor(){this.privMap=new r.PropertyCollection}get languages(){return this.privMap.keys}get(u,o){return this.privMap.getProperty(u,o)}set(u,o){this.privMap.setProperty(u,o)}};return jt.Translations=t,jt}var _n={},Ra;function $l(){return Ra||(Ra=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.NoMatchReason=void 0,function(t){t[t.NotRecognized=0]="NotRecognized",t[t.InitialSilenceTimeout=1]="InitialSilenceTimeout",t[t.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(r.NoMatchReason||(r.NoMatchReason={}))}(_n)),_n}var Lt={},Pa;function Jl(){if(Pa)return Lt;Pa=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.NoMatchDetails=void 0;const r=E(),t=y();let i=class Wp{constructor(o){this.privReason=o}static fromResult(o){const a=r.SimpleSpeechPhrase.fromJSON(o.json,0);let n=t.NoMatchReason.NotRecognized;switch(a.RecognitionStatus){case r.RecognitionStatus.BabbleTimeout:n=t.NoMatchReason.InitialBabbleTimeout;break;case r.RecognitionStatus.InitialSilenceTimeout:n=t.NoMatchReason.InitialSilenceTimeout;break;default:n=t.NoMatchReason.NotRecognized;break}return new Wp(n)}get reason(){return this.privReason}};return Lt.NoMatchDetails=i,Lt}var qt={},Ea;function Gl(){if(Ea)return qt;Ea=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.TranslationRecognitionCanceledEventArgs=void 0;let r=class{constructor(i,u,o,a,n){this.privCancelReason=u,this.privErrorDetails=o,this.privResult=n,this.privSessionId=i,this.privErrorCode=a}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return qt.TranslationRecognitionCanceledEventArgs=r,qt}var Bt={},Ia;function Ql(){if(Ia)return Bt;Ia=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.IntentRecognitionCanceledEventArgs=void 0;const r=y();let t=class extends r.IntentRecognitionEventArgs{constructor(u,o,a,n,e,s){super(n,e,s),this.privReason=u,this.privErrorDetails=o,this.privErrorCode=a}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return Bt.IntentRecognitionCanceledEventArgs=t,Bt}var xt={},Aa;function Vp(){if(Aa)return xt;Aa=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.CancellationDetailsBase=void 0;let r=class{constructor(i,u,o){this.privReason=i,this.privErrorDetails=u,this.privErrorCode=o}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};return xt.CancellationDetailsBase=r,xt}var Ft={},Ta;function Xl(){if(Ta)return Ft;Ta=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.CancellationDetails=void 0;const r=E(),t=Vp(),i=y();let u=class Hp extends t.CancellationDetailsBase{constructor(a,n,e){super(a,n,e)}static fromResult(a){let n=i.CancellationReason.Error,e=i.CancellationErrorCode.NoError;if(a instanceof i.RecognitionResult&&a.json){const s=r.SimpleSpeechPhrase.fromJSON(a.json,0);n=r.EnumTranslation.implTranslateCancelResult(s.RecognitionStatus)}return a.properties&&(e=i.CancellationErrorCode[a.properties.getProperty(r.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.NoError])]),new Hp(n,a.errorDetails||r.EnumTranslation.implTranslateErrorDetails(e),e)}};return Ft.CancellationDetails=u,Ft}var bn={},wa;function Zl(){return wa||(wa=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.CancellationErrorCode=void 0,function(t){t[t.NoError=0]="NoError",t[t.AuthenticationFailure=1]="AuthenticationFailure",t[t.BadRequestParameters=2]="BadRequestParameters",t[t.TooManyRequests=3]="TooManyRequests",t[t.ConnectionFailure=4]="ConnectionFailure",t[t.ServiceTimeout=5]="ServiceTimeout",t[t.ServiceError=6]="ServiceError",t[t.RuntimeError=7]="RuntimeError",t[t.Forbidden=8]="Forbidden"}(r.CancellationErrorCode||(r.CancellationErrorCode={}))}(bn)),bn}var Ut={},_a;function Yl(){if(_a)return Ut;_a=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.ConnectionEventArgs=void 0;const r=y();let t=class extends r.SessionEventArgs{};return Ut.ConnectionEventArgs=t,Ut}var Wt={},ba;function ev(){if(ba)return Wt;ba=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ServiceEventArgs=void 0;const r=y();let t=class extends r.SessionEventArgs{constructor(u,o,a){super(a),this.privJsonResult=u,this.privEventName=o}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return Wt.ServiceEventArgs=t,Wt}var Vt={},Ma;function tv(){if(Ma)return Vt;Ma=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.PhraseListGrammar=void 0;let r=class Kp{constructor(i){this.privGrammerBuilder=i.dynamicGrammar}static fromRecognizer(i){const u=i.internalData;return new Kp(u)}addPhrase(i){this.privGrammerBuilder.addPhrase(i)}addPhrases(i){this.privGrammerBuilder.addPhrase(i)}clear(){this.privGrammerBuilder.clearPhrases()}};return Vt.PhraseListGrammar=r,Vt}var he={},Oa;function vs(){if(Oa)return he;Oa=1,Object.defineProperty(he,"__esModule",{value:!0}),he.DialogServiceConfigImpl=he.DialogServiceConfig=void 0;const r=A(),t=y();let i=class{constructor(){}set applicationId(a){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};he.DialogServiceConfig=i;class u extends i{constructor(){super(),this.privSpeechConfig=new t.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(a){r.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechConfig.speechRecognitionLanguage=a}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(a){this.privSpeechConfig.outputFormat=a}setProperty(a,n){this.privSpeechConfig.setProperty(a,n)}getProperty(a,n){return this.privSpeechConfig.getProperty(a)}setProxy(a,n,e,s){this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyHostName,a),this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPort,`${n}`),e&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyUserName,e),s&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPassword,s)}setServiceProperty(a,n,e){this.privSpeechConfig.setServiceProperty(a,n)}close(){}}return he.DialogServiceConfigImpl=u,he}var Ht={},Da;function rv(){if(Da)return Ht;Da=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.BotFrameworkConfig=void 0;const r=A(),t=vs(),i=y();let u=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(a,n,e){r.Contracts.throwIfNullOrWhitespace(a,"subscription"),r.Contracts.throwIfNullOrWhitespace(n,"region");const s=new t.DialogServiceConfigImpl;return s.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),s.setProperty(i.PropertyId.SpeechServiceConnection_Key,a),s.setProperty(i.PropertyId.SpeechServiceConnection_Region,n),e&&s.setProperty(i.PropertyId.Conversation_ApplicationId,e),s}static fromAuthorizationToken(a,n,e){r.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),r.Contracts.throwIfNullOrWhitespace(n,"region");const s=new t.DialogServiceConfigImpl;return s.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),s.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,a),s.setProperty(i.PropertyId.SpeechServiceConnection_Region,n),e&&s.setProperty(i.PropertyId.Conversation_ApplicationId,e),s}static fromHost(a,n,e){r.Contracts.throwIfNullOrUndefined(a,"host");const s=a instanceof URL?a:new URL(`wss://${a}.convai.speech.azure.us`);r.Contracts.throwIfNullOrUndefined(s,"resolvedHost");const c=new t.DialogServiceConfigImpl;return c.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),c.setProperty(i.PropertyId.SpeechServiceConnection_Host,s.toString()),n!==void 0&&c.setProperty(i.PropertyId.SpeechServiceConnection_Key,n),c}static fromEndpoint(a,n){r.Contracts.throwIfNull(a,"endpoint");const e=new t.DialogServiceConfigImpl;return e.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),e.setProperty(i.PropertyId.SpeechServiceConnection_Endpoint,a.toString()),n!==void 0&&e.setProperty(i.PropertyId.SpeechServiceConnection_Key,n),e}};return Ht.BotFrameworkConfig=u,Ht}var Kt={},ka;function iv(){if(ka)return Kt;ka=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.CustomCommandsConfig=void 0;const r=A(),t=vs(),i=y();let u=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(a,n,e){r.Contracts.throwIfNullOrWhitespace(a,"applicationId"),r.Contracts.throwIfNullOrWhitespace(n,"subscription"),r.Contracts.throwIfNullOrWhitespace(e,"region");const s=new t.DialogServiceConfigImpl;return s.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),s.setProperty(i.PropertyId.Conversation_ApplicationId,a),s.setProperty(i.PropertyId.SpeechServiceConnection_Key,n),s.setProperty(i.PropertyId.SpeechServiceConnection_Region,e),s}static fromAuthorizationToken(a,n,e){r.Contracts.throwIfNullOrWhitespace(a,"applicationId"),r.Contracts.throwIfNullOrWhitespace(n,"authorizationToken"),r.Contracts.throwIfNullOrWhitespace(e,"region");const s=new t.DialogServiceConfigImpl;return s.setProperty(i.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),s.setProperty(i.PropertyId.Conversation_ApplicationId,a),s.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,n),s.setProperty(i.PropertyId.SpeechServiceConnection_Region,e),s}set applicationId(a){r.Contracts.throwIfNullOrWhitespace(a,"value"),this.setProperty(i.PropertyId.Conversation_ApplicationId,a)}get applicationId(){return this.getProperty(i.PropertyId.Conversation_ApplicationId)}};return Kt.CustomCommandsConfig=u,Kt}var $t={},Jt={},Gt={},Qt={},za;function ee(){if(za)return Qt;za=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.QueryParameterNames=void 0;let r=class{};return Qt.QueryParameterNames=r,r.BotId="botid",r.CustomSpeechDeploymentId="cid",r.CustomVoiceDeploymentId="deploymentId",r.EnableAudioLogging="storeAudio",r.EnableLanguageId="lidEnabled",r.EnableWordLevelTimestamps="wordLevelTimestamps",r.EndSilenceTimeoutMs="endSilenceTimeoutMs",r.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",r.SegmentationMaximumTimeMs="segmentationMaximumTimeMs",r.SegmentationStrategy="segmentationStrategy",r.Format="format",r.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",r.Language="language",r.Profanity="profanity",r.RequestBotStatusMessages="enableBotMessageStatus",r.StableIntermediateThreshold="stableIntermediateThreshold",r.StableTranslation="stableTranslation",r.TestHooks="testhooks",r.Postprocessing="postprocessing",r.CtsMeetingId="meetingId",r.CtsDeviceId="deviceId",r.CtsIsParticipant="isParticipant",r.EnableAvatar="enableTalkingAvatar",Qt}var Na;function H(){if(Na)return Gt;Na=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.ConnectionFactoryBase=void 0;const r=E(),t=y(),i=ee();let u=class{static getHostSuffix(a){if(a){if(a.toLowerCase().startsWith("china"))return".azure.cn";if(a.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(a,n,e){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,i.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,i.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,i.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,i.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,i.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,i.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,i.QueryParameterNames.EnableWordLevelTimestamps],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,i.QueryParameterNames.StableIntermediateThreshold]]).forEach((p,h)=>{this.setUrlParameter(h,p,a,n,e)});const c=JSON.parse(a.parameters.getProperty(r.ServicePropertiesPropertyName,"{}"));Object.keys(c).forEach(p=>{n[p]=c[p]})}setUrlParameter(a,n,e,s,c){const p=e.parameters.getProperty(a,void 0);p&&(!c||c.search(n)===-1)&&(s[n]=p.toLocaleLowerCase())}};return Gt.ConnectionFactoryBase=u,Gt}var ja;function nv(){if(ja)return Jt;ja=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.DialogConnectionFactory=void 0;const r=k(),t=E(),i=y(),u=H(),o=E(),a=N(),n=ee();class e extends u.ConnectionFactoryBase{create(c,p,h){const d=c.parameters.getProperty(i.PropertyId.Conversation_ApplicationId,""),l=c.parameters.getProperty(i.PropertyId.Conversation_DialogType),f=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region),v=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),g=c.parameters.getProperty(i.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),S={};S[a.HeaderNames.ConnectionId]=h,S[n.QueryParameterNames.Format]=c.parameters.getProperty(t.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple]).toLowerCase(),S[n.QueryParameterNames.Language]=v,S[n.QueryParameterNames.RequestBotStatusMessages]=g,d&&(S[n.QueryParameterNames.BotId]=d,l===i.DialogServiceConfig.DialogTypes.CustomCommands&&(S[a.HeaderNames.CustomCommandsAppId]=d));const m=l===i.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",C=l===i.DialogServiceConfig.DialogTypes.CustomCommands?"v1":l===i.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",P={};p.token!=null&&p.token!==""&&(P[p.headerName]=p.token);let R=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,"");if(!R){const D=u.ConnectionFactoryBase.getHostSuffix(f),_=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,`wss://${f}.${e.BaseUrl}${D}`);R=`${_.endsWith("/")?_:_+"/"}${m}${e.ApiKey}/${C}`}this.setCommonUrlParams(c,S,R);const w=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new r.WebsocketConnection(R,S,P,new o.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(c),w,h)}}return Jt.DialogConnectionFactory=e,e.ApiKey="api",e.BaseUrl="convai.speech",Jt}var La;function sv(){if(La)return $t;La=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.DialogServiceConnector=void 0;const r=nv(),t=E(),i=I(),u=A(),o=y(),a=ls();let n=class extends o.Recognizer{constructor(s,c){const p=s;u.Contracts.throwIfNull(s,"dialogConfig"),super(c,p.properties,new r.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=p.properties.clone();const h=this.buildAgentConfig();this.privReco.agentConfig.set(h)}connect(s,c){i.marshalPromiseToCallbacks(this.privReco.connect(),s,c)}disconnect(s,c){i.marshalPromiseToCallbacks(this.privReco.disconnect(),s,c)}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(s){u.Contracts.throwIfNullOrWhitespace(s,"token"),this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,s)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(a.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(s){this.properties.setProperty(a.PropertyId.Conversation_Speech_Activity_Template,s)}listenOnceAsync(s,c){if(this.isTurnComplete){u.Contracts.throwIfDisposed(this.privIsDisposed);const h=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const d=new i.Deferred;await this.privReco.recognize(t.RecognitionMode.Conversation,d.resolve,d.reject);const l=await d.promise;return await this.implRecognizerStop(),l})();h.catch(()=>{this.dispose(!0).catch(()=>{})}),i.marshalPromiseToCallbacks(h.finally(()=>{this.isTurnComplete=!0}),s,c)}}sendActivityAsync(s,c,p){i.marshalPromiseToCallbacks(this.privReco.sendMessage(s),c,p)}close(s,c){u.Contracts.throwIfDisposed(this.privIsDisposed),i.marshalPromiseToCallbacks(this.dispose(!0),s,c)}async dispose(s){this.privIsDisposed||s&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(s))}createRecognizerConfig(s){return new t.RecognizerConfig(s,this.privProperties)}createServiceRecognizer(s,c,p,h){const d=p;return new t.DialogServiceAdapter(s,c,d,h,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(a.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(a.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(a.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(a.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return $t.DialogServiceConnector=n,$t}var Xt={},qa;function ov(){if(qa)return Xt;qa=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.ActivityReceivedEventArgs=void 0;let r=class{constructor(i,u){this.privActivity=i,this.privAudioStream=u}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};return Xt.ActivityReceivedEventArgs=r,Xt}var Zt={},Yt={},Ba;function av(){if(Ba)return Yt;Ba=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.TurnStatusResponsePayload=void 0;class r{constructor(i){this.privMessageStatusResponse=JSON.parse(i)}static fromJSON(i){return new r(i)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}return Yt.TurnStatusResponsePayload=r,Yt}var xa;function cv(){if(xa)return Zt;xa=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.TurnStatusReceivedEventArgs=void 0;const r=av();let t=class{constructor(u){this.privTurnStatus=r.TurnStatusResponsePayload.fromJSON(u)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};return Zt.TurnStatusReceivedEventArgs=t,Zt}var Mn={},Fa;function uv(){return Fa||(Fa=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ServicePropertyChannel=void 0,function(t){t[t.UriQueryParameter=0]="UriQueryParameter"}(r.ServicePropertyChannel||(r.ServicePropertyChannel={}))}(Mn)),Mn}var On={},Ua;function pv(){return Ua||(Ua=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ProfanityOption=void 0,function(t){t[t.Masked=0]="Masked",t[t.Removed=1]="Removed",t[t.Raw=2]="Raw"}(r.ProfanityOption||(r.ProfanityOption={}))}(On)),On}var er={},Wa;function hv(){if(Wa)return er;Wa=1,Object.defineProperty(er,"__esModule",{value:!0}),er.BaseAudioPlayer=void 0;const r=K(),t=y(),i=_e();let u=class{constructor(a){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,a===void 0&&(a=t.AudioStreamFormat.getDefaultInputFormat()),this.init(a)}playAudioSample(a,n,e){try{this.ensureInitializedContext();const s=this.formatAudioData(a),c=new Float32Array(this.samples.length+s.length);c.set(this.samples,0),c.set(s,this.samples.length),this.samples=c,n&&n()}catch(s){e&&e(s)}}stopAudio(a,n){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{a&&a()},e=>{n&&n(e)}),this.audioContext=null)}init(a){this.audioFormat=a,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const a=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},a)}}createAudioContext(){this.audioContext=i.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(a){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(a),128);case 16:return this.formatArrayBuffer(new Int16Array(a),32768);case 32:return this.formatArrayBuffer(new Int32Array(a),2147483648);default:throw new r.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(a,n){const e=new Float32Array(a.length);for(let s=0;s<a.length;s++)e[s]=a[s]/n;return e}updateAudioBuffer(){if(this.samples.length===0)return;const a=this.audioFormat.channels,n=this.audioContext.createBufferSource(),e=this.samples.length/a,s=this.audioContext.createBuffer(a,e,this.audioFormat.samplesPerSec);for(let c=0;c<a;c++){let p=c;const h=s.getChannelData(c);for(let d=0;d<this.samples.length;d++,p+=a)h[d]=this.samples[p]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),n.buffer=s,n.connect(this.gainNode),n.start(this.startTime),this.startTime+=s.duration,this.samples=new Float32Array}async playAudio(a){this.audioContext===null&&this.createAudioContext();const n=this.audioContext.createBufferSource(),e=this.audioContext.destination;await this.audioContext.decodeAudioData(a,s=>{n.buffer=s,n.connect(e),n.start(0)})}};return er.BaseAudioPlayer=u,er}var tr={},Va;function dv(){if(Va)return tr;Va=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.ConnectionMessageEventArgs=void 0;let r=class{constructor(i){this.privConnectionMessage=i}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};return tr.ConnectionMessageEventArgs=r,tr}var rr={},Ha;function lv(){if(Ha)return rr;Ha=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.VoiceProfile=void 0;let r=class{constructor(i,u){this.privId=i,this.privProfileType=u}get profileId(){return this.privId}get profileType(){return this.privProfileType}};return rr.VoiceProfile=r,rr}var de={},Ka;function vv(){if(Ka)return de;Ka=1,Object.defineProperty(de,"__esModule",{value:!0}),de.VoiceProfileEnrollmentCancellationDetails=de.VoiceProfileEnrollmentResult=void 0;const r=E(),t=y();let i=class os{constructor(a,n,e){this.privReason=a,this.privProperties=new t.PropertyCollection,this.privReason!==t.ResultReason.Canceled?n&&(this.privDetails=JSON.parse(n),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=t.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=e,this.privProperties.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[t.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(a){const n=[];for(const e of a.value){const s=e.enrollmentStatus.toLowerCase()==="enrolling"?t.ResultReason.EnrollingVoiceProfile:e.enrollmentStatus.toLowerCase()==="enrolled"?t.ResultReason.EnrolledVoiceProfile:t.ResultReason.Canceled,c=new os(s,null,null);c.privDetails=this.getIdentificationDetails(e),n.push(c)}return n}static FromVerificationProfileList(a){const n=[];for(const e of a.value){const s=e.enrollmentStatus.toLowerCase()==="enrolling"?t.ResultReason.EnrollingVoiceProfile:e.enrollmentStatus.toLowerCase()==="enrolled"?t.ResultReason.EnrolledVoiceProfile:t.ResultReason.Canceled,c=new os(s,null,null);c.privDetails=this.getVerificationDetails(e),n.push(c)}return n}static getIdentificationDetails(a){return{audioLength:a.audioLength?parseFloat(a.audioLength):0,audioSpeechLength:a.audioSpeechLength?parseFloat(a.audioSpeechLength):0,enrollmentStatus:a.enrollmentStatus,enrollmentsCount:a.enrollmentsCount||0,enrollmentsLength:a.enrollmentsLength?parseFloat(a.enrollmentsLength):0,enrollmentsSpeechLength:a.enrollmentsSpeechLength?parseFloat(a.enrollmentsSpeechLength):0,profileId:a.profileId||a.identificationProfileId,remainingEnrollmentsSpeechLength:a.remainingEnrollmentsSpeechLength?parseFloat(a.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(a){return{audioLength:a.audioLength?parseFloat(a.audioLength):0,audioSpeechLength:a.audioSpeechLength?parseFloat(a.audioSpeechLength):0,enrollmentStatus:a.enrollmentStatus,enrollmentsCount:a.enrollmentsCount,enrollmentsLength:a.enrollmentsLength?parseFloat(a.enrollmentsLength):0,enrollmentsSpeechLength:a.enrollmentsSpeechLength?parseFloat(a.enrollmentsSpeechLength):0,profileId:a.profileId||a.verificationProfileId,remainingEnrollmentsCount:a.remainingEnrollments||a.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:a.remainingEnrollmentsSpeechLength?parseFloat(a.remainingEnrollmentsSpeechLength):0}}};de.VoiceProfileEnrollmentResult=i;class u extends t.CancellationDetailsBase{constructor(a,n,e){super(a,n,e)}static fromResult(a){const n=t.CancellationReason.Error;let e=t.CancellationErrorCode.NoError;return a.properties&&(e=t.CancellationErrorCode[a.properties.getProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[t.CancellationErrorCode.NoError])]),new u(n,a.errorDetails,e)}}return de.VoiceProfileEnrollmentCancellationDetails=u,de}var le={},$a;function fv(){if($a)return le;$a=1,Object.defineProperty(le,"__esModule",{value:!0}),le.VoiceProfileCancellationDetails=le.VoiceProfileResult=void 0;const r=E(),t=A(),i=y();let u=class{constructor(n,e){this.privReason=n,this.privProperties=new i.PropertyCollection,n===i.ResultReason.Canceled&&(t.Contracts.throwIfNullOrUndefined(e,"statusText"),this.privErrorDetails=e,this.privProperties.setProperty(r.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}};le.VoiceProfileResult=u;class o extends i.CancellationDetailsBase{constructor(n,e,s){super(n,e,s)}static fromResult(n){const e=i.CancellationReason.Error;let s=i.CancellationErrorCode.NoError;return n.properties&&(s=i.CancellationErrorCode[n.properties.getProperty(r.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.NoError])]),new o(e,n.errorDetails,s)}}return le.VoiceProfileCancellationDetails=o,le}var ir={},Ja;function gv(){if(Ja)return ir;Ja=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.VoiceProfilePhraseResult=void 0;const r=A(),t=y();let i=class extends t.VoiceProfileResult{constructor(o,a,n,e){super(o,a),this.privPhrases=[],r.Contracts.throwIfNullOrUndefined(e,"phrase array"),this.privType=n,e&&e[0]&&(this.privPhrases=e)}get phrases(){return this.privPhrases}get type(){return this.privType}};return ir.VoiceProfilePhraseResult=i,ir}var nr={},Ga;function Sv(){if(Ga)return nr;Ga=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.VoiceProfileClient=void 0;const r=E(),t=kp(),i=A(),u=y();let o=class extends u.Recognizer{constructor(n){i.Contracts.throwIfNullOrUndefined(n,"speechConfig");const e=n;i.Contracts.throwIfNull(e,"speechConfig"),super(t.AudioConfig.fromStreamInput(u.AudioInputStream.createPushStream()),e.properties,new r.VoiceProfileConnectionFactory),this.privProperties=e.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){i.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,n)}async createProfileAsync(n,e){const s=await this.privVoiceAdapter.createProfile(n,e);return new u.VoiceProfile(s[0],n)}async retrieveEnrollmentResultAsync(n){return this.privVoiceAdapter.retrieveEnrollmentResult(n)}async getAllProfilesAsync(n){return this.privVoiceAdapter.getAllProfiles(n)}async getActivationPhrasesAsync(n,e){return this.privVoiceAdapter.getActivationPhrases(n,e)}async enrollProfileAsync(n,e){const s=e;return i.Contracts.throwIfNullOrUndefined(s,"audioConfig"),this.audioConfig=e,this.privVoiceAdapter.SpeakerAudioSource=s,this.privVoiceAdapter.enrollProfile(n)}async deleteProfileAsync(n){return this.privVoiceAdapter.deleteProfile(n)}async resetProfileAsync(n){return this.privVoiceAdapter.resetProfile(n)}async close(){await this.dispose(!0)}createServiceRecognizer(n,e,s,c){const p=s;return new r.VoiceServiceRecognizer(n,e,p,c,this)}async dispose(n){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,n&&await super.dispose(n))}createRecognizerConfig(n){return new r.RecognizerConfig(n,this.properties)}getResult(n,e){return new u.VoiceProfileResult(n.ok?e:u.ResultReason.Canceled,n.statusText)}};return nr.VoiceProfileClient=o,nr}var sr={},Qa;function mv(){if(Qa)return sr;Qa=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.SpeakerRecognizer=void 0;const r=E(),t=A(),i=y();let u=class extends i.Recognizer{constructor(a,n){t.Contracts.throwIfNullOrUndefined(a,"speechConfig");const e=a;t.Contracts.throwIfNullOrUndefined(e,"speechConfig"),super(n,e.properties,new r.SpeakerRecognitionConnectionFactory),this.privAudioConfigImpl=n,t.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=e.properties}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,a)}get properties(){return this.privProperties}async recognizeOnceAsync(a){return t.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(a)}async close(){t.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.dispose(!0)}async recognizeSpeakerOnceAsyncImpl(a){t.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.implRecognizerStop();const n=await this.privReco.recognizeSpeaker(a);return await this.implRecognizerStop(),n}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}createRecognizerConfig(a){return new r.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,n,e,s){const c=e;return new r.SpeakerServiceRecognizer(a,n,c,s,this)}async dispose(a){this.privDisposedSpeakerRecognizer||a&&(this.privDisposedSpeakerRecognizer=!0,await super.dispose(a))}};return sr.SpeakerRecognizer=u,sr}var or={},Xa;function Cv(){if(Xa)return or;Xa=1,Object.defineProperty(or,"__esModule",{value:!0}),or.SpeakerIdentificationModel=void 0;const r=A(),t=y();let i=class $p{constructor(o){if(this.privVoiceProfiles=[],this.privProfileIds=[],r.Contracts.throwIfNullOrUndefined(o,"VoiceProfiles"),o.length===0)throw new Error("Empty Voice Profiles array");for(const a of o){if(a.profileType!==t.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+a.profileId);this.privVoiceProfiles.push(a),this.privProfileIds.push(a.profileId)}}static fromProfiles(o){return new $p(o)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}};return or.SpeakerIdentificationModel=i,or}var ar={},Za;function yv(){if(Za)return ar;Za=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.SpeakerVerificationModel=void 0;const r=A(),t=y();let i=class Jp{constructor(o){if(r.Contracts.throwIfNullOrUndefined(o,"VoiceProfile"),o.profileType===t.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=o}static fromProfile(o){return new Jp(o)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===t.VoiceProfileType.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}};return ar.SpeakerVerificationModel=i,ar}var cr={},Dn={},Ya;function Gp(){return Ya||(Ya=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.LanguageIdMode=void 0,function(t){t[t.AtStart=0]="AtStart",t[t.Continuous=1]="Continuous"}(r.LanguageIdMode||(r.LanguageIdMode={}))}(Dn)),Dn}var ec;function Rv(){if(ec)return cr;ec=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.AutoDetectSourceLanguageConfig=void 0;const r=E(),t=A(),i=y(),u=Gp();let o=class Ki{constructor(){this.privProperties=new i.PropertyCollection,this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=u.LanguageIdMode.AtStart}static fromOpenRange(){const n=new Ki;return n.properties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,r.AutoDetectSourceLanguagesOpenRangeOptionName),n}static fromLanguages(n){t.Contracts.throwIfArrayEmptyOrWhitespace(n,"languages");const e=new Ki;return e.properties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,n.join()),e}static fromSourceLanguageConfigs(n){if(n.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const e=new Ki,s=[];return n.forEach(c=>{if(s.push(c.language),c.endpointId!==void 0&&c.endpointId!==""){const p=c.language+i.PropertyId.SpeechServiceConnection_EndpointId.toString();e.properties.setProperty(p,c.endpointId)}}),e.properties.setProperty(i.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,s.join()),e}get properties(){return this.privProperties}set mode(n){n===u.LanguageIdMode.Continuous?(this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=n}};return cr.AutoDetectSourceLanguageConfig=o,cr}var ur={},tc;function Pv(){if(tc)return ur;tc=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.AutoDetectSourceLanguageResult=void 0;const r=A();let t=class as{constructor(u,o){r.Contracts.throwIfNullOrUndefined(u,"language"),r.Contracts.throwIfNullOrUndefined(o,"languageDetectionConfidence"),this.privLanguage=u,this.privLanguageDetectionConfidence=o}static fromResult(u){return new as(u.language,u.languageDetectionConfidence)}static fromConversationTranscriptionResult(u){return new as(u.language,u.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};return ur.AutoDetectSourceLanguageResult=t,ur}var pr={},rc;function Ev(){if(rc)return pr;rc=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.SourceLanguageConfig=void 0;const r=A();let t=class Qp{constructor(u,o){r.Contracts.throwIfNullOrUndefined(u,"language"),this.privLanguage=u,this.privEndpointId=o}static fromLanguage(u,o){return new Qp(u,o)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};return pr.SourceLanguageConfig=t,pr}var kn={},ic;function Iv(){return ic||(ic=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SpeakerRecognitionCancellationDetails=r.SpeakerRecognitionResult=r.SpeakerRecognitionResultType=void 0;const t=E(),i=y();var u;(function(n){n[n.Verify=0]="Verify",n[n.Identify=1]="Identify"})(u=r.SpeakerRecognitionResultType||(r.SpeakerRecognitionResultType={}));class o{constructor(e,s=i.ResultReason.RecognizedSpeaker,c=i.CancellationErrorCode.NoError,p=""){this.privProperties=new i.PropertyCollection;const h=e.scenario==="TextIndependentIdentification"?u.Identify:u.Verify;this.privReason=s,this.privReason!==i.ResultReason.Canceled?h===u.Identify?(this.privProfileId=e.identificationResult.identifiedProfile.profileId,this.privScore=e.identificationResult.identifiedProfile.score,this.privReason=i.ResultReason.RecognizedSpeakers):(this.privScore=e.verificationResult.score,e.verificationResult.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=i.ResultReason.NoMatch),e.verificationResult.profileId!==void 0&&e.verificationResult.profileId!==""&&(this.privProfileId=e.verificationResult.profileId)):(this.privErrorDetails=p,this.privProperties.setProperty(t.CancellationErrorCodePropertyName,i.CancellationErrorCode[c])),this.privProperties.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,JSON.stringify(e))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}}r.SpeakerRecognitionResult=o;class a extends i.CancellationDetailsBase{constructor(e,s,c){super(e,s,c)}static fromResult(e){const s=i.CancellationReason.Error;let c=i.CancellationErrorCode.NoError;return e.properties&&(c=i.CancellationErrorCode[e.properties.getProperty(t.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.NoError])]),new a(s,e.errorDetails,c)}}r.SpeakerRecognitionCancellationDetails=a}(kn)),kn}var zn={},ve={},nc;function Xp(){if(nc)return ve;nc=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.ConversationImpl=ve.Conversation=void 0;const r=E(),t=I(),i=A(),u=y();let o=class{constructor(){}static createConversationAsync(e,s,c,p){i.Contracts.throwIfNullOrUndefined(e,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),i.Contracts.throwIfNullOrUndefined(e.region,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!e.subscriptionKey&&!e.getProperty(u.PropertyId[u.PropertyId.SpeechServiceAuthorization_Token])&&i.Contracts.throwIfNullOrUndefined(e.subscriptionKey,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let h,d,l;return typeof s=="string"?(h=new a(e,s),t.marshalPromiseToCallbacks((async()=>{})(),c,p)):(h=new a(e),d=s,l=c,h.createConversationAsync(()=>{d&&d()},f=>{l&&l(f)})),h}};ve.Conversation=o;class a extends o{constructor(e,s){if(super(),this.privErrors=r.ConversationConnectionConfig.restErrors,this.onConnected=h=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,h)}catch{}},this.onDisconnected=h=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,h)}catch{}finally{this.close(!1)}},this.onCanceled=(h,d)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,d)}catch{}},this.onParticipantUpdateCommandReceived=(h,d)=>{try{const l=this.privParticipants.getParticipant(d.id);if(l!==void 0){switch(d.key){case r.ConversationTranslatorCommandTypes.changeNickname:l.displayName=d.value;break;case r.ConversationTranslatorCommandTypes.setUseTTS:l.isUsingTts=d.value;break;case r.ConversationTranslatorCommandTypes.setProfanityFiltering:l.profanity=d.value;break;case r.ConversationTranslatorCommandTypes.setMute:l.isMuted=d.value;break;case r.ConversationTranslatorCommandTypes.setTranslateToLanguages:l.translateToLanguages=d.value;break}this.privParticipants.addOrUpdateParticipant(l),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,[this.toParticipant(l)],d.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(h,d)=>{try{this.privParticipants.participants.forEach(l=>l.isMuted=l.isHost?!1:d.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,this.toParticipants(!1),d.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(h,d)=>{try{const l=this.privParticipants.addOrUpdateParticipant(d.participant);l!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,[this.toParticipant(l)],d.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(h,d)=>{try{const l=this.privParticipants.getParticipant(d.participant.id);l!==void 0&&(this.privParticipants.deleteParticipant(d.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.LeftConversation,[this.toParticipant(l)],d.sessionId)))}catch{}},this.onTranslationReceived=(h,d)=>{try{switch(d.command){case r.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new u.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break;case r.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new u.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break;case r.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new u.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break}}catch{}},this.onParticipantsListReceived=(h,d)=>{try{if(d.sessionToken!==void 0&&d.sessionToken!==null&&(this.privRoom.token=d.sessionToken),this.privParticipants.participants=[...d.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),d.sessionId)),this.me.isHost){const l=this.privConversationTranslator?.properties.getProperty(u.PropertyId.ConversationTranslator_Name);l!==void 0&&l.length>0&&l!==this.me.displayName&&this.changeNicknameAsync(l)}}catch{}},this.onConversationExpiration=(h,d)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,d)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new u.PropertyCollection,this.privManager=new r.ConversationManager,e.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])||e.setProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage],r.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=e.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),s)this.privConversationId=s;else{e.targetLanguages.length===0&&e.addTargetLanguage(this.privLanguage),e.getProperty(u.PropertyId[u.PropertyId.SpeechServiceResponse_ProfanityOption])||e.setProfanity(u.ProfanityOption.Masked);let d=e.getProperty(u.PropertyId[u.PropertyId.ConversationTranslator_Name]);d==null&&(d="Host"),i.Contracts.throwIfNullOrTooLong(d,"nickname",50),i.Contracts.throwIfNullOrTooShort(d,"nickname",2),e.setProperty(u.PropertyId[u.PropertyId.ConversationTranslator_Name],d)}this.privConfig=e;const p=e;i.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new r.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const e=this.conversationId,s=this.participants.map(h=>({id:h.id,preferredLanguage:h.preferredLanguage,voice:h.voice})),c={};for(const h of r.ConversationConnectionConfig.transcriptionEventKeys){const d=this.properties.getProperty(h,"");d!==""&&(c[h]=d)}return{id:e,participants:s,conversationProperties:c}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(e){i.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}set conversationTranslator(e){this.privConversationTranslator=e}onToken(e){this.privConversationTranslator.onToken(e)}createConversationAsync(e,s){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s),this.privManager.createOrJoin(this.privProperties,void 0,c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),s),this.privRoom=c,this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}startConversationAsync(e,s){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=r.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}addParticipantAsync(e,s,c){i.Contracts.throwIfNullOrUndefined(e,"Participant"),t.marshalPromiseToCallbacks(this.addParticipantImplAsync(e),s,c)}joinConversationAsync(e,s,c,p,h){try{i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),i.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,d=>{i.Contracts.throwIfNullOrUndefined(d,this.privErrors.permissionDeniedConnect),this.privRoom=d,this.privConfig.authorizationToken=d.cognitiveSpeechAuthToken,p&&p(d.cognitiveSpeechAuthToken)},d=>{this.handleError(d,h)})}catch(d){this.handleError(d,h)}}deleteConversationAsync(e,s){t.marshalPromiseToCallbacks(this.deleteConversationImplAsync(),e,s)}async deleteConversationImplAsync(){i.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(e,s){t.marshalPromiseToCallbacks(this.endConversationImplAsync(),e,s)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(e,s){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}muteAllParticipantsAsync(e,s){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}muteParticipantAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),()=>{this.handleCallback(s,c)},h=>{this.handleError(h,c)})}catch(p){this.handleError(p,c)}}removeParticipantAsync(e,s,c){try{if(i.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))t.marshalPromiseToCallbacks(this.removeParticipantImplAsync(e),s,c);else{i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let p="";typeof e=="string"?p=e:e.hasOwnProperty("id")?p=e.id:e.hasOwnProperty("userId")&&(p=e.userId),i.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(d=>d.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),()=>{this.handleCallback(s,c)},d=>{this.handleError(d,c)})}}catch(p){this.handleError(p,c)}}unlockConversationAsync(e,s){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}unmuteAllParticipantsAsync(e,s){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}unmuteParticipantAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),()=>{this.handleCallback(s,c)},h=>{this.handleError(h,c)})}catch(p){this.handleError(p,c)}}sendTextMessageAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),()=>{this.handleCallback(s,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}setTranslatedLanguagesAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),()=>{this.handleCallback(s,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}changeNicknameAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),()=>{this.handleCallback(s,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(e){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(e){if(this.privParticipants.addOrUpdateParticipant(e)!==void 0&&this.privTranscriberRecognizer){const c=this.conversationInfo;return c.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(c,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);const s=this.conversationInfo;return s.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(s,"leave")}async close(e){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(s){throw s}e&&this.dispose()}handleCallback(e,s){if(e){try{e()}catch(c){s&&s(c)}e=void 0}}handleError(e,s){if(s)if(e instanceof Error){const c=e;s(c.name+": "+c.message)}else s(e)}toParticipants(e){const s=this.privParticipants.participants.map(c=>this.toParticipant(c));return e?s:s.filter(c=>c.isHost===!1)}toParticipant(e){return new u.Participant(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMuteCommand(e,s){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setMute,participantId:e,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:s})}getLockCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:e})}getEjectCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:e})}getChangeNicknameCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(e,"nickname"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMessageCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),i.Contracts.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:r.ConversationTranslatorMessageTypes.instantMessage})}}return ve.ConversationImpl=a,ve}var hr={},sc;function Av(){if(sc)return hr;sc=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.ConversationCommon=void 0;let r=class{constructor(i){this.privAudioConfig=i}handleCallback(i,u){if(i){try{i()}catch(o){u&&u(o)}i=void 0}}handleError(i,u){if(u)if(i instanceof Error){const o=i;u(o.name+": "+o.message)}else u(i)}};return hr.ConversationCommon=r,hr}var dr={},oc;function Tv(){if(oc)return dr;oc=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.ConversationExpirationEventArgs=void 0;const r=y();let t=class extends r.SessionEventArgs{constructor(u,o){super(o),this.privExpirationTime=u}get expirationTime(){return this.privExpirationTime}};return dr.ConversationExpirationEventArgs=t,dr}var lr={},ac;function wv(){if(ac)return lr;ac=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.ConversationParticipantsChangedEventArgs=void 0;const r=y();let t=class extends r.SessionEventArgs{constructor(u,o,a){super(a),this.privReason=u,this.privParticipant=o}get reason(){return this.privReason}get participants(){return this.privParticipant}};return lr.ConversationParticipantsChangedEventArgs=t,lr}var vr={},cc;function _v(){if(cc)return vr;cc=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.ConversationTranslationCanceledEventArgs=void 0;const r=Ui();let t=class extends r.CancellationEventArgsBase{};return vr.ConversationTranslationCanceledEventArgs=t,vr}var fr={},uc;function bv(){if(uc)return fr;uc=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.ConversationTranslationEventArgs=void 0;const r=y();let t=class extends r.RecognitionEventArgs{constructor(u,o,a){super(o,a),this.privResult=u}get result(){return this.privResult}};return fr.ConversationTranslationEventArgs=t,fr}var gr={},pc;function Mv(){if(pc)return gr;pc=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.ConversationTranslationResult=void 0;const r=Np();let t=class extends r.TranslationRecognitionResult{constructor(u,o,a,n,e,s,c,p,h,d,l){super(o,n,e,s,c,p,void 0,void 0,h,d,l),this.privId=u,this.privOrigLang=a}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return gr.ConversationTranslationResult=t,gr}var Nn={},Sr={},mr={},hc;function Zp(){if(hc)return mr;hc=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.StringUtils=void 0;let r=class{static formatString(i,u){if(!i)return"";if(!u)return i;let o="",a="";const n=c=>{o+=c},e=c=>{a+=c};let s=n;for(let c=0;c<i.length;c++){const p=i[c],h=c+1<i.length?i[c+1]:"";switch(p){case"{":h==="{"?(s("{"),c++):s=e;break;case"}":h==="}"?(s("}"),c++):(u.hasOwnProperty(a)&&(o+=u[a]),s=n,a="");break;default:s(p);break}}return o}};return mr.StringUtils=r,mr}var dc;function Ov(){if(dc)return Sr;dc=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.ConversationTranslatorConnectionFactory=void 0;const r=k(),t=Zp(),i=A(),u=y(),o=N(),a=ee(),n=H(),e=E();let s=class Yp extends n.ConnectionFactoryBase{constructor(p){super(),i.Contracts.throwIfNullOrUndefined(p,"convGetter"),this.privConvGetter=p}create(p,h,d){const l=p.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",f=this.privConvGetter().room,v=f.cognitiveSpeechRegion||p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Region,""),g={hostSuffix:n.ConnectionFactoryBase.getHostSuffix(v),path:Yp.CTS_VIRT_MIC_PATH,region:encodeURIComponent(v)};g[a.QueryParameterNames.Language]=encodeURIComponent(p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage,"")),g[a.QueryParameterNames.CtsMeetingId]=encodeURIComponent(f.roomId),g[a.QueryParameterNames.CtsDeviceId]=encodeURIComponent(f.participantId),g[a.QueryParameterNames.CtsIsParticipant]=f.isHost?"":"&"+a.QueryParameterNames.CtsIsParticipant;let S="";const m={},C={};if(l){S=p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Endpoint),S||(S="wss://"+p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),S=t.StringUtils.formatString(S,g);const R=new URL(S);R.searchParams.forEach((D,_)=>{m[_]=D}),new e.TranscriberConnectionFactory().setQueryParams(m,p,S),m[a.QueryParameterNames.CtsMeetingId]=g[a.QueryParameterNames.CtsMeetingId],m[a.QueryParameterNames.CtsDeviceId]=g[a.QueryParameterNames.CtsDeviceId],f.isHost||(m[a.QueryParameterNames.CtsIsParticipant]=""),a.QueryParameterNames.Format in m||(m[a.QueryParameterNames.Format]="simple"),R.searchParams.forEach((D,_)=>{R.searchParams.set(_,m[_]),delete m[_]}),S=R.toString()}else{const R=new e.TranslationConnectionFactory;S=R.getEndpointUrl(p,!0),S=t.StringUtils.formatString(S,g),R.setQueryParams(m,p,S)}C[o.HeaderNames.ConnectionId]=d,C[r.RestConfigBase.configParams.token]=f.token,h.token&&(C[h.headerName]=h.token);const P=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return new r.WebsocketConnection(S,m,C,new e.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(p),P,d)}};return Sr.ConversationTranslatorConnectionFactory=s,s.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",Sr}var lc;function Dv(){return lc||(lc=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ConversationTranslator=r.SpeechState=void 0;const t=E(),i=Ov(),u=I(),o=A(),a=y(),n=Xp(),e=fs();var s;(function(h){h[h.Inactive=0]="Inactive",h[h.Connecting=1]="Connecting",h[h.Connected=2]="Connected"})(s=r.SpeechState||(r.SpeechState={}));class c extends a.TranslationRecognizer{constructor(d,l,f,v){super(d,l,new i.ConversationTranslatorConnectionFactory(v)),this.privSpeechState=s.Inactive,f&&(this.privTranslator=f,this.sessionStarted=()=>{this.privSpeechState=s.Connected},this.sessionStopped=()=>{this.privSpeechState=s.Inactive},this.recognizing=(g,S)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,S)},this.recognized=async(g,S)=>{S.result?.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(S.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,S)},this.canceled=async()=>{if(this.privSpeechState!==s.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=s.Inactive}})}get state(){return this.privSpeechState}set state(d){this.privSpeechState=d}set authentication(d){this.privReco.authentication=d}onConnection(){this.privSpeechState=s.Connected}async onCancelSpeech(){this.privSpeechState=s.Inactive,await this.cancelSpeech()}fireCancelEvent(d){try{if(this.privTranslator.canceled){const l=new e.ConversationTranslationCanceledEventArgs(a.CancellationReason.Error,d,a.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,l)}}catch{}}async cancelSpeech(){try{this.stopContinuousRecognitionAsync(),await this.privReco?.disconnect(),this.privSpeechState=s.Inactive}catch{}}}class p extends e.ConversationCommon{constructor(d){super(d),this.privErrors=t.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new a.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){return this.privConversation?.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===s.Connected||this.privCTRecognizer.state===s.Connecting||this.privConversation.isMutedByHost)}onToken(d){this.privCTRecognizer.authentication=d}setServiceProperty(d,l){const f=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));f[d]=l,this.privProperties.setProperty(t.ServicePropertiesPropertyName,JSON.stringify(f))}joinConversationAsync(d,l,f,v,g){try{if(typeof d=="string"){o.Contracts.throwIfNullOrUndefined(d,this.privErrors.invalidArgs.replace("{arg}","conversation id")),o.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),g);let S=f;(S==null||S==="")&&(S=t.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=a.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(a.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(S),this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage],S),this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.ConversationTranslator_Name],l);const m=[a.PropertyId.SpeechServiceConnection_Host,a.PropertyId.ConversationTranslator_Host,a.PropertyId.SpeechServiceConnection_Endpoint,a.PropertyId.SpeechServiceConnection_ProxyHostName,a.PropertyId.SpeechServiceConnection_ProxyPassword,a.PropertyId.SpeechServiceConnection_ProxyPort,a.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const P of m){const R=this.privProperties.getProperty(P);if(R){const w=typeof P=="string"?P:a.PropertyId[P];this.privSpeechTranslationConfig.setProperty(w,R)}}const C=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));for(const P of Object.keys(C))this.privSpeechTranslationConfig.setServiceProperty(P,C[P],a.ServicePropertyChannel.UriQueryParameter);this.privConversation=new n.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(d,l,S,P=>{P||this.handleError(new Error(this.privErrors.permissionDeniedConnect),g),this.privSpeechTranslationConfig.authorizationToken=P,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync(()=>{this.handleCallback(v,g)},R=>{this.handleError(R,g)})},P=>{this.handleError(P,g)})}else typeof d=="object"?(o.Contracts.throwIfNullOrUndefined(d,this.privErrors.invalidArgs.replace("{arg}","conversation id")),o.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(a.PropertyId.ConversationTranslator_Name,l),this.privConversation=d,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,o.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),o.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=d.config,this.handleCallback(f,v)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),v)}catch(S){this.handleError(S,typeof f=="string"?g:v)}}leaveConversationAsync(d,l){u.marshalPromiseToCallbacks((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),d,l)}sendTextMessageAsync(d,l,f){try{o.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),o.Contracts.throwIfNullOrWhitespace(d,this.privErrors.invalidArgs.replace("{arg}",d)),this.privConversation.sendTextMessageAsync(d,l,f)}catch(v){this.handleError(v,f)}}startTranscribingAsync(d,l){u.marshalPromiseToCallbacks((async()=>{try{o.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),o.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),o.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),l),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(f){throw this.privIsSpeaking=!1,await this.cancelSpeech(),f}})(),d,l)}stopTranscribingAsync(d,l){u.marshalPromiseToCallbacks((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((f,v)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(f,v)})}catch{await this.cancelSpeech()}})(),d,l)}isDisposed(){return this.privIsDisposed}dispose(d,l,f){u.marshalPromiseToCallbacks((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),l,f)}async cancelSpeech(){try{this.privIsSpeaking=!1,await this.privCTRecognizer?.onCancelSpeech(),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=a.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key],"");const d=()=>this.privConversation;this.privCTRecognizer=new c(this.privSpeechTranslationConfig,this.privAudioConfig,this,d)}catch(d){throw await this.cancelSpeech(),d}}startContinuousRecognition(){return new Promise((d,l)=>{this.privCTRecognizer.startContinuousRecognitionAsync(d,l)})}}r.ConversationTranslator=p}(Nn)),Nn}var Cr={},vc;function kv(){if(vc)return Cr;vc=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.ConversationTranscriber=void 0;const r=E(),t=I(),i=A(),u=y();let o=class eh extends u.Recognizer{constructor(n,e){const s=n;i.Contracts.throwIfNull(s,"speechConfig"),i.Contracts.throwIfNullOrWhitespace(s.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage),u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),super(e,s.properties,new r.ConversationTranscriberConnectionFactory),this.privProperties.setProperty(u.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(n,e,s){const c=n;return e.properties.mergeTo(c.properties),new eh(n,s)}get endpointId(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){i.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,n)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.OutputFormatPropertyName,u.OutputFormat[u.OutputFormat.Simple])===u.OutputFormat[u.OutputFormat.Simple]?u.OutputFormat.Simple:u.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(n,e){t.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(r.RecognitionMode.Conversation),n,e)}stopTranscribingAsync(n,e){t.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),n,e)}close(n,e){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),n,e)}async dispose(n){this.privDisposedRecognizer||(n&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(n))}createRecognizerConfig(n){return new r.RecognizerConfig(n,this.privProperties)}createServiceRecognizer(n,e,s,c){const p=s;return c.isSpeakerDiarizationEnabled=!0,new r.ConversationTranscriptionServiceRecognizer(n,e,p,c,this)}};return Cr.ConversationTranscriber=o,Cr}var fe={},fc;function zv(){if(fc)return fe;fc=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.Participant=fe.User=void 0;const r=y();class t{constructor(o){this.privUserId=o}get userId(){return this.privUserId}}fe.User=t;class i{constructor(o,a,n,e,s,c,p,h){this.privId=o,this.privAvatar=a,this.privDisplayName=n,this.privIsHost=e,this.privIsMuted=s,this.privIsUsingTts=c,this.privPreferredLanguage=p,this.privVoice=h,this.privProperties=new r.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(o,a,n){return new i(o,"",o,!1,!1,!1,a,n)}}return fe.Participant=i,fe}var jn={},gc;function Nv(){return gc||(gc=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ParticipantChangedReason=void 0,function(t){t[t.JoinedConversation=0]="JoinedConversation",t[t.LeftConversation=1]="LeftConversation",t[t.Updated=2]="Updated"}(r.ParticipantChangedReason||(r.ParticipantChangedReason={}))}(jn)),jn}var ge={},Sc;function jv(){if(Sc)return ge;Sc=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.MeetingImpl=ge.Meeting=void 0;const r=E(),t=I(),i=A(),u=y();let o=class{constructor(){}static createMeetingAsync(e,s,c,p){if(i.Contracts.throwIfNullOrUndefined(e,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),i.Contracts.throwIfNullOrUndefined(e.region,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),i.Contracts.throwIfNull(s,"meetingId"),s.length===0)throw new Error("meetingId cannot be empty");!e.subscriptionKey&&!e.getProperty(u.PropertyId[u.PropertyId.SpeechServiceAuthorization_Token])&&i.Contracts.throwIfNullOrUndefined(e.subscriptionKey,r.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const h=new a(e,s);return t.marshalPromiseToCallbacks((async()=>{})(),c,p),h}};ge.Meeting=o;class a extends o{constructor(e,s){super(),this.privErrors=r.ConversationConnectionConfig.restErrors,this.onConnected=h=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,h)}catch{}},this.onDisconnected=h=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,h)}catch{}finally{this.close(!1)}},this.onCanceled=(h,d)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,d)}catch{}},this.onParticipantUpdateCommandReceived=(h,d)=>{try{const l=this.privParticipants.getParticipant(d.id);if(l!==void 0){switch(d.key){case r.ConversationTranslatorCommandTypes.changeNickname:l.displayName=d.value;break;case r.ConversationTranslatorCommandTypes.setUseTTS:l.isUsingTts=d.value;break;case r.ConversationTranslatorCommandTypes.setProfanityFiltering:l.profanity=d.value;break;case r.ConversationTranslatorCommandTypes.setMute:l.isMuted=d.value;break;case r.ConversationTranslatorCommandTypes.setTranslateToLanguages:l.translateToLanguages=d.value;break}this.privParticipants.addOrUpdateParticipant(l),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,[this.toParticipant(l)],d.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(h,d)=>{try{this.privParticipants.participants.forEach(l=>l.isMuted=l.isHost?!1:d.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,this.toParticipants(!1),d.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(h,d)=>{try{const l=this.privParticipants.addOrUpdateParticipant(d.participant);l!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,[this.toParticipant(l)],d.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(h,d)=>{try{const l=this.privParticipants.getParticipant(d.participant.id);l!==void 0&&(this.privParticipants.deleteParticipant(d.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.LeftConversation,[this.toParticipant(l)],d.sessionId)))}catch{}},this.onTranslationReceived=(h,d)=>{try{switch(d.command){case r.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new u.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break;case r.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new u.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break;case r.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new u.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break}}catch{}},this.onParticipantsListReceived=(h,d)=>{try{if(d.sessionToken!==void 0&&d.sessionToken!==null&&(this.privRoom.token=d.sessionToken),this.privParticipants.participants=[...d.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),d.sessionId)),this.me.isHost){const l=this.privConversationTranslator?.properties.getProperty(u.PropertyId.ConversationTranslator_Name);l!==void 0&&l.length>0&&l!==this.me.displayName&&this.changeNicknameAsync(l)}}catch{}},this.onConversationExpiration=(h,d)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,d)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new u.PropertyCollection,this.privManager=new r.ConversationManager,e.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])||e.setProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage],r.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=e.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=s,this.privConfig=e;const p=e;i.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new r.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const e=this.meetingId,s=this.participants.map(h=>({id:h.id,preferredLanguage:h.preferredLanguage,voice:h.voice})),c={};for(const h of r.ConversationConnectionConfig.transcriptionEventKeys){const d=this.properties.getProperty(h,"");d!==""&&(c[h]=d)}return{id:e,participants:s,meetingProperties:c}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(e){i.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}createMeetingAsync(e,s){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s),this.privManager.createOrJoin(this.privProperties,void 0,c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),s),this.privRoom=c,this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}startMeetingAsync(e,s){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}addParticipantAsync(e,s,c){i.Contracts.throwIfNullOrUndefined(e,"Participant"),t.marshalPromiseToCallbacks(this.addParticipantImplAsync(e),s,c)}joinMeetingAsync(e,s,c,p,h){try{i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),i.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,d=>{i.Contracts.throwIfNullOrUndefined(d,this.privErrors.permissionDeniedConnect),this.privRoom=d,this.privConfig.authorizationToken=d.cognitiveSpeechAuthToken,p&&p(d.cognitiveSpeechAuthToken)},d=>{this.handleError(d,h)})}catch(d){this.handleError(d,h)}}deleteMeetingAsync(e,s){t.marshalPromiseToCallbacks(this.deleteMeetingImplAsync(),e,s)}async deleteMeetingImplAsync(){i.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(e,s){t.marshalPromiseToCallbacks(this.endMeetingImplAsync(),e,s)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(e,s){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}muteAllParticipantsAsync(e,s){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}muteParticipantAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),()=>{this.handleCallback(s,c)},h=>{this.handleError(h,c)})}catch(p){this.handleError(p,c)}}removeParticipantAsync(e,s,c){try{if(i.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))t.marshalPromiseToCallbacks(this.removeParticipantImplAsync(e),s,c);else{i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let p="";typeof e=="string"?p=e:e.hasOwnProperty("id")?p=e.id:e.hasOwnProperty("userId")&&(p=e.userId),i.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(d=>d.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),()=>{this.handleCallback(s,c)},d=>{this.handleError(d,c)})}}catch(p){this.handleError(p,c)}}unlockMeetingAsync(e,s){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}unmuteAllParticipantsAsync(e,s){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(e,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}unmuteParticipantAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),()=>{this.handleCallback(s,c)},h=>{this.handleError(h,c)})}catch(p){this.handleError(p,c)}}sendTextMessageAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),()=>{this.handleCallback(s,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}setTranslatedLanguagesAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),()=>{this.handleCallback(s,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}changeNicknameAsync(e,s,c){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),i.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),i.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),()=>{this.handleCallback(s,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(e){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(e){if(this.privParticipants.addOrUpdateParticipant(e)!==void 0&&this.privTranscriberRecognizer){const c=this.meetingInfo;return c.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(c,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);const s=this.meetingInfo;return s.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(s,"leave")}async close(e){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(s){throw s}e&&this.dispose()}handleCallback(e,s){if(e){try{e()}catch(c){s&&s(c)}e=void 0}}handleError(e,s){if(s)if(e instanceof Error){const c=e;s(c.name+": "+c.message)}else s(e)}toParticipants(e){const s=this.privParticipants.participants.map(c=>this.toParticipant(c));return e?s:s.filter(c=>c.isHost===!1)}toParticipant(e){return new u.Participant(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMuteCommand(e,s){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),i.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setMute,participantId:e,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:s})}getLockCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:e})}getEjectCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:e})}getChangeNicknameCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(e,"nickname"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:r.ConversationTranslatorCommandTypes.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:r.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMessageCommand(e){return i.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),i.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),i.Contracts.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:r.ConversationTranslatorMessageTypes.instantMessage})}}return ge.MeetingImpl=a,ge}var yr={},mc;function Lv(){if(mc)return yr;mc=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.MeetingTranscriptionCanceledEventArgs=void 0;const r=Ui();class t extends r.CancellationEventArgsBase{}return yr.MeetingTranscriptionCanceledEventArgs=t,yr}var Rr={},Cc;function qv(){if(Cc)return Rr;Cc=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.MeetingTranscriber=void 0;const r=E(),t=I(),i=A(),u=y(),o=fs();let a=class{constructor(e){this.privAudioConfig=e,this.privProperties=new u.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return u.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){i.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,e)}joinMeetingAsync(e,s,c){const p=e;i.Contracts.throwIfNullOrUndefined(o.MeetingImpl,"Meeting"),this.privRecognizer=new r.TranscriberRecognizer(e.config,this.privAudioConfig),i.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),t.marshalPromiseToCallbacks(p.connectTranscriberRecognizer(this.privRecognizer),s,c)}startTranscribingAsync(e,s){this.privRecognizer.startContinuousRecognitionAsync(e,s)}stopTranscribingAsync(e,s){this.privRecognizer.stopContinuousRecognitionAsync(e,s)}leaveMeetingAsync(e,s){this.privRecognizer.disconnectCallbacks(),t.marshalPromiseToCallbacks((async()=>{})(),e,s)}close(e,s){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),e,s)}async dispose(e){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),e&&(this.privDisposedRecognizer=!0))}};return Rr.MeetingTranscriber=a,Rr}var Pr={},yc;function Bv(){if(yc)return Pr;yc=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.ConversationTranscriptionResult=void 0;const r=y();let t=class extends r.RecognitionResult{constructor(u,o,a,n,e,s,c,p,h,d,l){super(u,o,a,n,e,s,c,h,d,l),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return Pr.ConversationTranscriptionResult=t,Pr}var Rc;function fs(){return Rc||(Rc=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=Xp();Object.defineProperty(r,"Conversation",{enumerable:!0,get:function(){return t.Conversation}}),Object.defineProperty(r,"ConversationImpl",{enumerable:!0,get:function(){return t.ConversationImpl}});var i=Av();Object.defineProperty(r,"ConversationCommon",{enumerable:!0,get:function(){return i.ConversationCommon}});var u=Tv();Object.defineProperty(r,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return u.ConversationExpirationEventArgs}});var o=wv();Object.defineProperty(r,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return o.ConversationParticipantsChangedEventArgs}});var a=_v();Object.defineProperty(r,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return a.ConversationTranslationCanceledEventArgs}});var n=bv();Object.defineProperty(r,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return n.ConversationTranslationEventArgs}});var e=Mv();Object.defineProperty(r,"ConversationTranslationResult",{enumerable:!0,get:function(){return e.ConversationTranslationResult}});var s=Dv();Object.defineProperty(r,"ConversationTranslator",{enumerable:!0,get:function(){return s.ConversationTranslator}});var c=kv();Object.defineProperty(r,"ConversationTranscriber",{enumerable:!0,get:function(){return c.ConversationTranscriber}});var p=zv();Object.defineProperty(r,"Participant",{enumerable:!0,get:function(){return p.Participant}}),Object.defineProperty(r,"User",{enumerable:!0,get:function(){return p.User}});var h=Nv();Object.defineProperty(r,"ParticipantChangedReason",{enumerable:!0,get:function(){return h.ParticipantChangedReason}});var d=jv();Object.defineProperty(r,"Meeting",{enumerable:!0,get:function(){return d.Meeting}}),Object.defineProperty(r,"MeetingImpl",{enumerable:!0,get:function(){return d.MeetingImpl}});var l=Lv();Object.defineProperty(r,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return l.MeetingTranscriptionCanceledEventArgs}});var f=qv();Object.defineProperty(r,"MeetingTranscriber",{enumerable:!0,get:function(){return f.MeetingTranscriber}});var v=Bv();Object.defineProperty(r,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return v.ConversationTranscriptionResult}})}(zn)),zn}var Se={},Pc;function gs(){if(Pc)return Se;Pc=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.SynthesisRequest=Se.Synthesizer=void 0;const r=E(),t=I(),i=A(),u=y();let o=class th{constructor(e){const s=e;i.Contracts.throwIfNull(s,"speechConfig"),this.privProperties=s.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new t.Queue}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){i.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(u.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===r.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(e){const s={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let c=this.properties.getProperty(u.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),p=this.properties.getProperty(u.PropertyId.SpeechServiceConnection_SynthVoice,""),h=th.XMLEncode(e);return this.autoDetectSourceLanguage?c="en-US":p=p||s[c],p&&(h=`<voice name='${p}'>${h}</voice>`),h=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${c}'>${h}</speak>`,h}async dispose(e){this.privDisposed||(e&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const e=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(e.text,e.isSSML,e.requestId,e.cb,e.err,e.dataStream)}}createSynthesizerConfig(e){return new r.SynthesizerConfig(e,this.privProperties)}implCommonSynthesizeSetup(){let e=typeof window<"u"?"Browser":"Node",s="unknown",c="unknown";typeof navigator<"u"&&(e=e+"/"+navigator.platform,s=navigator.userAgent,c=navigator.appVersion);const p=this.createSynthesizerConfig(new r.SpeechServiceConfig(new r.Context(new r.OS(e,s,c)))),h=this.privProperties.getProperty(u.PropertyId.SpeechServiceConnection_Key,void 0),d=h&&h!==""?new r.CognitiveSubscriptionKeyAuthentication(h):new r.CognitiveTokenAuthentication(()=>{const l=this.privProperties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)},()=>{const l=this.privProperties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)});this.privAdapter=this.createSynthesisAdapter(d,this.privConnectionFactory,p),this.privRestAdapter=this.createRestSynthesisAdapter(d,p)}static XMLEncode(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};Se.Synthesizer=o;class a{constructor(e,s,c,p,h,d){this.requestId=e,this.text=s,this.isSSML=c,this.cb=p,this.err=h,this.dataStream=d}}return Se.SynthesisRequest=a,Se}var Er={},Ec;function xv(){if(Ec)return Er;Ec=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.SpeechSynthesizer=void 0;const r=E(),t=I(),i=bp(),u=Fi(),o=Oe(),a=A(),n=y(),e=gs();let s=class rh extends n.Synthesizer{constructor(p,h){super(p),h!==null&&(h===void 0?this.audioConfig=typeof window>"u"?void 0:n.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=h),this.privConnectionFactory=new r.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(p,h,d){const l=p;return h.properties.mergeTo(l.properties),new rh(p,d)}speakTextAsync(p,h,d,l){this.speakImpl(p,!1,h,d,l)}speakSsmlAsync(p,h,d,l){this.speakImpl(p,!0,h,d,l)}async getVoicesAsync(p=""){return this.getVoices(p)}close(p,h){a.Contracts.throwIfDisposed(this.privDisposed),t.marshalPromiseToCallbacks(this.dispose(!0),p,h)}get internalData(){return this.privAdapter}createSynthesisAdapter(p,h,d){return new r.SpeechSynthesisAdapter(p,h,d,this,this.audioConfig)}createRestSynthesisAdapter(p,h){return new r.SynthesisRestAdapter(h,p)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(n.SpeechSynthesisOutputFormat[this.properties.getProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(p,h,d,l,f){try{a.Contracts.throwIfDisposed(this.privDisposed);const v=t.createNoDashGuid();let g;f instanceof n.PushAudioOutputStreamCallback?g=new o.PushAudioOutputStreamImpl(f):f instanceof n.PullAudioOutputStream?g=f:f!==void 0?g=new i.AudioFileWriter(f):g=void 0,this.synthesisRequestQueue.enqueue(new e.SynthesisRequest(v,p,h,S=>{if(this.privSynthesizing=!1,d)try{d(S)}catch(m){l&&l(m)}d=void 0,this.adapterSpeak().catch(()=>{})},S=>{l&&l(S)},g)),this.adapterSpeak().catch(()=>{})}catch(v){if(l)if(v instanceof Error){const g=v;l(g.name+": "+g.message)}else l(v);this.dispose(!0).catch(()=>{})}}async getVoices(p){const h=t.createNoDashGuid(),d=await this.privRestAdapter.getVoicesList(h);if(d.ok&&Array.isArray(d.json)){let l=d.json;return p&&p.length>0&&(l=l.filter(f=>!!f.Locale&&f.Locale.toLowerCase()===p.toLowerCase())),new n.SynthesisVoicesResult(h,l,void 0)}else return new n.SynthesisVoicesResult(h,void 0,`Error: ${d.status}: ${d.statusText}`)}};return Er.SpeechSynthesizer=s,Er}var Ir={},Ic;function Fv(){if(Ic)return Ir;Ic=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.SynthesisResult=void 0;let r=class{constructor(i,u,o,a){this.privResultId=i,this.privReason=u,this.privErrorDetails=o,this.privProperties=a}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};return Ir.SynthesisResult=r,Ir}var Ar={},Ac;function Uv(){if(Ac)return Ar;Ac=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.SpeechSynthesisResult=void 0;const r=y();let t=class extends r.SynthesisResult{constructor(u,o,a,n,e,s){super(u,o,n,e),this.privAudioData=a,this.privAudioDuration=s}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return Ar.SpeechSynthesisResult=t,Ar}var Tr={},Tc;function Wv(){if(Tc)return Tr;Tc=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.SpeechSynthesisEventArgs=void 0;let r=class{constructor(i){this.privResult=i}get result(){return this.privResult}};return Tr.SpeechSynthesisEventArgs=r,Tr}var wr={},wc;function Vv(){if(wc)return wr;wc=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.SpeechSynthesisWordBoundaryEventArgs=void 0;let r=class{constructor(i,u,o,a,n,e){this.privAudioOffset=i,this.privDuration=u,this.privText=o,this.privWordLength=a,this.privTextOffset=n,this.privBoundaryType=e}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};return wr.SpeechSynthesisWordBoundaryEventArgs=r,wr}var _r={},_c;function Hv(){if(_c)return _r;_c=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.SpeechSynthesisBookmarkEventArgs=void 0;let r=class{constructor(i,u){this.privAudioOffset=i,this.privText=u}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};return _r.SpeechSynthesisBookmarkEventArgs=r,_r}var br={},bc;function Kv(){if(bc)return br;bc=1,Object.defineProperty(br,"__esModule",{value:!0}),br.SpeechSynthesisVisemeEventArgs=void 0;let r=class{constructor(i,u,o){this.privAudioOffset=i,this.privVisemeId=u,this.privAnimation=o}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};return br.SpeechSynthesisVisemeEventArgs=r,br}var Ln={},Mc;function $v(){return Mc||(Mc=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SpeechSynthesisBoundaryType=void 0,function(t){t.Word="WordBoundary",t.Punctuation="PunctuationBoundary",t.Sentence="SentenceBoundary"}(r.SpeechSynthesisBoundaryType||(r.SpeechSynthesisBoundaryType={}))}(Ln)),Ln}var Mr={},Oc;function Jv(){if(Oc)return Mr;Oc=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.SynthesisVoicesResult=void 0;const r=y();let t=class extends r.SynthesisResult{constructor(u,o,a){if(Array.isArray(o)){super(u,r.ResultReason.VoicesListRetrieved,void 0,new r.PropertyCollection),this.privVoices=[];for(const n of o)this.privVoices.push(new r.VoiceInfo(n))}else super(u,r.ResultReason.Canceled,a||"Error information unavailable",new r.PropertyCollection)}get voices(){return this.privVoices}};return Mr.SynthesisVoicesResult=t,Mr}var qn={},Dc;function Gv(){return Dc||(Dc=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.VoiceInfo=r.SynthesisVoiceType=r.SynthesisVoiceGender=void 0;var t;(function(n){n[n.Unknown=0]="Unknown",n[n.Female=1]="Female",n[n.Male=2]="Male",n[n.Neutral=3]="Neutral"})(t=r.SynthesisVoiceGender||(r.SynthesisVoiceGender={}));var i;(function(n){n[n.Unknown=0]="Unknown",n[n.OnlineNeural=1]="OnlineNeural",n[n.OnlineStandard=2]="OnlineStandard",n[n.OfflineNeural=3]="OfflineNeural",n[n.OfflineStandard=4]="OfflineStandard",n[n.OnlineNeuralHD=5]="OnlineNeuralHD"})(i=r.SynthesisVoiceType||(r.SynthesisVoiceType={}));const u={[t[t.Neutral]]:t.Neutral,[t[t.Male]]:t.Male,[t[t.Female]]:t.Female},o={Neural:i.OnlineNeural,NeuralHD:i.OnlineNeuralHD};class a{constructor(e){if(this.privStyleList=[],e){if(this.privName=e.Name,this.privLocale=e.Locale,this.privShortName=e.ShortName,this.privLocaleName=e.LocaleName,this.privDisplayName=e.DisplayName,this.privLocalName=e.LocalName,this.privVoiceType=o[e.VoiceType]||i.Unknown,this.privGender=u[e.Gender]||t.Unknown,e.StyleList&&Array.isArray(e.StyleList))for(const s of e.StyleList)this.privStyleList.push(s);this.privSampleRateHertz=e.SampleRateHertz,this.privStatus=e.Status,e.ExtendedPropertyMap&&(this.privExtendedPropertyMap=e.ExtendedPropertyMap),this.privWordsPerMinute=e.WordsPerMinute,Array.isArray(e.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...e.SecondaryLocaleList]),Array.isArray(e.RolePlayList)&&(this.privRolePlayList=[...e.RolePlayList]),e.VoiceTag&&(this.privVoiceTag=e.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}r.VoiceInfo=a}(qn)),qn}var Or={},kc;function Qv(){if(kc)return Or;kc=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.SpeakerAudioDestination=void 0;const r=I(),t=Oe(),i=_e(),u=60*30,o={[i.AudioFormatTag.PCM]:"audio/wav",[i.AudioFormatTag.MuLaw]:"audio/x-wav",[i.AudioFormatTag.MP3]:"audio/mpeg",[i.AudioFormatTag.OGG_OPUS]:"audio/ogg",[i.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[i.AudioFormatTag.ALaw]:"audio/x-wav",[i.AudioFormatTag.FLAC]:"audio/flac",[i.AudioFormatTag.AMR_WB]:"audio/amr-wb",[i.AudioFormatTag.G722]:"audio/G722"};let a=class{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||r.createNoDashGuid(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,s,c){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then(()=>{s&&s()},p=>{c&&c(p)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,s){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{e&&e()},c=>{s&&s(c)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===i.AudioFormatTag.PCM||this.privFormat.formatTag===i.AudioFormatTag.MuLaw||this.privFormat.formatTag===i.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let c=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(c).then(()=>{c=this.privFormat.addHeader(c);const p=new Blob([c],{type:o[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(p),this.notifyPlayback().then(()=>{e&&e()},h=>{s&&s(h)})},p=>{s&&s(p)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=e;const s=o[this.privFormat.formatTag];s===void 0?console.warn(`Unknown mimeType for format ${i.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(s)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=u,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(s),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(c=>{r.Events.instance.onEvent(new r.BackgroundEvent(c))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(c=>{r.Events.instance.onEvent(new r.BackgroundEvent(c))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(c=>{r.Events.instance.onEvent(new r.BackgroundEvent(c))})):(console.warn(`Format ${i.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){return this.privAudio?.volume??-1}set volume(e){this.privAudio&&(this.privAudio.volume=e)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,s){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{e&&e()},c=>{s&&s(c)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch{this.privAudioBuffer.unshift(e),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};return Or.SpeakerAudioDestination=a,Or}var Dr={},zc;function Xv(){if(zc)return Dr;zc=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.ConversationTranscriptionCanceledEventArgs=void 0;const r=Ui();let t=class extends r.CancellationEventArgsBase{};return Dr.ConversationTranscriptionCanceledEventArgs=t,Dr}var kr={},Nc;function Zv(){if(Nc)return kr;Nc=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.MeetingTranscriptionCanceledEventArgs=void 0;const r=Ui();let t=class extends r.CancellationEventArgsBase{};return kr.MeetingTranscriptionCanceledEventArgs=t,kr}var Bn={},jc;function Yv(){return jc||(jc=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.PronunciationAssessmentGradingSystem=void 0,function(t){t[t.FivePoint=1]="FivePoint",t[t.HundredMark=2]="HundredMark"}(r.PronunciationAssessmentGradingSystem||(r.PronunciationAssessmentGradingSystem={}))}(Bn)),Bn}var xn={},Lc;function ef(){return Lc||(Lc=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.PronunciationAssessmentGranularity=void 0,function(t){t[t.Phoneme=1]="Phoneme",t[t.Word=2]="Word",t[t.FullText=3]="FullText"}(r.PronunciationAssessmentGranularity||(r.PronunciationAssessmentGranularity={}))}(xn)),xn}var zr={},qc;function tf(){if(qc)return zr;qc=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.PronunciationAssessmentConfig=void 0;const r=A(),t=y();let i=class ih{constructor(o,a=t.PronunciationAssessmentGradingSystem.FivePoint,n=t.PronunciationAssessmentGranularity.Phoneme,e=!1){r.Contracts.throwIfNullOrUndefined(o,"referenceText"),this.privProperties=new t.PropertyCollection,this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,o),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_GradingSystem,t.PronunciationAssessmentGradingSystem[a]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Granularity,t.PronunciationAssessmentGranularity[n]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,String(e))}static fromJSON(o){r.Contracts.throwIfNullOrUndefined(o,"json");const a=new ih("");return a.privProperties=new t.PropertyCollection,a.properties.setProperty(t.PropertyId.PronunciationAssessment_Json,o),a}toJSON(){return this.updateJson(),this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Params)}applyTo(o){this.updateJson();const a=o.internalData;a.expectContentAssessmentResponse=!!this.privContentAssessmentTopic,a.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(t.PropertyId.PronunciationAssessment_Params),this.privContentAssessmentTopic,a.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(o){r.Contracts.throwIfNullOrWhitespace(o,"referenceText"),this.properties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,o)}set phonemeAlphabet(o){r.Contracts.throwIfNullOrWhitespace(o,"phonemeAlphabet"),this.privPhonemeAlphabet=o}set enableMiscue(o){const a=o?"true":"false";this.properties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,a)}get enableMiscue(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(o){this.privNBestPhonemeCount=o}set enableProsodyAssessment(o){this.privEnableProsodyAssessment=o}enableContentAssessmentWithTopic(o){this.privContentAssessmentTopic=o}get properties(){return this.privProperties}updateJson(){const o=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Json,"{}"),a=JSON.parse(o),n=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText);n&&(a.referenceText=n);const e=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_GradingSystem);e&&(a.gradingSystem=e);const s=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Granularity);s&&(a.granularity=s),this.privPhonemeAlphabet&&(a.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(a.nbestPhonemeCount=this.privNBestPhonemeCount),a.enableProsodyAssessment=this.privEnableProsodyAssessment,a.dimension="Comprehensive",this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue)&&(a.enableMiscue=this.enableMiscue),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Params,JSON.stringify(a))}};return zr.PronunciationAssessmentConfig=i,zr}var me={},Bc;function rf(){if(Bc)return me;Bc=1,Object.defineProperty(me,"__esModule",{value:!0}),me.PronunciationAssessmentResult=me.ContentAssessmentResult=void 0;const r=A(),t=y();class i{constructor(a){this.privPronJson=a}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}}me.ContentAssessmentResult=i;let u=class nh{constructor(a){const n=JSON.parse(a);r.Contracts.throwIfNullOrUndefined(n.NBest[0],"NBest"),this.privPronJson=n.NBest[0]}static fromResult(a){r.Contracts.throwIfNullOrUndefined(a,"result");const n=a.properties.getProperty(t.PropertyId.SpeechServiceResponse_JsonResult);return r.Contracts.throwIfNullOrUndefined(n,"json"),new nh(n)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment?.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment?.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment?.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment?.FluencyScore}get prosodyScore(){return this.detailResult.PronunciationAssessment?.ProsodyScore}get contentAssessmentResult(){if(this.detailResult.ContentAssessment!==void 0)return new i(this.detailResult)}};return me.PronunciationAssessmentResult=u,me}var Nr={},xc;function nf(){if(xc)return Nr;xc=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.AvatarConfig=void 0;const r=A(),t=y();let i=class{constructor(o,a,n){this.privCustomized=!1,this.privUseBuiltInVoice=!1,r.Contracts.throwIfNullOrWhitespace(o,"character"),this.character=o,this.style=a,n===void 0&&(n=new t.AvatarVideoFormat),this.videoFormat=n}get customized(){return this.privCustomized}set customized(o){this.privCustomized=o}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(o){this.privUseBuiltInVoice=o}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(o){this.privBackgroundColor=o}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(o){this.privBackgroundImage=o}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(o){this.privRemoteIceServers=o}};return Nr.AvatarConfig=i,Nr}var Fn={},Fc;function sf(){return Fc||(Fc=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.AvatarEventArgs=r.AvatarEventTypes=void 0,function(i){i.SwitchedToSpeaking="SwitchedToSpeaking",i.SwitchedToIdle="SwitchedToIdle",i.SessionClosed="SessionClosed"}(r.AvatarEventTypes||(r.AvatarEventTypes={}));class t{constructor(u,o){this.privOffset=u,this.privDescription=o}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}r.AvatarEventArgs=t}(Fn)),Fn}var jr={},Lr={},Uc;function sh(){if(Uc)return Lr;Uc=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.SpeechSynthesisConnectionFactory=void 0;const r=k(),t=y(),i=H(),u=E(),o=N(),a=ee();let n=class{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1"}create(s,c,p){let h=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const d=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),l=i.ConnectionFactoryBase.getHostSuffix(d),f=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),v=f===void 0?"tts":"voice",g=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+d+"."+v+".speech"+l),S={},m={};c.token!==void 0&&c.token!==""&&(m[c.headerName]=c.token),m[o.HeaderNames.ConnectionId]=p,f!==void 0&&f!==""&&(!h||h.search(a.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(S[a.QueryParameterNames.CustomVoiceDeploymentId]=f),s.avatarEnabled&&(!h||h.search(a.QueryParameterNames.EnableAvatar)===-1)&&(S[a.QueryParameterNames.EnableAvatar]="true"),h||(h=g+this.synthesisUri),s.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,h);const C=s.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new r.WebsocketConnection(h,S,m,new u.WebsocketMessageFormatter,r.ProxyInfo.fromParameters(s.parameters),C,p)}};return Lr.SpeechSynthesisConnectionFactory=n,Lr}var Wc;function of(){if(Wc)return jr;Wc=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.AvatarSynthesizer=void 0;const r=sh(),t=E(),i=I(),u=Fi(),o=y(),a=A(),n=gs();let e=class extends o.Synthesizer{constructor(c,p){super(c),a.Contracts.throwIfNullOrUndefined(p,"avatarConfig"),this.privConnectionFactory=new r.SpeechSynthesisConnectionFactory,this.privAvatarConfig=p,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(o.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(c){a.Contracts.throwIfNullOrUndefined(c,"peerConnection"),this.privIceServers=c.getConfiguration().iceServers,a.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const p=new i.Deferred;c.onicegatheringstatechange=()=>{i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice gathering state: "+c.iceGatheringState,i.EventType.Debug)),c.iceGatheringState==="complete"&&(i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice gathering complete.",i.EventType.Info)),p.resolve())},c.onicecandidate=v=>{v.candidate?i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice candidate: "+v.candidate.candidate,i.EventType.Debug)):(i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice candidate: complete",i.EventType.Debug)),p.resolve())},setTimeout(()=>{c.iceGatheringState!=="complete"&&(i.Events.instance.onEvent(new i.PlatformEvent("peer connection: ice gathering timeout.",i.EventType.Warning)),p.resolve())},2e3);const h=await c.createOffer();await c.setLocalDescription(h),await p.promise,i.Events.instance.onEvent(new i.PlatformEvent("peer connection: got local SDP.",i.EventType.Info)),this.privProperties.setProperty(o.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(c.localDescription));const d=await this.speak("",!1);if(d.reason!==o.ResultReason.SynthesizingAudioCompleted)return new o.SynthesisResult(d.resultId,d.reason,d.errorDetails,d.properties);const l=atob(d.properties.getProperty(o.PropertyId.TalkingAvatarService_WebRTC_SDP)),f=new RTCSessionDescription(JSON.parse(l));return await c.setRemoteDescription(f),new o.SynthesisResult(d.resultId,d.reason,void 0,d.properties)}async speakTextAsync(c){const p=await this.speak(c,!1);return new o.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async speakSsmlAsync(c){const p=await this.speak(c,!0);return new o.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return a.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(c,p,h){return new t.AvatarSynthesisAdapter(c,p,h,this,this.privAvatarConfig)}createRestSynthesisAdapter(c,p){}createSynthesizerConfig(c){const p=super.createSynthesizerConfig(c);return p.avatarEnabled=!0,p}async speak(c,p){const h=i.createNoDashGuid(),d=new i.Deferred;return this.synthesisRequestQueue.enqueue(new n.SynthesisRequest(h,c,p,l=>{d.resolve(l),this.privSynthesizing=!1,this.adapterSpeak()},l=>{d.reject(l),this.privSynthesizing=!1})),this.adapterSpeak(),d.promise}};return jr.AvatarSynthesizer=e,jr}var Ce={},Vc;function af(){if(Vc)return Ce;Vc=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.AvatarVideoFormat=Ce.Coordinate=void 0;class r{constructor(u,o){this.x=u,this.y=o}}Ce.Coordinate=r;let t=class{constructor(u="H264",o=2e6,a=1920,n=1080){this.codec=u,this.bitrate=o,this.width=a,this.height=n}setCropRange(u,o){this.cropRange={bottomRight:o,topLeft:u}}};return Ce.AvatarVideoFormat=t,Ce}var qr={},Hc;function cf(){if(Hc)return qr;Hc=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.AvatarWebRTCConnectionResult=void 0;const r=y();let t=class extends r.SynthesisResult{constructor(u,o,a,n,e){super(o,a,n,e),this.privSDPAnswer=u}get SDPAnswer(){return this.privSDPAnswer}};return qr.AvatarWebRTCConnectionResult=t,qr}var Br={},Kc;function uf(){if(Kc)return Br;Kc=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.Diagnostics=void 0;const r=k(),t=I();let i=class{static SetLoggingLevel(o){this.privListener=new r.ConsoleLoggingListener(o),t.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(o){if(typeof window>"u")this.privListener&&(this.privListener.logPath=o);else throw new Error("File system logging not available in browser.")}static set onLogOutput(o){this.privListener&&(this.privListener.logCallback=o)}};return Br.Diagnostics=i,i.privListener=void 0,Br}var $c;function y(){return $c||($c=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=kp();Object.defineProperty(r,"AudioConfig",{enumerable:!0,get:function(){return t.AudioConfig}});var i=_e();Object.defineProperty(r,"AudioStreamFormat",{enumerable:!0,get:function(){return i.AudioStreamFormat}}),Object.defineProperty(r,"AudioFormatTag",{enumerable:!0,get:function(){return i.AudioFormatTag}});var u=Mp();Object.defineProperty(r,"AudioInputStream",{enumerable:!0,get:function(){return u.AudioInputStream}}),Object.defineProperty(r,"PullAudioInputStream",{enumerable:!0,get:function(){return u.PullAudioInputStream}}),Object.defineProperty(r,"PushAudioInputStream",{enumerable:!0,get:function(){return u.PushAudioInputStream}});var o=Oe();Object.defineProperty(r,"AudioOutputStream",{enumerable:!0,get:function(){return o.AudioOutputStream}}),Object.defineProperty(r,"PullAudioOutputStream",{enumerable:!0,get:function(){return o.PullAudioOutputStream}}),Object.defineProperty(r,"PushAudioOutputStream",{enumerable:!0,get:function(){return o.PushAudioOutputStream}});var a=Rl();Object.defineProperty(r,"CancellationReason",{enumerable:!0,get:function(){return a.CancellationReason}});var n=Pl();Object.defineProperty(r,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return n.PullAudioInputStreamCallback}});var e=El();Object.defineProperty(r,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return e.PushAudioOutputStreamCallback}});var s=Il();Object.defineProperty(r,"KeywordRecognitionModel",{enumerable:!0,get:function(){return s.KeywordRecognitionModel}});var c=Al();Object.defineProperty(r,"SessionEventArgs",{enumerable:!0,get:function(){return c.SessionEventArgs}});var p=Tl();Object.defineProperty(r,"RecognitionEventArgs",{enumerable:!0,get:function(){return p.RecognitionEventArgs}});var h=wl();Object.defineProperty(r,"OutputFormat",{enumerable:!0,get:function(){return h.OutputFormat}});var d=_l();Object.defineProperty(r,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return d.IntentRecognitionEventArgs}});var l=bl();Object.defineProperty(r,"RecognitionResult",{enumerable:!0,get:function(){return l.RecognitionResult}});var f=Ml();Object.defineProperty(r,"SpeechRecognitionResult",{enumerable:!0,get:function(){return f.SpeechRecognitionResult}});var v=Ol();Object.defineProperty(r,"IntentRecognitionResult",{enumerable:!0,get:function(){return v.IntentRecognitionResult}});var g=Dl();Object.defineProperty(r,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return g.LanguageUnderstandingModel}});var S=kl();Object.defineProperty(r,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return S.SpeechRecognitionEventArgs}}),Object.defineProperty(r,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return S.ConversationTranscriptionEventArgs}}),Object.defineProperty(r,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return S.MeetingTranscriptionEventArgs}});var m=zl();Object.defineProperty(r,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return m.SpeechRecognitionCanceledEventArgs}});var C=Nl();Object.defineProperty(r,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return C.TranslationRecognitionEventArgs}});var P=jl();Object.defineProperty(r,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return P.TranslationSynthesisEventArgs}});var R=Np();Object.defineProperty(r,"TranslationRecognitionResult",{enumerable:!0,get:function(){return R.TranslationRecognitionResult}});var w=Ll();Object.defineProperty(r,"TranslationSynthesisResult",{enumerable:!0,get:function(){return w.TranslationSynthesisResult}});var D=ql();Object.defineProperty(r,"ResultReason",{enumerable:!0,get:function(){return D.ResultReason}});var _=Bl();Object.defineProperty(r,"SpeechConfig",{enumerable:!0,get:function(){return _.SpeechConfig}}),Object.defineProperty(r,"SpeechConfigImpl",{enumerable:!0,get:function(){return _.SpeechConfigImpl}});var L=xl();Object.defineProperty(r,"SpeechTranslationConfig",{enumerable:!0,get:function(){return L.SpeechTranslationConfig}}),Object.defineProperty(r,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return L.SpeechTranslationConfigImpl}});var be=Lp();Object.defineProperty(r,"PropertyCollection",{enumerable:!0,get:function(){return be.PropertyCollection}});var Wi=ls();Object.defineProperty(r,"PropertyId",{enumerable:!0,get:function(){return Wi.PropertyId}});var Vi=Fl();Object.defineProperty(r,"Recognizer",{enumerable:!0,get:function(){return Vi.Recognizer}});var q=Ul();Object.defineProperty(r,"SpeechRecognizer",{enumerable:!0,get:function(){return q.SpeechRecognizer}});var Cs=Wl();Object.defineProperty(r,"IntentRecognizer",{enumerable:!0,get:function(){return Cs.IntentRecognizer}});var Rh=Vl();Object.defineProperty(r,"VoiceProfileType",{enumerable:!0,get:function(){return Rh.VoiceProfileType}});var Ph=Hl();Object.defineProperty(r,"TranslationRecognizer",{enumerable:!0,get:function(){return Ph.TranslationRecognizer}});var Eh=Kl();Object.defineProperty(r,"Translations",{enumerable:!0,get:function(){return Eh.Translations}});var Ih=$l();Object.defineProperty(r,"NoMatchReason",{enumerable:!0,get:function(){return Ih.NoMatchReason}});var Ah=Jl();Object.defineProperty(r,"NoMatchDetails",{enumerable:!0,get:function(){return Ah.NoMatchDetails}});var Th=Gl();Object.defineProperty(r,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return Th.TranslationRecognitionCanceledEventArgs}});var wh=Ql();Object.defineProperty(r,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return wh.IntentRecognitionCanceledEventArgs}});var _h=Vp();Object.defineProperty(r,"CancellationDetailsBase",{enumerable:!0,get:function(){return _h.CancellationDetailsBase}});var bh=Xl();Object.defineProperty(r,"CancellationDetails",{enumerable:!0,get:function(){return bh.CancellationDetails}});var Mh=Zl();Object.defineProperty(r,"CancellationErrorCode",{enumerable:!0,get:function(){return Mh.CancellationErrorCode}});var Oh=Yl();Object.defineProperty(r,"ConnectionEventArgs",{enumerable:!0,get:function(){return Oh.ConnectionEventArgs}});var Dh=ev();Object.defineProperty(r,"ServiceEventArgs",{enumerable:!0,get:function(){return Dh.ServiceEventArgs}});var kh=Fp();Object.defineProperty(r,"Connection",{enumerable:!0,get:function(){return kh.Connection}});var zh=tv();Object.defineProperty(r,"PhraseListGrammar",{enumerable:!0,get:function(){return zh.PhraseListGrammar}});var Nh=vs();Object.defineProperty(r,"DialogServiceConfig",{enumerable:!0,get:function(){return Nh.DialogServiceConfig}});var jh=rv();Object.defineProperty(r,"BotFrameworkConfig",{enumerable:!0,get:function(){return jh.BotFrameworkConfig}});var Lh=iv();Object.defineProperty(r,"CustomCommandsConfig",{enumerable:!0,get:function(){return Lh.CustomCommandsConfig}});var qh=sv();Object.defineProperty(r,"DialogServiceConnector",{enumerable:!0,get:function(){return qh.DialogServiceConnector}});var Bh=ov();Object.defineProperty(r,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return Bh.ActivityReceivedEventArgs}});var xh=cv();Object.defineProperty(r,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return xh.TurnStatusReceivedEventArgs}});var Fh=uv();Object.defineProperty(r,"ServicePropertyChannel",{enumerable:!0,get:function(){return Fh.ServicePropertyChannel}});var Uh=pv();Object.defineProperty(r,"ProfanityOption",{enumerable:!0,get:function(){return Uh.ProfanityOption}});var Wh=hv();Object.defineProperty(r,"BaseAudioPlayer",{enumerable:!0,get:function(){return Wh.BaseAudioPlayer}});var Vh=dv();Object.defineProperty(r,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return Vh.ConnectionMessageEventArgs}});var Hh=xp();Object.defineProperty(r,"ConnectionMessage",{enumerable:!0,get:function(){return Hh.ConnectionMessage}});var Kh=lv();Object.defineProperty(r,"VoiceProfile",{enumerable:!0,get:function(){return Kh.VoiceProfile}});var ys=vv();Object.defineProperty(r,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return ys.VoiceProfileEnrollmentResult}}),Object.defineProperty(r,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return ys.VoiceProfileEnrollmentCancellationDetails}});var Rs=fv();Object.defineProperty(r,"VoiceProfileResult",{enumerable:!0,get:function(){return Rs.VoiceProfileResult}}),Object.defineProperty(r,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return Rs.VoiceProfileCancellationDetails}});var $h=gv();Object.defineProperty(r,"VoiceProfilePhraseResult",{enumerable:!0,get:function(){return $h.VoiceProfilePhraseResult}});var Jh=Sv();Object.defineProperty(r,"VoiceProfileClient",{enumerable:!0,get:function(){return Jh.VoiceProfileClient}});var Gh=mv();Object.defineProperty(r,"SpeakerRecognizer",{enumerable:!0,get:function(){return Gh.SpeakerRecognizer}});var Qh=Cv();Object.defineProperty(r,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return Qh.SpeakerIdentificationModel}});var Xh=yv();Object.defineProperty(r,"SpeakerVerificationModel",{enumerable:!0,get:function(){return Xh.SpeakerVerificationModel}});var Zh=Rv();Object.defineProperty(r,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return Zh.AutoDetectSourceLanguageConfig}});var Yh=Pv();Object.defineProperty(r,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return Yh.AutoDetectSourceLanguageResult}});var ed=Ev();Object.defineProperty(r,"SourceLanguageConfig",{enumerable:!0,get:function(){return ed.SourceLanguageConfig}});var Qi=Iv();Object.defineProperty(r,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return Qi.SpeakerRecognitionResult}}),Object.defineProperty(r,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return Qi.SpeakerRecognitionResultType}}),Object.defineProperty(r,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return Qi.SpeakerRecognitionCancellationDetails}});var j=fs();Object.defineProperty(r,"Conversation",{enumerable:!0,get:function(){return j.Conversation}}),Object.defineProperty(r,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return j.ConversationExpirationEventArgs}}),Object.defineProperty(r,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return j.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(r,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return j.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(r,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return j.ConversationTranslationEventArgs}}),Object.defineProperty(r,"ConversationTranslationResult",{enumerable:!0,get:function(){return j.ConversationTranslationResult}}),Object.defineProperty(r,"ConversationTranslator",{enumerable:!0,get:function(){return j.ConversationTranslator}}),Object.defineProperty(r,"ConversationTranscriber",{enumerable:!0,get:function(){return j.ConversationTranscriber}}),Object.defineProperty(r,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return j.ConversationTranscriptionResult}}),Object.defineProperty(r,"Meeting",{enumerable:!0,get:function(){return j.Meeting}}),Object.defineProperty(r,"MeetingTranscriber",{enumerable:!0,get:function(){return j.MeetingTranscriber}}),Object.defineProperty(r,"Participant",{enumerable:!0,get:function(){return j.Participant}}),Object.defineProperty(r,"ParticipantChangedReason",{enumerable:!0,get:function(){return j.ParticipantChangedReason}}),Object.defineProperty(r,"User",{enumerable:!0,get:function(){return j.User}});var td=gs();Object.defineProperty(r,"Synthesizer",{enumerable:!0,get:function(){return td.Synthesizer}});var rd=Op();Object.defineProperty(r,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return rd.SpeechSynthesisOutputFormat}});var id=xv();Object.defineProperty(r,"SpeechSynthesizer",{enumerable:!0,get:function(){return id.SpeechSynthesizer}});var nd=Fv();Object.defineProperty(r,"SynthesisResult",{enumerable:!0,get:function(){return nd.SynthesisResult}});var sd=Uv();Object.defineProperty(r,"SpeechSynthesisResult",{enumerable:!0,get:function(){return sd.SpeechSynthesisResult}});var od=Wv();Object.defineProperty(r,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return od.SpeechSynthesisEventArgs}});var ad=Vv();Object.defineProperty(r,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return ad.SpeechSynthesisWordBoundaryEventArgs}});var cd=Hv();Object.defineProperty(r,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return cd.SpeechSynthesisBookmarkEventArgs}});var ud=Kv();Object.defineProperty(r,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return ud.SpeechSynthesisVisemeEventArgs}});var pd=$v();Object.defineProperty(r,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return pd.SpeechSynthesisBoundaryType}});var hd=Jv();Object.defineProperty(r,"SynthesisVoicesResult",{enumerable:!0,get:function(){return hd.SynthesisVoicesResult}});var Xi=Gv();Object.defineProperty(r,"SynthesisVoiceGender",{enumerable:!0,get:function(){return Xi.SynthesisVoiceGender}}),Object.defineProperty(r,"SynthesisVoiceType",{enumerable:!0,get:function(){return Xi.SynthesisVoiceType}}),Object.defineProperty(r,"VoiceInfo",{enumerable:!0,get:function(){return Xi.VoiceInfo}});var dd=Qv();Object.defineProperty(r,"SpeakerAudioDestination",{enumerable:!0,get:function(){return dd.SpeakerAudioDestination}});var ld=Xv();Object.defineProperty(r,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return ld.ConversationTranscriptionCanceledEventArgs}});var vd=Zv();Object.defineProperty(r,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return vd.MeetingTranscriptionCanceledEventArgs}});var fd=Yv();Object.defineProperty(r,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return fd.PronunciationAssessmentGradingSystem}});var gd=ef();Object.defineProperty(r,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return gd.PronunciationAssessmentGranularity}});var Sd=tf();Object.defineProperty(r,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return Sd.PronunciationAssessmentConfig}});var md=rf();Object.defineProperty(r,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return md.PronunciationAssessmentResult}});var Cd=Gp();Object.defineProperty(r,"LanguageIdMode",{enumerable:!0,get:function(){return Cd.LanguageIdMode}});var yd=nf();Object.defineProperty(r,"AvatarConfig",{enumerable:!0,get:function(){return yd.AvatarConfig}});var Rd=sf();Object.defineProperty(r,"AvatarEventArgs",{enumerable:!0,get:function(){return Rd.AvatarEventArgs}});var Pd=of();Object.defineProperty(r,"AvatarSynthesizer",{enumerable:!0,get:function(){return Pd.AvatarSynthesizer}});var Ps=af();Object.defineProperty(r,"AvatarVideoFormat",{enumerable:!0,get:function(){return Ps.AvatarVideoFormat}}),Object.defineProperty(r,"Coordinate",{enumerable:!0,get:function(){return Ps.Coordinate}});var Ed=cf();Object.defineProperty(r,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return Ed.AvatarWebRTCConnectionResult}});var Id=uf();Object.defineProperty(r,"Diagnostics",{enumerable:!0,get:function(){return Id.Diagnostics}});var Ad=wp();Object.defineProperty(r,"LogLevel",{enumerable:!0,get:function(){return Ad.LogLevel}})}(Rn)),Rn}var Jc;function pf(){if(Jc)return lt;Jc=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.ProxyInfo=void 0;const r=y();let t=class oh{constructor(u,o,a,n){this.privProxyHostName=u,this.privProxyPort=o,this.privProxyUserName=a,this.privProxyPassword=n}static fromParameters(u){return new oh(u.getProperty(r.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(u.getProperty(r.PropertyId.SpeechServiceConnection_ProxyPort),10),u.getProperty(r.PropertyId.SpeechServiceConnection_ProxyUserName),u.getProperty(r.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(u){return this.fromParameters(u.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return lt.ProxyInfo=t,lt}var xr={},Un,Gc;function hf(){if(Gc)return Un;Gc=1;const r=new Set(["json","buffer","string"]);return Un=t=>(...i)=>{const u=new Set;let o,a,n,e="";return i.forEach(s=>{if(typeof s=="string")if(s.toUpperCase()===s)if(o){const c=`Can't set method to ${s}, already set to ${o}.`;throw new Error(c)}else o=s;else if(s.startsWith("http:")||s.startsWith("https:"))e=s;else if(r.has(s))a=s;else throw new Error(`Unknown encoding, ${s}`);else if(typeof s=="number")u.add(s);else if(typeof s=="object")if(Array.isArray(s)||s instanceof Set)s.forEach(c=>u.add(c));else{if(n)throw new Error("Cannot set headers twice.");n=s}else throw new Error(`Unknown type: ${typeof s}`)}),o||(o="GET"),u.size===0&&u.add(200),t(u,o,a,n,e)},Un}var Wn,Qc;function df(){if(Qc)return Wn;Qc=1;const r=hf();class t extends Error{constructor(o,...a){super(...a),Error.captureStackTrace&&Error.captureStackTrace(this,t),this.name="StatusError",this.message=o.statusMessage,this.statusCode=o.status,this.res=o,this.json=o.json.bind(o),this.text=o.text.bind(o),this.arrayBuffer=o.arrayBuffer.bind(o);let n;Object.defineProperty(this,"responseBody",{get:()=>(n||(n=this.arrayBuffer()),n)}),this.headers={};for(const[s,c]of o.headers.entries())this.headers[s.toLowerCase()]=c}}return Wn=r((u,o,a,n,e)=>async(s,c,p={})=>{s=e+(s||"");let h=new URL(s);if(n||(n={}),h.username&&(n.Authorization="Basic "+btoa(h.username+":"+h.password),h=new URL(h.protocol+"//"+h.host+h.pathname+h.search)),h.protocol!=="https:"&&h.protocol!=="http:")throw new Error(`Unknown protocol, ${h.protocol}`);if(c&&!(c instanceof ArrayBuffer||ArrayBuffer.isView(c)||typeof c=="string"))if(typeof c=="object")c=JSON.stringify(c),n["Content-Type"]="application/json";else throw new Error("Unknown body type.");p=new Headers({...n||{},...p});const d=await fetch(h,{method:o,headers:p,body:c});if(d.statusCode=d.status,!u.has(d.status))throw new t(d);return a==="json"?d.json():a==="buffer"?d.arrayBuffer():a==="string"?d.text():d}),Wn}var Xc;function lf(){return Xc||(Xc=1,function(r){var t=xr&&xr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(r,"__esModule",{value:!0}),r.RestMessageAdapter=r.RestRequestType=void 0;const i=t(df()),u=I();var o;(function(n){n.Get="GET",n.Post="POST",n.Delete="DELETE",n.File="file"})(o=r.RestRequestType||(r.RestRequestType={}));let a=class{constructor(e){if(!e)throw new u.ArgumentNullError("configParams");this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}static extractHeaderValue(e,s){let c="";try{const p=s.trim().split(/[\r\n]+/),h={};p.forEach(d=>{const l=d.split(": "),f=l.shift().toLowerCase(),v=l.join(": ");h[f]=v}),c=h[e.toLowerCase()]}catch{}return c}set options(e){this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}setHeaders(e,s){this.privHeaders[e]=s}request(e,s,c={},p=null){const h=new u.Deferred,d=e===o.File?"POST":e,l=(v,g={})=>{const S=v;return{data:JSON.stringify(g),headers:JSON.stringify(v.headers),json:g,ok:v.statusCode>=200&&v.statusCode<300,status:v.statusCode,statusText:g.error?g.error.message:S.statusText?S.statusText:S.statusMessage}},f=v=>{const g=i.default(s,d,this.privHeaders,200,201,202,204,400,401,402,403,404),S=this.queryParams(c)===""?"":`?${this.queryParams(c)}`;g(S,v).then(async m=>{if(e===o.Delete||m.statusCode===204)h.resolve(l(m));else try{const C=await m.json();h.resolve(l(m,C))}catch{h.resolve(l(m))}}).catch(m=>{h.reject(m)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),e===o.Post&&p&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),f(p),h.promise}queryParams(e={}){return Object.keys(e).map(s=>encodeURIComponent(s)+"="+encodeURIComponent(e[s])).join("&")}};r.RestMessageAdapter=a}(xr)),xr}var Fr={},Zc;function ah(){if(Zc)return Fr;Zc=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.RestConfigBase=void 0;let r=class $i{static get requestOptions(){return $i.privDefaultRequestOptions}static get configParams(){return $i.privDefaultParams}static get restErrors(){return $i.privRestErrors}};return Fr.RestConfigBase=r,r.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},r.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},r.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},Fr}var Yc;function k(){return Yc||(Yc=1,function(r){var t=oe&&oe.__createBinding||(Object.create?function(u,o,a,n){n===void 0&&(n=a),Object.defineProperty(u,n,{enumerable:!0,get:function(){return o[a]}})}:function(u,o,a,n){n===void 0&&(n=a),u[n]=o[a]}),i=oe&&oe.__exportStar||function(u,o){for(var a in u)a!=="default"&&!o.hasOwnProperty(a)&&t(o,u,a)};Object.defineProperty(r,"__esModule",{value:!0}),i(vl(),r),i(fl(),r),i(gl(),r),i(Sl(),r),i(ml(),r),i(Cl(),r),i(_p(),r),i(yl(),r),i(pf(),r),i(lf(),r),i(ah(),r)}(oe)),oe}var eu;function vf(){if(eu)return at;eu=1,Object.defineProperty(at,"__esModule",{value:!0}),at.IntentConnectionFactory=void 0;const r=k(),t=y(),i=H(),u=E(),o=N();let a=class extends i.ConnectionFactoryBase{create(e,s,c){let p=e.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint);if(!p){const f=e.parameters.getProperty(t.PropertyId.SpeechServiceConnection_IntentRegion),v=i.ConnectionFactoryBase.getHostSuffix(f);p=e.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+f+".sr.speech"+v)+"/speech/recognition/interactive/cognitiveservices/v1"}const h={format:"simple",language:e.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,h,p);const d={};s.token!==void 0&&s.token!==""&&(d[s.headerName]=s.token),d[o.HeaderNames.ConnectionId]=c,e.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,p);const l=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new r.WebsocketConnection(p,h,d,new u.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(e),l,c)}getSpeechRegionFromIntentRegion(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}}};return at.IntentConnectionFactory=a,at}var ye={},tu;function ff(){if(tu)return ye;tu=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.VoiceProfileConnectionFactory=ye.SpeakerRecognitionConnectionFactory=void 0;const r=k(),t=y(),i=H(),u=E(),o=N();class a extends i.ConnectionFactoryBase{create(c,p,h,d){let l=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint);if(!l){const S=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region),m=i.ConnectionFactoryBase.getHostSuffix(S),C=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`wss://${S}.spr-frontend.speech${m}`),P=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");l=`${C}/speaker/ws/${this.scenarioToPath(P)}/${h}`}const f={format:"simple",language:c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(c,f,l);const v={};p.token!==void 0&&p.token!==""&&(v[p.headerName]=p.token),v[o.HeaderNames.ConnectionId]=d,v[o.HeaderNames.SpIDAuthKey]=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Key),c.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,l);const g=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new r.WebsocketConnection(l,f,v,new u.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(c),g,d)}scenarioToPath(c){switch(c){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}}let n=class extends a{create(c,p,h){return super.create(c,p,"recognition",h)}};ye.SpeakerRecognitionConnectionFactory=n;class e extends a{create(c,p,h){return super.create(c,p,"profile",h)}}return ye.VoiceProfileConnectionFactory=e,ye}var Vn={},ru;function Ss(){return ru||(ru=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.RecognitionEndedEvent=r.RecognitionCompletionStatus=r.RecognitionStartedEvent=r.ConnectingToServiceEvent=r.ListeningStartedEvent=r.RecognitionTriggeredEvent=r.SpeechRecognitionEvent=void 0;const t=I();class i extends t.PlatformEvent{constructor(p,h,d,l=t.EventType.Info){super(p,l),this.privRequestId=h,this.privSessionId=d}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}r.SpeechRecognitionEvent=i;class u extends i{constructor(p,h,d,l){super("RecognitionTriggeredEvent",p,h),this.privAudioSourceId=d,this.privAudioNodeId=l}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}r.RecognitionTriggeredEvent=u;class o extends i{constructor(p,h,d,l){super("ListeningStartedEvent",p,h),this.privAudioSourceId=d,this.privAudioNodeId=l}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}r.ListeningStartedEvent=o;class a extends i{constructor(p,h,d){super("ConnectingToServiceEvent",p,d),this.privAuthFetchEventid=h}get authFetchEventid(){return this.privAuthFetchEventid}}r.ConnectingToServiceEvent=a;class n extends i{constructor(p,h,d,l,f){super("RecognitionStartedEvent",p,f),this.privAudioSourceId=h,this.privAudioNodeId=d,this.privAuthFetchEventId=l}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}r.RecognitionStartedEvent=n;var e;(function(c){c[c.Success=0]="Success",c[c.AudioSourceError=1]="AudioSourceError",c[c.AudioSourceTimeout=2]="AudioSourceTimeout",c[c.AuthTokenFetchError=3]="AuthTokenFetchError",c[c.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",c[c.UnAuthorized=5]="UnAuthorized",c[c.ConnectTimeout=6]="ConnectTimeout",c[c.ConnectError=7]="ConnectError",c[c.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",c[c.UnknownError=9]="UnknownError"})(e=r.RecognitionCompletionStatus||(r.RecognitionCompletionStatus={}));class s extends i{constructor(p,h,d,l,f,v,g,S){super("RecognitionEndedEvent",p,f,g===e.Success?t.EventType.Info:t.EventType.Error),this.privAudioSourceId=h,this.privAudioNodeId=d,this.privAuthFetchEventId=l,this.privStatus=g,this.privError=S,this.privServiceTag=v}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}r.RecognitionEndedEvent=s}(Vn)),Vn}var Ur={},Wr={},iu;function De(){if(iu)return Wr;iu=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.SpeechConnectionMessage=void 0;const r=I(),t=N();class i extends r.ConnectionMessage{constructor(o,a,n,e,s,c,p,h){if(!a)throw new r.ArgumentNullError("path");if(!n)throw new r.ArgumentNullError("requestId");const d={};if(d[t.HeaderNames.Path]=a,d[t.HeaderNames.RequestId]=n,d[t.HeaderNames.RequestTimestamp]=new Date().toISOString(),e&&(d[t.HeaderNames.ContentType]=e),c&&(d[t.HeaderNames.RequestStreamId]=c),p)for(const l in p)l&&(d[l]=p[l]);h?super(o,s,d,h):super(o,s,d),this.privPath=a,this.privRequestId=n,this.privContentType=e,this.privStreamId=c,this.privAdditionalHeaders=p}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(o){let a=null,n=null,e=null,s=null;const c={};if(o.headers)for(const p in o.headers)p&&(p.toLowerCase()===t.HeaderNames.Path.toLowerCase()?a=o.headers[p]:p.toLowerCase()===t.HeaderNames.RequestId.toLowerCase()?n=o.headers[p]:p.toLowerCase()===t.HeaderNames.ContentType.toLowerCase()?e=o.headers[p]:p.toLowerCase()===t.HeaderNames.RequestStreamId.toLowerCase()?s=o.headers[p]:c[p]=o.headers[p]);return new i(o.messageType,a,n,e,o.body,s,c,o.id)}}return Wr.SpeechConnectionMessage=i,Wr}var nu;function gf(){if(nu)return Ur;nu=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.ServiceRecognizerBase=void 0;const r=k(),t=I(),i=y(),u=E(),o=De();let a=class qi{constructor(e,s,c,p,h){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!e)throw new t.ArgumentNullError("authentication");if(!s)throw new t.ArgumentNullError("connectionFactory");if(!c)throw new t.ArgumentNullError("audioSource");if(!p)throw new t.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=p.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=s,this.privAudioSource=c,this.privRecognizerConfig=p,this.privIsDisposed=!1,this.privRecognizer=h,this.privRequestSession=new u.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new t.EventSource,this.privServiceEvents=new t.EventSource,this.privDynamicGrammar=new u.DynamicGrammarBuilder,this.privSpeechContext=new u.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new u.AgentConfig,this.privRecognizerConfig.parameters.getProperty(i.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=t.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(l=>{if(l.name==="ConnectionClosedEvent"){const f=l;(f.statusCode===1003||f.statusCode===1007||f.statusCode===1002||f.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(i.CancellationReason.Error,f.statusCode===1007?i.CancellationErrorCode.BadRequestParameters:i.CancellationErrorCode.ConnectionFailure,`${f.reason} websocket error code: ${f.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=t.createNoDashGuid()),this.setLanguageIdJson(),this.setOutputDetailLevelJson()}setTranslationJson(){const e=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(e!==void 0){const s=e.split(","),c=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),p=c!==void 0?"Synthesize":"None";if(this.privSpeechContext.setSection("translation",{onSuccess:{action:p},output:{interimResults:{mode:"Always"}},targetLanguages:s}),c!==void 0){const h={};for(const d of s)h[d]=c;this.privSpeechContext.setSection("synthesis",{defaultVoices:h})}}}setSpeechSegmentationTimeoutJson(){const e=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),s=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),c=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Speech_SegmentationStrategy,void 0),p={segmentation:{mode:""}};let h=!1;if(c!==void 0){h=!0;let d="";switch(c.toLowerCase()){case"default":break;case"time":d="Custom";break;case"semantic":d="Semantic";break}p.segmentation.mode=d}if(e!==void 0){h=!0;const d=parseInt(e,10);p.segmentation.mode="Custom",p.segmentation.segmentationSilenceTimeoutMs=d}if(s!==void 0){h=!0;const d=parseInt(s,10);p.segmentation.mode="Custom",p.segmentation.segmentationForcedTimeoutMs=d}if(h){const d=this.recognitionMode===u.RecognitionMode.Conversation?"CONVERSATION":this.recognitionMode===u.RecognitionMode.Dictation?"DICTATION":"INTERACTIVE",l=this.privSpeechContext.getSection("phraseDetection");l.mode=d,l[d]=p,this.privSpeechContext.setSection("phraseDetection",l)}}setLanguageIdJson(){const e=this.privSpeechContext.getSection("phraseDetection");if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const c=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");let p;this.privRecognizerConfig.languageIdMode==="Continuous"?p="DetectContinuous":p="DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:c,mode:p,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});const h=this.privRecognizerConfig.sourceLanguageModels;h!==void 0&&(e.customModels=h,e.onInterim={action:"None"},e.onSuccess={action:"None"})}this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&(e.onInterim={action:"Translate"},e.onSuccess={action:"Translate"},this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"None"},phraseResults:{resultType:"None"}})),this.privSpeechContext.setSection("phraseDetection",e)}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(u.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple]).toLowerCase()===i.OutputFormat[i.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(i.PropertyId.ConversationTranslator_Token,e)}set voiceProfileType(e){this.privRecognizerConfig.parameters.setProperty(i.PropertyId.SpeechServiceConnection_SpeakerIdMode,e)}set authentication(e){this.privAuthentication=e}isDisposed(){return this.privIsDisposed}async dispose(e){if(this.privIsDisposed=!0,this.privConnectionConfigurationPromise!==void 0)try{await(await this.privConnectionConfigurationPromise).dispose(e)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(e,s,c){if(this.recognizeOverride!==void 0){await this.recognizeOverride(e,s,c);return}this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=e,this.setSpeechSegmentationTimeoutJson(),this.setTranslationJson(),this.privSuccessCallback=s,this.privErrorCallback=c,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const p=this.connectImpl();let h;try{const f=await this.audioSource.attach(this.privRequestSession.audioNodeId),v=await this.audioSource.format,g=await this.audioSource.deviceInfo;this.privIsLiveAudio=g.type&&g.type===u.type.Microphones,h=new r.ReplayableAudioNode(f,v.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(h,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:g}}catch(f){throw await this.privRequestSession.onStopRecognizing(),f}try{await p}catch(f){await this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,f);return}const d=new i.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,d),this.receiveMessage(),this.sendAudio(h).catch(async f=>{await this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,f)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(e,s){this.connectImpl().then(()=>{try{e&&e()}catch(c){s&&s(c)}},c=>{try{s&&s(c)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(e){}async sendNetworkMessage(e,s){const c=typeof s=="string"?t.MessageType.Text:t.MessageType.Binary,p=typeof s=="string"?"application/json":"";return(await this.fetchConnection()).send(new o.SpeechConnectionMessage(c,e,this.privRequestSession.requestId,p,s))}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(e){this.privExpectContentAssessmentResponse=e}async sendTelemetryData(){const e=this.privRequestSession.getTelemetry();if(qi.telemetryDataEnabled!==!0||this.privIsDisposed||e===null)return;if(qi.telemetryData)try{qi.telemetryData(e)}catch{}await(await this.fetchConnection()).send(new o.SpeechConnectionMessage(t.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",e))}async cancelRecognitionLocal(e,s,c){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,s,c))}async receiveMessage(){try{if(this.privIsDisposed)return;let e=await this.fetchConnection();const s=await e.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!s)return this.receiveMessage();this.privServiceHasSentMessage=!0;const c=o.SpeechConnectionMessage.fromConnectionMessage(s);if(c.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(c.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const p=u.SpeechDetected.fromJSON(c.textBody,this.privRequestSession.currentTurnAudioOffset),h=new i.RecognitionEventArgs(p.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,h);break;case"speech.enddetected":let d;c.textBody.length>0?d=c.textBody:d="{ Offset: 0 }";const l=u.SpeechDetected.fromJSON(d,this.privRequestSession.currentTurnAudioOffset),f=new i.RecognitionEventArgs(l.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,f);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(i.CancellationReason.EndOfStream,i.CancellationErrorCode.NoError,void 0));const v=new i.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,v);return}else e=await this.fetchConnection(),await this.sendPrePayloadJSON(e);break;default:await this.processTypeSpecificMessages(c)||this.privServiceEvents&&this.serviceEvents.onEvent(new t.ServiceEvent(c.path.toLowerCase(),c.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const e=this.privRequestSession.recognitionBytesSent,s=this.privAverageBytesPerMs!==0?e/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(s)}sendSpeechContext(e,s){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const c=this.speechContext.toJSON();if(s&&this.privRequestSession.onSpeechContext(),c)return e.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",c))}noOp(){}async sendPrePayloadJSON(e,s=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(e);await this.sendSpeechContext(e,s),await this.sendWaveHeader(e)}async sendWaveHeader(e){const s=await this.audioSource.format;return e.send(new o.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",s.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(e=>e.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(e,s,c){if(s.onSpeechContext(),qi.telemetryDataEnabled!==!0){const h={context:{system:JSON.parse(c).context.system}};c=JSON.stringify(h)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const p=JSON.parse(c);p.context.DisableReferenceChannel="True",p.context.MicSpec="1_0_0",c=JSON.stringify(p)}if(c)return e.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speech.config",s.requestId,"application/json",c))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(e=>e.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(e){const s=await this.audioSource.format;this.privAverageBytesPerMs=s.avgBytesPerSec/1e3;let c=Date.now();const p=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),h=s.avgBytesPerSec/1e3*parseInt(p,10),d=this.privRequestSession.recogNumber,l=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===d){const f=await this.fetchConnection(),v=await e.read();if(this.privRequestSession.isSpeechEnded)return;let g,S;if(!v||v.isEnd?(g=null,S=0):(g=v.buffer,this.privRequestSession.onAudioSent(g.byteLength),h>=this.privRequestSession.bytesSent?S=0:S=Math.max(0,c-Date.now())),S!==0&&await this.delay(S),g!==null&&(c=Date.now()+g.byteLength*1e3/(s.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===d)if(f.send(new o.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,g)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),v?.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return l()}};return l()}async retryableConnect(){let e=!1;this.privAuthFetchEventId=t.createNoDashGuid();const s=this.privRequestSession.sessionId;this.privConnectionId=s!==void 0?s:t.createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let c=0,p="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){const d=await(e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const l=this.privConnectionFactory.create(this.privRecognizerConfig,d,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(l.events),l.events.attach(v=>{this.connectionEvents.onEvent(v)});const f=await l.open();if(f.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(f.statusCode),Promise.resolve(l);f.statusCode===1006&&(e=!0),c=f.statusCode,p=f.reason,this.privRequestSession.onRetryConnection()}return await this.privRequestSession.onConnectionEstablishCompleted(c,p),Promise.reject(`Unable to contact server. StatusCode: ${c}, ${this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${p}`)}delay(e){return new Promise(s=>this.privSetTimeout(s,e))}writeBufferToConsole(e){let s="Buffer Size: ";if(e===null)s+="null";else{const c=new Uint8Array(e);s+=`${e.byteLength}\r
`;for(let p=0;p<e.byteLength;p++)s+=c[p].toString(16).padStart(2,"0")+" ",(p+1)%16===0&&(console.info(s),s="")}console.info(s)}async sendFinalAudio(){await(await this.fetchConnection()).send(new o.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const e=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(e):(await this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(e,!1),e)}};return Ur.ServiceRecognizerBase=a,a.telemetryDataEnabled=!0,Ur}var Vr={},su;function Sf(){if(su)return Vr;su=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.ConversationServiceRecognizer=void 0;const r=y(),t=E();let i=class extends t.ServiceRecognizerBase{constructor(o,a,n,e,s){super(o,a,n,e,s),this.handleSpeechPhraseMessage=async c=>this.handleSpeechPhrase(c),this.handleSpeechHypothesisMessage=c=>this.handleSpeechHypothesis(c)}processTypeSpecificMessages(o){}handleRecognizedCallback(o,a,n){}handleRecognizingCallback(o,a,n){}async processSpeechMessages(o){let a=!1;switch(o.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(o.textBody),a=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(o.textBody),a=!0;break}return a}cancelRecognition(o,a,n,e,s){}async handleSpeechPhrase(o){const a=t.SimpleSpeechPhrase.fromJSON(o,this.privRequestSession.currentTurnAudioOffset),n=t.EnumTranslation.implTranslateRecognitionResult(a.RecognitionStatus);let e;const s=new r.PropertyCollection;if(s.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,o),this.privRequestSession.onPhraseRecognized(a.Offset+a.Duration),r.ResultReason.Canceled===n){const c=t.EnumTranslation.implTranslateCancelResult(a.RecognitionStatus),p=t.EnumTranslation.implTranslateCancelErrorCode(a.RecognitionStatus);await this.cancelRecognitionLocal(c,p,t.EnumTranslation.implTranslateErrorDetails(p))}else if(a.RecognitionStatus!==t.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===r.OutputFormat[r.OutputFormat.Simple])e=new r.SpeechRecognitionResult(this.privRequestSession.requestId,n,a.DisplayText,a.Duration,a.Offset,a.Language,a.LanguageDetectionConfidence,a.SpeakerId,void 0,a.asJson(),s);else{const c=t.DetailedSpeechPhrase.fromJSON(o,this.privRequestSession.currentTurnAudioOffset);e=new r.SpeechRecognitionResult(this.privRequestSession.requestId,n,c.Text,c.Duration,c.Offset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,c.asJson(),s)}this.handleRecognizedCallback(e,e.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(o){const a=t.SpeechHypothesis.fromJSON(o,this.privRequestSession.currentTurnAudioOffset),n=new r.PropertyCollection;n.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,o);const e=new r.SpeechRecognitionResult(this.privRequestSession.requestId,r.ResultReason.RecognizingSpeech,a.Text,a.Duration,a.Offset,a.Language,a.LanguageDetectionConfidence,a.SpeakerId,void 0,a.asJson(),n);this.privRequestSession.onHypothesis(a.Offset),this.handleRecognizingCallback(e,a.Duration,this.privRequestSession.sessionId)}};return Vr.ConversationServiceRecognizer=i,Vr}var Hn={},ou;function mf(){return ou||(ou=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.RecognizerConfig=r.SpeechResultFormat=r.RecognitionMode=void 0;const t=y(),i=E();var u;(function(a){a[a.Interactive=0]="Interactive",a[a.Conversation=1]="Conversation",a[a.Dictation=2]="Dictation"})(u=r.RecognitionMode||(r.RecognitionMode={})),function(a){a[a.Simple=0]="Simple",a[a.Detailed=1]="Detailed"}(r.SpeechResultFormat||(r.SpeechResultFormat={}));class o{constructor(n,e){this.privSpeechServiceConfig=n||new i.SpeechServiceConfig(new i.Context(null)),this.privParameters=e,this.privMaxRetryCount=parseInt(e.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=e.getProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(n){this.privRecognitionMode=n,this.privRecognitionActivityTimeout=n===u.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=u[n]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==u.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){const n=[];let e=!1;if(this.autoDetectSourceLanguages!==void 0)for(const s of this.autoDetectSourceLanguages.split(",")){const c=s+t.PropertyId.SpeechServiceConnection_EndpointId.toString(),p=this.parameters.getProperty(c,void 0);p!==void 0?(n.push({language:s,endpoint:p}),e=!0):n.push({language:s,endpoint:""})}return e?n:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(n){this.privEnableSpeakerId=n}}r.RecognizerConfig=o}(Hn)),Hn}var Kn={},au;function Cf(){return au||(au=1,Object.defineProperty(Kn,"__esModule",{value:!0})),Kn}var Hr={},cu;function yf(){if(cu)return Hr;cu=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.WebsocketMessageFormatter=void 0;const r=I(),t=`\r
`;let i=class{toConnectionMessage(o){const a=new r.Deferred;try{if(o.messageType===r.MessageType.Text){const n=o.textContent;let e={},s=null;if(n){const c=n.split(`\r
\r
`);c&&c.length>0&&(e=this.parseHeaders(c[0]),c.length>1&&(s=c[1]))}a.resolve(new r.ConnectionMessage(o.messageType,s,e,o.id))}else if(o.messageType===r.MessageType.Binary){const n=o.binaryContent;let e={},s=null;if(!n||n.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const c=new DataView(n),p=c.getInt16(0);if(n.byteLength<p+2)throw new Error("Invalid binary message format. Header content missing.");let h="";for(let d=0;d<p;d++)h+=String.fromCharCode(c.getInt8(d+2));e=this.parseHeaders(h),n.byteLength>p+2&&(s=n.slice(2+p)),a.resolve(new r.ConnectionMessage(o.messageType,s,e,o.id))}}catch(n){a.reject(`Error formatting the message. Error: ${n}`)}return a.promise}fromConnectionMessage(o){const a=new r.Deferred;try{if(o.messageType===r.MessageType.Text){const n=`${this.makeHeaders(o)}${t}${o.textBody?o.textBody:""}`;a.resolve(new r.RawWebsocketMessage(r.MessageType.Text,n,o.id))}else if(o.messageType===r.MessageType.Binary){const n=this.makeHeaders(o),e=o.binaryBody,s=this.stringToArrayBuffer(n),c=new Int8Array(s),p=c.byteLength,h=new Int8Array(2+p+(e?e.byteLength:0));if(h[0]=p>>8&255,h[1]=p&255,h.set(c,2),e){const l=new Int8Array(e);h.set(l,2+p)}const d=h.buffer;a.resolve(new r.RawWebsocketMessage(r.MessageType.Binary,d,o.id))}}catch(n){a.reject(`Error formatting the message. ${n}`)}return a.promise}makeHeaders(o){let a="";if(o.headers)for(const n in o.headers)n&&(a+=`${n}: ${o.headers[n]}${t}`);return a}parseHeaders(o){const a={};if(o){const n=o.match(/[^\r\n]+/g);if(a){for(const e of n)if(e){const s=e.indexOf(":"),c=s>0?e.substr(0,s).trim().toLowerCase():e,p=s>0&&e.length>s+1?e.substr(s+1).trim():"";a[c]=p}}}return a}stringToArrayBuffer(o){const a=new ArrayBuffer(o.length),n=new DataView(a);for(let e=0;e<o.length;e++)n.setUint8(e,o.charCodeAt(e));return a}};return Hr.WebsocketMessageFormatter=i,Hr}var Kr={},uu;function Rf(){if(uu)return Kr;uu=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.SpeechConnectionFactory=void 0;const r=k(),t=E(),i=y(),u=H(),o=E(),a=N(),n=ee();let e=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(c,p,h){let d=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,void 0);const l=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region,void 0),f=u.ConnectionFactoryBase.getHostSuffix(l),v=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://"+l+".stt.speech"+f),g={},S=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,void 0),m=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(S?(!d||d.search(n.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(g[n.QueryParameterNames.CustomSpeechDeploymentId]=S):m&&(!d||d.search(n.QueryParameterNames.Language)===-1)&&(g[n.QueryParameterNames.Language]=m),(!d||d.search(n.QueryParameterNames.Format)===-1)&&(g[n.QueryParameterNames.Format]=c.parameters.getProperty(t.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple]).toLowerCase()),c.autoDetectSourceLanguages!==void 0&&(g[n.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(c,g,d),!d)switch(c.recognitionMode){case o.RecognitionMode.Conversation:c.parameters.getProperty(t.ForceDictationPropertyName,"false")==="true"?d=v+this.dictationRelativeUri:c.recognitionEndpointVersion!==void 0&&parseInt(c.recognitionEndpointVersion,10)>1?d=`${v}${this.universalUri}${c.recognitionEndpointVersion}`:d=v+this.conversationRelativeUri;break;case o.RecognitionMode.Dictation:d=v+this.dictationRelativeUri;break;default:c.recognitionEndpointVersion!==void 0&&parseInt(c.recognitionEndpointVersion,10)>1?d=`${v}${this.universalUri}${c.recognitionEndpointVersion}`:d=v+this.interactiveRelativeUri;break}const C={};p.token!==void 0&&p.token!==""&&(C[p.headerName]=p.token),C[a.HeaderNames.ConnectionId]=h;const P=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",R=new r.WebsocketConnection(d,g,C,new o.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(c),P,h),w=R.uri;return c.parameters.setProperty(i.PropertyId.SpeechServiceConnection_Url,w),R}};return Kr.SpeechConnectionFactory=e,Kr}var $r={},pu;function Pf(){if(pu)return $r;pu=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.ConversationTranscriberConnectionFactory=void 0;const r=k(),t=y(),i=E(),u=H(),o=E(),a=N(),n=ee();let e=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/speech/universal/v2"}create(c,p,h){let d=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const l=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),f=u.ConnectionFactoryBase.getHostSuffix(l),v=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+l+".stt.speech"+f),g={},S=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),m=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);S?(!d||d.search(n.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(g[n.QueryParameterNames.CustomSpeechDeploymentId]=S):m&&(!d||d.search(n.QueryParameterNames.Language)===-1)&&(g[n.QueryParameterNames.Language]=m),c.autoDetectSourceLanguages!==void 0&&(g[n.QueryParameterNames.EnableLanguageId]="true"),this.setV2UrlParams(c,g,d),d||(d=`${v}${this.universalUri}`);const C={};p.token!==void 0&&p.token!==""&&(C[p.headerName]=p.token),C[a.HeaderNames.ConnectionId]=h;const P=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",R=new r.WebsocketConnection(d,g,C,new o.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(c),P,h),w=R.uri;return c.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,w),R}setV2UrlParams(c,p,h){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,n.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,n.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,n.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,n.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,n.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,n.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,n.QueryParameterNames.StableIntermediateThreshold]]).forEach((f,v)=>{this.setUrlParameter(v,f,c,p,h)});const l=JSON.parse(c.parameters.getProperty(i.ServicePropertiesPropertyName,"{}"));Object.keys(l).forEach(f=>{p[f]=l[f]})}};return $r.ConversationTranscriberConnectionFactory=e,$r}var Jr={},hu;function Ef(){if(hu)return Jr;hu=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.TranscriberConnectionFactory=void 0;const r=k(),t=y(),i=H(),u=E(),o=N(),a=ee();let n=class extends i.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(s,c,p){let h=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const d=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"centralus"),l=i.ConnectionFactoryBase.getHostSuffix(d),f="wss://transcribe."+d+".cts.speech"+l+this.multiaudioRelativeUri,v=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,f),g={};this.setQueryParams(g,s,h),h||(h=v);const S={};c.token!==void 0&&c.token!==""&&(S[c.headerName]=c.token),S[o.HeaderNames.ConnectionId]=p,s.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,h);const m=s.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new r.WebsocketConnection(h,g,S,new u.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(s),m,p)}setQueryParams(s,c,p){const h=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),d=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);h&&!(a.QueryParameterNames.CustomSpeechDeploymentId in s)&&(s[a.QueryParameterNames.CustomSpeechDeploymentId]=h),d&&!(a.QueryParameterNames.Language in s)&&(s[a.QueryParameterNames.Language]=d);const l=c.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",f=c.parameters.getProperty(u.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple])!==t.OutputFormat[t.OutputFormat.Simple];(l||f)&&(s[a.QueryParameterNames.Format]=t.OutputFormat[t.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(c,s,p)}};return Jr.TranscriberConnectionFactory=n,Jr}var Gr={},du;function If(){if(du)return Gr;du=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.TranslationConnectionFactory=void 0;const r=k(),t=Zp(),i=y(),u=H(),o=E(),a=N(),n=ee();let e=class extends u.ConnectionFactoryBase{create(c,p,h){const d=this.getEndpointUrl(c),l={};c.autoDetectSourceLanguages!==void 0&&(l[n.QueryParameterNames.EnableLanguageId]="true"),this.setQueryParams(l,c,d);const f={};p.token!==void 0&&p.token!==""&&(f[p.headerName]=p.token),f[a.HeaderNames.ConnectionId]=h,c.parameters.setProperty(i.PropertyId.SpeechServiceConnection_Url,d);const v=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new r.WebsocketConnection(d,l,f,new o.WebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(c),v,h)}getEndpointUrl(c,p){const h=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region),d=u.ConnectionFactoryBase.getHostSuffix(h);let l=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,void 0);return l||(c.autoDetectSourceLanguages!==void 0?l=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+d)+"/speech/universal/v2":l=c.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+d)+"/speech/translation/cognitiveservices/v1"),p===!0?l:t.StringUtils.formatString(l,{region:h})}setQueryParams(c,p,h){c.from=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),c.to=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages),c.scenario=p.recognitionMode===o.RecognitionMode.Interactive?"interactive":p.recognitionMode===o.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(p,c,h),this.setUrlParameter(i.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,n.QueryParameterNames.StableTranslation,p,c,h);const d=p.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);d!==void 0&&(c.voice=d,c.features="texttospeech")}};return Gr.TranslationConnectionFactory=e,Gr}var Qr={},lu;function Af(){if(lu)return Qr;lu=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.EnumTranslation=void 0;const r=y(),t=E();let i=class{static implTranslateRecognitionResult(o,a=!1){let n=r.ResultReason.Canceled;switch(o){case t.RecognitionStatus.Success:n=r.ResultReason.RecognizedSpeech;break;case t.RecognitionStatus.EndOfDictation:n=a?r.ResultReason.RecognizedSpeech:r.ResultReason.NoMatch;break;case t.RecognitionStatus.NoMatch:case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:n=r.ResultReason.NoMatch;break;case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:n=r.ResultReason.Canceled;break}return n}static implTranslateCancelResult(o){let a=r.CancellationReason.EndOfStream;switch(o){case t.RecognitionStatus.Success:case t.RecognitionStatus.EndOfDictation:case t.RecognitionStatus.NoMatch:a=r.CancellationReason.EndOfStream;break;case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:a=r.CancellationReason.Error;break}return a}static implTranslateCancelErrorCode(o){let a=r.CancellationErrorCode.NoError;switch(o){case t.RecognitionStatus.Error:a=r.CancellationErrorCode.ServiceError;break;case t.RecognitionStatus.TooManyRequests:a=r.CancellationErrorCode.TooManyRequests;break;case t.RecognitionStatus.BadRequest:a=r.CancellationErrorCode.BadRequestParameters;break;case t.RecognitionStatus.Forbidden:a=r.CancellationErrorCode.Forbidden;break;default:a=r.CancellationErrorCode.NoError;break}return a}static implTranslateErrorDetails(o){let a="The speech service encountered an internal error and could not continue.";switch(o){case r.CancellationErrorCode.Forbidden:a="The recognizer is using a free subscription that ran out of quota.";break;case r.CancellationErrorCode.BadRequestParameters:a="Invalid parameter or unsupported audio format in the request.";break;case r.CancellationErrorCode.TooManyRequests:a="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return a}};return Qr.EnumTranslation=i,Qr}var $n={},vu;function Tf(){return vu||(vu=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.RecognitionStatus=r.SynthesisStatus=void 0,function(t){t[t.Success=0]="Success",t[t.SynthesisEnd=1]="SynthesisEnd",t[t.Error=2]="Error"}(r.SynthesisStatus||(r.SynthesisStatus={})),function(t){t[t.Success=0]="Success",t[t.NoMatch=1]="NoMatch",t[t.InitialSilenceTimeout=2]="InitialSilenceTimeout",t[t.BabbleTimeout=3]="BabbleTimeout",t[t.Error=4]="Error",t[t.EndOfDictation=5]="EndOfDictation",t[t.TooManyRequests=6]="TooManyRequests",t[t.BadRequest=7]="BadRequest",t[t.Forbidden=8]="Forbidden"}(r.RecognitionStatus||(r.RecognitionStatus={}))}($n)),$n}var Xr={},fu;function wf(){if(fu)return Xr;fu=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.TranslationSynthesisEnd=void 0;const r=E();let t=class ch{constructor(u){this.privSynthesisEnd=JSON.parse(u),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=r.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=r.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(u){return new ch(u)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return Xr.TranslationSynthesisEnd=t,Xr}var Zr={},gu;function _f(){if(gu)return Zr;gu=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.TranslationHypothesis=void 0;const r=A(),t=hs();let i=class cs{constructor(o,a){this.privTranslationHypothesis=o,this.privTranslationHypothesis.Offset+=a,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(o,a){return new cs(JSON.parse(o),a)}static fromTranslationResponse(o,a){r.Contracts.throwIfNullOrUndefined(o,"translationHypothesis");const n=o.SpeechHypothesis;return o.SpeechHypothesis=void 0,n.Translation=o,new cs(n,a)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){return this.privTranslationHypothesis.PrimaryLanguage?.Language}asJson(){const o={...this.privTranslationHypothesis};return o.Translation!==void 0?JSON.stringify({...o,TranslationStatus:t.TranslationStatus[o.Translation.TranslationStatus]}):JSON.stringify(o)}mapTranslationStatus(o){if(typeof o=="string")return t.TranslationStatus[o];if(typeof o=="number")return o}};return Zr.TranslationHypothesis=i,Zr}var Yr={},Su;function bf(){if(Su)return Yr;Su=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.TranslationPhrase=void 0;const r=A(),t=E(),i=hs();let u=class us{constructor(a,n){this.privTranslationPhrase=a,this.privTranslationPhrase.Offset+=n,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(a,n){return new us(JSON.parse(a),n)}static fromTranslationResponse(a,n){r.Contracts.throwIfNullOrUndefined(a,"translationResponse");const e=a.SpeechPhrase;return a.SpeechPhrase=void 0,e.Translation=a,e.Text=e.DisplayText,new us(e,n)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){return this.privTranslationPhrase.PrimaryLanguage?.Language}get Confidence(){return this.privTranslationPhrase.PrimaryLanguage?.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const a={...this.privTranslationPhrase},n={...a,RecognitionStatus:t.RecognitionStatus[a.RecognitionStatus]};return a.Translation&&(n.Translation={...a.Translation,TranslationStatus:i.TranslationStatus[a.Translation.TranslationStatus]}),JSON.stringify(n)}mapRecognitionStatus(a){if(typeof a=="string")return t.RecognitionStatus[a];if(typeof a=="number")return a}mapTranslationStatus(a){if(typeof a=="string")return i.TranslationStatus[a];if(typeof a=="number")return a}};return Yr.TranslationPhrase=u,Yr}var ei={},mu;function Mf(){if(mu)return ei;mu=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.TranslationServiceRecognizer=void 0;const r=I(),t=y(),i=E();let u=class extends i.ConversationServiceRecognizer{constructor(a,n,e,s,c){super(a,n,e,s,c),this.privTranslationRecognizer=c,this.connectionEvents.attach(p=>{p.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(a){const n=new t.PropertyCollection;let e=await this.processSpeechMessages(a);if(e)return!0;const s=async p=>{if(n.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,p.asJson()),this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),p.RecognitionStatus===i.RecognitionStatus.Success){const h=this.fireEventForResult(p,n);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,h)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(h.result)}catch(d){this.privErrorCallback&&this.privErrorCallback(d)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const h=i.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus),d=new t.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,h,p.Text,p.Duration,p.Offset,p.Language,p.Confidence,void 0,p.asJson(),n);if(h===t.ResultReason.Canceled){const l=i.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),f=i.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(l,f,i.EnumTranslation.implTranslateErrorDetails(f))}else if(p.RecognitionStatus!==i.RecognitionStatus.EndOfDictation){const l=new t.TranslationRecognitionEventArgs(d,d.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,l)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(d)}catch(f){this.privErrorCallback&&this.privErrorCallback(f)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}e=!0}},c=p=>{n.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const h=this.fireEventForResult(p,n);if(this.privRequestSession.onHypothesis(h.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,h)}catch{}e=!0};switch(a.messageType===r.MessageType.Text&&n.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,a.textBody),a.path.toLowerCase()){case"translation.hypothesis":c(i.TranslationHypothesis.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const p=JSON.parse(a.textBody);if(p.SpeechPhrase)await s(i.TranslationPhrase.fromTranslationResponse(p,this.privRequestSession.currentTurnAudioOffset));else{const d=JSON.parse(a.textBody);d.SpeechHypothesis&&c(i.TranslationHypothesis.fromTranslationResponse(d,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await s(i.TranslationPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":this.sendSynthesisAudio(a.binaryBody,this.privRequestSession.sessionId),e=!0;break;case"audio.end":case"translation.synthesis.end":const h=i.TranslationSynthesisEnd.fromJSON(a.textBody);switch(h.SynthesisStatus){case i.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const d=new t.TranslationSynthesisResult(t.ResultReason.Canceled,void 0),l=new t.TranslationSynthesisEventArgs(d,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,l)}catch{}}if(this.privTranslationRecognizer.canceled){const d=new t.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,t.CancellationReason.Error,h.FailureReason,t.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,d)}catch{}}break;case i.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}e=!0;break}return e}cancelRecognition(a,n,e,s,c){const p=new t.PropertyCollection;if(p.setProperty(i.CancellationErrorCodePropertyName,t.CancellationErrorCode[s]),this.privTranslationRecognizer.canceled){const h=new t.TranslationRecognitionCanceledEventArgs(a,e,c,s,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,h)}catch{}}if(this.privSuccessCallback){const h=new t.TranslationRecognitionResult(void 0,n,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,c,void 0,p);try{this.privSuccessCallback(h),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(a,n,e){try{const s=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(a),n,e);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,s)}catch{}}handleRecognizedCallback(a,n,e){try{const s=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(a),n,e);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,s)}catch{}}fireEventForResult(a,n){let e;if(a.Translation.Translations!==void 0){e=new t.Translations;for(const l of a.Translation.Translations)e.set(l.Language,l.Text||l.DisplayText)}let s,c;a instanceof i.TranslationPhrase?(a.Translation&&a.Translation.TranslationStatus===r.TranslationStatus.Success?s=t.ResultReason.TranslatedSpeech:s=t.ResultReason.RecognizedSpeech,c=a.Confidence):s=t.ResultReason.TranslatingSpeech;const p=a.Language,h=new t.TranslationRecognitionResult(e,this.privRequestSession.requestId,s,a.Text,a.Duration,a.Offset,p,c,a.Translation.FailureReason,a.asJson(),n);return new t.TranslationRecognitionEventArgs(h,a.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(a,n){const e=a===void 0?t.ResultReason.SynthesizingAudioCompleted:t.ResultReason.SynthesizingAudio,s=new t.TranslationSynthesisResult(e,a),c=new t.TranslationSynthesisEventArgs(s,n);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,c)}catch{}}};return ei.TranslationServiceRecognizer=u,ei}var ti={},Cu;function Of(){if(Cu)return ti;Cu=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.SpeechDetected=void 0;let r=class uh{constructor(i,u){this.privSpeechStartDetected=JSON.parse(i),this.privSpeechStartDetected.Offset+=u}static fromJSON(i,u){return new uh(i,u)}get Offset(){return this.privSpeechStartDetected.Offset}};return ti.SpeechDetected=r,ti}var ri={},yu;function Df(){if(yu)return ri;yu=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.SpeechHypothesis=void 0;let r=class ph{constructor(i,u){this.privSpeechHypothesis=JSON.parse(i),this.updateOffset(u)}static fromJSON(i,u){return new ph(i,u)}updateOffset(i){this.privSpeechHypothesis.Offset+=i}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};return ri.SpeechHypothesis=r,ri}var ii={},Ru;function kf(){if(Ru)return ii;Ru=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.SpeechKeyword=void 0;let r=class hh{constructor(i,u){this.privSpeechKeyword=JSON.parse(i),this.privSpeechKeyword.Offset+=u}static fromJSON(i,u){return new hh(i,u)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}};return ii.SpeechKeyword=r,ii}var ni={},Pu;function zf(){if(Pu)return ni;Pu=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.SpeechServiceRecognizer=void 0;const r=y(),t=E();let i=class extends t.ServiceRecognizerBase{constructor(o,a,n,e,s){super(o,a,n,e,s),this.privSpeechRecognizer=s}async processTypeSpecificMessages(o){let a;const n=new r.PropertyCollection;let e=!1;switch(o.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const s=t.SpeechHypothesis.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);n.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,s.asJson()),a=new r.SpeechRecognitionResult(this.privRequestSession.requestId,r.ResultReason.RecognizingSpeech,s.Text,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,void 0,void 0,s.asJson(),n),this.privRequestSession.onHypothesis(s.Offset);const c=new r.SpeechRecognitionEventArgs(a,s.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,c)}catch{}e=!0;break;case"speech.phrase":const p=t.SimpleSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);n.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const h=t.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),r.ResultReason.Canceled===h){const d=t.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),l=t.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(d,l,t.EnumTranslation.implTranslateErrorDetails(l))}else{if(p.RecognitionStatus===t.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===r.OutputFormat[r.OutputFormat.Simple])a=new r.SpeechRecognitionResult(this.privRequestSession.requestId,h,p.DisplayText,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,void 0,void 0,p.asJson(),n);else{const l=t.DetailedSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);n.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,l.asJson()),a=new r.SpeechRecognitionResult(this.privRequestSession.requestId,h,l.RecognitionStatus===t.RecognitionStatus.Success?l.NBest[0].Display:"",l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),n)}const d=new r.SpeechRecognitionEventArgs(a,a.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,d)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(a)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}e=!0;break}return e}cancelRecognition(o,a,n,e,s){const c=new r.PropertyCollection;if(c.setProperty(t.CancellationErrorCodePropertyName,r.CancellationErrorCode[e]),this.privSpeechRecognizer.canceled){const p=new r.SpeechRecognitionCanceledEventArgs(n,s,e,void 0,o);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,p)}catch{}}if(this.privSuccessCallback){const p=new r.SpeechRecognitionResult(a,r.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,c);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch{}}}};return ni.SpeechServiceRecognizer=i,ni}var si={},Eu;function Nf(){if(Eu)return si;Eu=1,Object.defineProperty(si,"__esModule",{value:!0}),si.ConversationTranscriptionServiceRecognizer=void 0;const r=y(),t=E();let i=class extends t.ServiceRecognizerBase{constructor(o,a,n,e,s){super(o,a,n,e,s),this.privConversationTranscriber=s,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const o=this.privSpeechContext.getSection("phraseDetection");o.mode="Conversation";const a={};a.mode="Anonymous",a.audioSessionId=this.privDiarizationSessionId,a.audioOffsetMs=0,a.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",o.speakerDiarization=a,this.privSpeechContext.setSection("phraseDetection",o)}}async processTypeSpecificMessages(o){let a;const n=new r.PropertyCollection;n.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,o.textBody);let e=!1;switch(o.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const s=t.SpeechHypothesis.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a=new r.ConversationTranscriptionResult(this.privRequestSession.requestId,r.ResultReason.RecognizingSpeech,s.Text,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,s.SpeakerId,void 0,s.asJson(),n),this.privRequestSession.onHypothesis(s.Offset);const c=new r.ConversationTranscriptionEventArgs(a,s.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,c)}catch{}e=!0;break;case"speech.phrase":const p=t.SimpleSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset),h=t.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),r.ResultReason.Canceled===h){const d=t.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),l=t.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(d,l,t.EnumTranslation.implTranslateErrorDetails(l))}else if(!(this.privRequestSession.isSpeechEnded&&h===r.ResultReason.NoMatch&&p.RecognitionStatus!==t.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===r.OutputFormat[r.OutputFormat.Simple])a=new r.ConversationTranscriptionResult(this.privRequestSession.requestId,h,p.DisplayText,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,p.SpeakerId,void 0,p.asJson(),n);else{const l=t.DetailedSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a=new r.ConversationTranscriptionResult(this.privRequestSession.requestId,h,l.RecognitionStatus===t.RecognitionStatus.Success?l.NBest[0].Display:void 0,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,p.SpeakerId,void 0,l.asJson(),n)}const d=new r.ConversationTranscriptionEventArgs(a,a.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,d)}catch{}}e=!0;break}return e}cancelRecognition(o,a,n,e,s){if(new r.PropertyCollection().setProperty(t.CancellationErrorCodePropertyName,r.CancellationErrorCode[e]),this.privConversationTranscriber.canceled){const p=new r.ConversationTranscriptionCanceledEventArgs(n,s,e,void 0,o);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,p)}catch{}}}};return si.ConversationTranscriptionServiceRecognizer=i,si}var oi={},Iu;function jf(){if(Iu)return oi;Iu=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.TranscriptionServiceRecognizer=void 0;const r=I(),t=y(),i=E(),u=De();let o=class extends i.ConversationServiceRecognizer{constructor(n,e,s,c,p){super(n,e,s,c,p),this.privTranscriberRecognizer=p,this.sendPrePayloadJSONOverride=h=>this.sendTranscriptionStartJSON(h),this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(n,e){if(this.privRequestSession.isRecognizing){const s=await this.fetchConnection();await this.sendSpeechEvent(s,this.createSpeechEventPayload(n,e))}}async sendMeetingSpeechEventAsync(n,e){if(this.privRequestSession.isRecognizing){const s=await this.fetchConnection();await this.sendSpeechEvent(s,this.createMeetingSpeechEventPayload(n,e))}}processTypeSpecificMessages(n){return this.processSpeechMessages(n)}handleRecognizedCallback(n,e,s){try{const c=new t.SpeechRecognitionEventArgs(n,e,s);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,c),this.privSuccessCallback){try{this.privSuccessCallback(n)}catch(p){this.privErrorCallback&&this.privErrorCallback(p)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(n,e,s){try{const c=new t.SpeechRecognitionEventArgs(n,e,s);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,c)}catch{}}cancelRecognition(n,e,s,c,p){const h=new t.PropertyCollection;if(h.setProperty(i.CancellationErrorCodePropertyName,t.CancellationErrorCode[c]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const d=new t.MeetingTranscriptionCanceledEventArgs(s,p,c,void 0,n);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,d)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const d=new t.ConversationTranscriptionCanceledEventArgs(s,p,c,void 0,n);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,d)}catch{}}if(this.privSuccessCallback){const d=new t.SpeechRecognitionResult(e,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,p,void 0,h);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(n){if(await this.sendSpeechContext(n,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const e=this.privTranscriberRecognizer.getMeetingInfo(),s=this.createMeetingSpeechEventPayload(e,"start");await this.sendSpeechEvent(n,s)}else{const e=this.privTranscriberRecognizer.getConversationInfo(),s=this.createSpeechEventPayload(e,"start");await this.sendSpeechEvent(n,s)}await this.sendWaveHeader(n)}sendSpeechEvent(n,e){const s=JSON.stringify(e);if(s)return n.send(new u.SpeechConnectionMessage(r.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",s))}createSpeechEventPayload(n,e){const s={id:"meeting",name:e,meeting:n.conversationProperties};return s.meeting.id=n.id,s.meeting.attendees=n.participants,s}createMeetingSpeechEventPayload(n,e){const s={id:"meeting",name:e,meeting:n.meetingProperties};return s.meeting.id=n.id,s.meeting.attendees=n.participants,s}};return oi.TranscriptionServiceRecognizer=o,oi}var ai={},Au;function Lf(){if(Au)return ai;Au=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.DetailedSpeechPhrase=void 0;const r=E();let t=class dh{constructor(u,o){this.privDetailedSpeechPhrase=JSON.parse(u),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(o)}static fromJSON(u,o){return new dh(u,o)}updateOffsets(u){if(this.privDetailedSpeechPhrase.Offset+=u,this.privDetailedSpeechPhrase.NBest)for(const o of this.privDetailedSpeechPhrase.NBest){if(o.Words)for(const a of o.Words)a.Offset+=u;if(o.DisplayWords)for(const a of o.DisplayWords)a.Offset+=u}}asJson(){const u={...this.privDetailedSpeechPhrase};return JSON.stringify({...u,RecognitionStatus:r.RecognitionStatus[u.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(u){if(typeof u=="string")return r.RecognitionStatus[u];if(typeof u=="number")return u}};return ai.DetailedSpeechPhrase=t,ai}var ci={},Tu;function qf(){if(Tu)return ci;Tu=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.SimpleSpeechPhrase=void 0;const r=E();let t=class lh{constructor(u,o=0){this.privSimpleSpeechPhrase=JSON.parse(u),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(o)}static fromJSON(u,o){return new lh(u,o)}updateOffset(u){this.privSimpleSpeechPhrase.Offset+=u}asJson(){const u={...this.privSimpleSpeechPhrase};return JSON.stringify({...u,RecognitionStatus:r.RecognitionStatus[u.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(u){if(typeof u=="string")return r.RecognitionStatus[u];if(typeof u=="number")return u}};return ci.SimpleSpeechPhrase=t,ci}var ui={},wu;function Bf(){if(wu)return ui;wu=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.AddedLmIntent=void 0;let r=class{constructor(i,u){this.modelImpl=i,this.intentName=u}};return ui.AddedLmIntent=r,ui}var pi={},_u;function xf(){if(_u)return pi;_u=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.IntentServiceRecognizer=void 0;const r=I(),t=y(),i=E();let u=class extends i.ServiceRecognizerBase{constructor(a,n,e,s,c){super(a,n,e,s,c),this.privIntentRecognizer=c,this.privIntentDataSent=!1}setIntents(a,n){this.privAddedLmIntents=a,this.privUmbrellaIntent=n,this.privIntentDataSent=!0}processTypeSpecificMessages(a){let n,e,s=!1;const c=new t.PropertyCollection;switch(a.messageType===r.MessageType.Text&&c.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,a.textBody),a.path.toLowerCase()){case"speech.hypothesis":const h=i.SpeechHypothesis.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);if(n=new t.IntentRecognitionResult(void 0,this.privRequestSession.requestId,t.ResultReason.RecognizingIntent,h.Text,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,h.asJson(),c),this.privRequestSession.onHypothesis(n.offset),e=new t.IntentRecognitionEventArgs(n,h.Offset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,e)}catch{}s=!0;break;case"speech.phrase":const d=i.SimpleSpeechPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);n=new t.IntentRecognitionResult(void 0,this.privRequestSession.requestId,i.EnumTranslation.implTranslateRecognitionResult(d.RecognitionStatus),d.DisplayText,d.Duration,d.Offset,d.Language,d.LanguageDetectionConfidence,void 0,d.asJson(),c),e=new t.IntentRecognitionEventArgs(n,n.offset,this.privRequestSession.sessionId);const l=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,e)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(n)}catch(v){this.privErrorCallback&&this.privErrorCallback(v)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};this.privIntentDataSent===!1||t.ResultReason.NoMatch===e.result.reason?(this.privRequestSession.onPhraseRecognized(e.offset+e.result.duration),l()):this.privPendingIntentArgs=e,s=!0;break;case"response":if(e=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,e===void 0){if(a.textBody==="")return;e=new t.IntentRecognitionEventArgs(new t.IntentRecognitionResult,0,this.privRequestSession.sessionId)}const f=i.IntentResponse.fromJSON(a.textBody);if(f!==null&&f.topScoringIntent&&f.topScoringIntent.intent){let v=this.privAddedLmIntents[f.topScoringIntent.intent];if(this.privUmbrellaIntent!==void 0&&(v=this.privUmbrellaIntent),v){const g=v===void 0||v.intentName===void 0?f.topScoringIntent.intent:v.intentName;let S=e.result.reason;g!==void 0&&(S=t.ResultReason.RecognizedIntent);const m=e.result.properties!==void 0?e.result.properties:new t.PropertyCollection;m.setProperty(t.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,a.textBody),e=new t.IntentRecognitionEventArgs(new t.IntentRecognitionResult(g,e.result.resultId,S,e.result.text,e.result.duration,e.result.offset,void 0,void 0,e.result.errorDetails,e.result.json,m),e.offset,e.sessionId)}}if(this.privRequestSession.onPhraseRecognized(e.offset+e.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,e)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(e.result)}catch(v){this.privErrorCallback&&this.privErrorCallback(v)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}s=!0;break}const p=new r.Deferred;return p.resolve(s),p.promise}cancelRecognition(a,n,e,s,c){const p=new t.PropertyCollection;if(p.setProperty(i.CancellationErrorCodePropertyName,t.CancellationErrorCode[s]),this.privIntentRecognizer.canceled){const h=new t.IntentRecognitionCanceledEventArgs(e,c,s,void 0,void 0,a);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,h)}catch{}}if(this.privSuccessCallback){const h=new t.IntentRecognitionResult(void 0,n,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,c,void 0,p);try{this.privSuccessCallback(h),this.privSuccessCallback=void 0}catch{}}}};return pi.IntentServiceRecognizer=u,pi}var hi={},bu;function Ff(){if(bu)return hi;bu=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.IntentResponse=void 0;let r=class vh{constructor(i){i===""?this.privIntentResponse={}:this.privIntentResponse=JSON.parse(i)}static fromJSON(i){return new vh(i)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}};return hi.IntentResponse=r,hi}var Jn={},Mu;function Uf(){return Mu||(Mu=1,Object.defineProperty(Jn,"__esModule",{value:!0})),Jn}var di={},li={},Ou;function Wf(){if(Ou)return li;Ou=1,Object.defineProperty(li,"__esModule",{value:!0}),li.ServiceTelemetryListener=void 0;const r=I(),t=Ss();class i{constructor(o,a,n){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=o,this.privAudioSourceId=a,this.privAudioNodeId=n,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(o){o>0&&this.privPhraseLatencies.push(Date.now()-o)}hypothesisReceived(o){o>0&&this.privHypothesisLatencies.push(Date.now()-o)}onEvent(o){this.privIsDisposed||(o instanceof t.RecognitionTriggeredEvent&&o.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:o.eventTime,Name:"ListeningTrigger",Start:o.eventTime}),o instanceof r.AudioStreamNodeAttachingEvent&&o.audioSourceId===this.privAudioSourceId&&o.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=o.eventTime),o instanceof r.AudioStreamNodeAttachedEvent&&o.audioSourceId===this.privAudioSourceId&&o.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=o.eventTime),o instanceof r.AudioSourceErrorEvent&&o.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:o.eventTime,Error:o.error,Name:"Microphone",Start:this.privMicStartTime})),o instanceof r.AudioStreamNodeErrorEvent&&o.audioSourceId===this.privAudioSourceId&&o.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:o.eventTime,Error:o.error,Name:"Microphone",Start:this.privMicStartTime})),o instanceof r.AudioStreamNodeDetachedEvent&&o.audioSourceId===this.privAudioSourceId&&o.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:o.eventTime,Name:"Microphone",Start:this.privMicStartTime})),o instanceof t.ConnectingToServiceEvent&&o.requestId===this.privRequestId&&(this.privConnectionId=o.sessionId),o instanceof r.ConnectionStartEvent&&o.connectionId===this.privConnectionId&&(this.privConnectionStartTime=o.eventTime),o instanceof r.ConnectionEstablishedEvent&&o.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:o.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),o instanceof r.ConnectionEstablishErrorEvent&&o.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:o.eventTime,Error:this.getConnectionError(o.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),o instanceof r.ConnectionMessageReceivedEvent&&o.connectionId===this.privConnectionId&&o.message&&o.message.headers&&o.message.headers.path&&(this.privReceivedMessages[o.message.headers.path]||(this.privReceivedMessages[o.message.headers.path]=new Array),this.privReceivedMessages[o.message.headers.path].length<50&&this.privReceivedMessages[o.message.headers.path].push(o.networkReceivedTime)))}getTelemetry(){const o=new Array;this.privListeningTriggerMetric&&o.push(this.privListeningTriggerMetric),this.privMicMetric&&o.push(this.privMicMetric),this.privConnectionEstablishMetric&&o.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&o.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&o.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const a={Metrics:o,ReceivedMessages:this.privReceivedMessages},n=JSON.stringify(a);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],n}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(o){switch(o){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+o.toString()}}}return li.ServiceTelemetryListener=i,li}var Du;function Vf(){if(Du)return di;Du=1,Object.defineProperty(di,"__esModule",{value:!0}),di.RequestSession=void 0;const r=I(),t=Ss(),i=Wf();let u=class{constructor(a){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=a,this.privRequestId=r.createNoDashGuid(),this.privAudioNodeId=r.createNoDashGuid(),this.privTurnDeferral=new r.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(a){this.privServiceTelemetryListener&&this.privDetachables.push(a.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new i.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new t.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(a,n){this.privAudioNode=a,this.privIsAudioNodeDetached=!1,n?await this.onComplete():this.onEvent(new t.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(a,n){this.privAuthFetchEventId=a,this.privSessionId=n,this.onEvent(new t.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(a){a&&await this.onComplete()}async onConnectionEstablishCompleted(a,n){if(a===200){this.onEvent(new t.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else a===403&&await this.onComplete()}async onServiceTurnEndResponse(a){this.privTurnDeferral.resolve(),!a||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=r.createNoDashGuid()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new r.Deferred}onHypothesis(a){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(a)))}onPhraseRecognized(a){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(a)),this.onServiceRecognized(a)}onServiceRecognized(a){this.privLastRecoOffset=a,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(a),this.privConnectionAttempts=0}onAudioSent(a){this.privBytesSent+=a,this.privRecognitionBytesSent+=a}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const a of this.privDetachables)await a.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(a){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(a),r.Events.instance.onEvent(a)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};return di.RequestSession=u,di}var vi={},ku;function Hf(){if(ku)return vi;ku=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.SpeechContext=void 0;let r=class{constructor(i){this.privContext={},this.privDynamicGrammar=i}getSection(i){return this.privContext[i]||{}}setSection(i,u){this.privContext[i]=u}setPronunciationAssessmentParams(i,u,o=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(i),o&&(this.privContext.phraseDetection.mode="Conversation"),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),this.privContext.phraseOutput.detailed.options.indexOf("SNR")===-1&&this.privContext.phraseOutput.detailed.options.push("SNR"),u&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:u},this.privContext.phraseOutput.detailed.options.push("ContentAssessment"))}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed"}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")===-1&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}setSpeakerDiarizationAudioOffsetMs(i){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=i}toJSON(){const i=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",i),JSON.stringify(this.privContext)}};return vi.SpeechContext=r,vi}var fi={},zu;function Kf(){if(zu)return fi;zu=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.DynamicGrammarBuilder=void 0;let r=class{addPhrase(i){this.privPhrases||(this.privPhrases=[]),i instanceof Array?this.privPhrases=this.privPhrases.concat(i):this.privPhrases.push(i)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(i){this.privGrammars||(this.privGrammars=[]),i instanceof Array?this.privGrammars=this.privGrammars.concat(i):this.privGrammars.push(i)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const i={};if(i.ReferenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const u=[];this.privPhrases.forEach(o=>{u.push({Text:o})}),i.Groups=[{Type:"Generic",Items:u}]}return i}};return fi.DynamicGrammarBuilder=r,fi}var Gn={},Nu;function $f(){return Nu||(Nu=1,Object.defineProperty(Gn,"__esModule",{value:!0})),Gn}var gi={},Si={},mi={},Qn={},ju;function fh(){return ju||(ju=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.MessageDataStreamType=r.ActivityPayloadResponse=void 0;class t{constructor(u){this.privActivityResponse=JSON.parse(u)}static fromJSON(u){return new t(u)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}r.ActivityPayloadResponse=t,function(i){i[i.None=0]="None",i[i.TextToSpeechAudio=1]="TextToSpeechAudio"}(r.MessageDataStreamType||(r.MessageDataStreamType={}))}(Qn)),Qn}var Lu;function Jf(){if(Lu)return mi;Lu=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.DialogServiceTurnState=void 0;const r=Fi(),t=Oe(),i=fh();let u=class{constructor(a,n){this.privRequestId=n,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=a,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(a,n){return a.messageDataStreamType===i.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=t.AudioOutputStream.createPullStream(),this.privAudioStream.format=n!==void 0?n:r.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};return mi.DialogServiceTurnState=u,mi}var qu;function Gf(){if(qu)return Si;qu=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.DialogServiceTurnStateManager=void 0;const r=K(),t=Jf();let i=class{constructor(){this.privTurnMap=new Map}StartTurn(o){if(this.privTurnMap.has(o))throw new r.InvalidOperationError("Service error: There is already a turn with id:"+o);const a=new t.DialogServiceTurnState(this,o);return this.privTurnMap.set(o,a),this.privTurnMap.get(o)}GetTurn(o){return this.privTurnMap.get(o)}CompleteTurn(o){if(!this.privTurnMap.has(o))throw new r.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+o);const a=this.privTurnMap.get(o);return a.complete(),this.privTurnMap.delete(o),a}};return Si.DialogServiceTurnStateManager=i,Si}var Bu;function Qf(){if(Bu)return gi;Bu=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.DialogServiceAdapter=void 0;const r=k(),t=Pp(),i=I(),u=Fi(),o=y(),a=Gf(),n=E(),e=fh(),s=De();let c=class extends n.ServiceRecognizerBase{constructor(h,d,l,f,v){super(h,d,l,f,v),this.privEvents=new i.EventSource,this.privDialogServiceConnector=v,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new a.DialogServiceTurnStateManager,this.recognizeOverride=(g,S,m)=>this.listenOnce(g,S,m),this.postConnectImplOverride=g=>this.dialogConnectImpl(g),this.configConnectionOverride=g=>this.configConnection(g),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=l,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(g=>{g.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(h){const d=i.createGuid(),l=i.createNoDashGuid(),f={context:{interactionId:d},messagePayload:JSON.parse(h),version:.5},v=JSON.stringify(f);await(await this.fetchConnection()).send(new s.SpeechConnectionMessage(i.MessageType.Text,"agent",l,"application/json",v))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,o.CancellationReason.Error,o.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(h){const d=new o.PropertyCollection;h.messageType===i.MessageType.Text&&d.setProperty(o.PropertyId.SpeechServiceResponse_JsonResult,h.textBody);let l,f;switch(h.path.toLowerCase()){case"speech.phrase":const g=n.SimpleSpeechPhrase.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(g.Offset+g.Duration),g.RecognitionStatus!==n.RecognitionStatus.TooManyRequests&&g.RecognitionStatus!==n.RecognitionStatus.Error){const R=this.fireEventForResult(g,d);if(this.privLastResult=R.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,R)}catch{}}f=!0;break;case"speech.hypothesis":const S=n.SpeechHypothesis.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);l=new o.SpeechRecognitionResult(this.privRequestSession.requestId,o.ResultReason.RecognizingSpeech,S.Text,S.Duration,S.Offset,S.Language,S.LanguageDetectionConfidence,void 0,void 0,S.asJson(),d),this.privRequestSession.onHypothesis(S.Offset);const m=new o.SpeechRecognitionEventArgs(l,S.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,m)}catch{}f=!0;break;case"speech.keyword":const C=n.SpeechKeyword.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);l=new o.SpeechRecognitionResult(this.privRequestSession.requestId,C.Status==="Accepted"?o.ResultReason.RecognizedKeyword:o.ResultReason.NoMatch,C.Text,C.Duration,C.Offset,void 0,void 0,void 0,void 0,C.asJson(),d),C.Status!=="Accepted"&&(this.privLastResult=l);const P=new o.SpeechRecognitionEventArgs(l,l.duration,l.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,P)}catch{}f=!0;break;case"audio":{const R=h.requestId.toUpperCase(),w=this.privTurnStateManager.GetTurn(R);try{h.binaryBody?w.audioStream.write(h.binaryBody):w.endAudioStream()}catch{}}f=!0;break;case"response":this.handleResponseMessage(h),f=!0;break}const v=new i.Deferred;return v.resolve(f),v.promise}async cancelRecognition(h,d,l,f,v){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const g=new o.PropertyCollection;g.setProperty(n.CancellationErrorCodePropertyName,o.CancellationErrorCode[f]);const S=new o.SpeechRecognitionCanceledEventArgs(l,v,f,void 0,h);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,S)}catch{}if(this.privSuccessCallback){const m=new o.SpeechRecognitionResult(void 0,o.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,v,void 0,g);try{this.privSuccessCallback(m),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(h,d,l){this.privRecognizerConfig.recognitionMode=h,this.privSuccessCallback=d,this.privErrorCallback=l,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(o.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const f=this.connectImpl(),v=this.sendPreAudioMessages(),g=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),S=await this.privDialogAudioSource.format,m=await this.privDialogAudioSource.deviceInfo,C=new r.ReplayableAudioNode(g,S.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(C,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:m};try{await f,await v}catch(w){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,o.CancellationReason.Error,o.CancellationErrorCode.ConnectionFailure,w),Promise.resolve()}const P=new o.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,P),this.sendAudio(C).then(()=>{},async w=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,o.CancellationReason.Error,o.CancellationErrorCode.RuntimeError,w)})}dialogConnectImpl(h){return this.privConnectionLoop=this.startMessageLoop(),h}receiveDialogMessageOverride(){const h=new i.Deferred,d=async()=>{try{const l=this.isDisposed(),f=!this.isDisposed()&&this.terminateMessageLoop;if(l||f){h.resolve(void 0);return}const g=await(await this.fetchConnection()).read();if(!g)return d();const S=s.SpeechConnectionMessage.fromConnectionMessage(g);switch(S.path.toLowerCase()){case"turn.start":{const _=S.requestId.toUpperCase(),L=this.privRequestSession.requestId.toUpperCase();_!==L?this.privTurnStateManager.StartTurn(_):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const C=n.SpeechDetected.fromJSON(S.textBody,this.privRequestSession.currentTurnAudioOffset),P=new o.RecognitionEventArgs(C.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,P);break;case"speech.enddetected":let R;S.textBody.length>0?R=S.textBody:R="{ Offset: 0 }";const w=n.SpeechDetected.fromJSON(R,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(w.Offset);const D=new o.RecognitionEventArgs(w.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,D);break;case"turn.end":{const _=S.requestId.toUpperCase(),L=this.privRequestSession.requestId.toUpperCase();if(_!==L)this.privTurnStateManager.CompleteTurn(_);else{const be=new o.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,be),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(Wi){this.privErrorCallback&&this.privErrorCallback(Wi)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(S)||this.serviceEvents&&this.serviceEvents.onEvent(new i.ServiceEvent(S.path.toLowerCase(),S.textBody))}catch{}}return d()}catch{this.terminateMessageLoop=!0,h.resolve()}};return d().catch(l=>{i.Events.instance.onEvent(new i.BackgroundEvent(l))}),h.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(h){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,o.CancellationReason.Error,o.CancellationErrorCode.RuntimeError,h)}return Promise.resolve()}async configConnection(h){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(h,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(h),h)}async sendPreAudioMessages(){const h=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(h,!0),await this.sendAgentContext(h),await this.sendWaveHeader(h)}sendAgentConfig(h){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(o.PropertyId.Conversation_DialogType)===o.DialogServiceConfig.DialogTypes.CustomCommands){const l=this.agentConfig.get();l.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(l)}this.onEvent(new t.SendingAgentContextMessageEvent(this.agentConfig));const d=this.agentConfig.toJsonString();return this.agentConfigSent=!0,h.send(new s.SpeechConnectionMessage(i.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",d))}}sendAgentContext(h){const d=i.createGuid(),l=this.privDialogServiceConnector.properties.getProperty(o.PropertyId.Conversation_Speech_Activity_Template),v=JSON.stringify({channelData:"",context:{interactionId:d},messagePayload:typeof l===void 0?void 0:l,version:.5});return h.send(new s.SpeechConnectionMessage(i.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",v))}fireEventForResult(h,d){const l=n.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),f=new o.SpeechRecognitionResult(this.privRequestSession.requestId,l,h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,void 0,h.asJson(),d);return new o.SpeechRecognitionEventArgs(f,h.Offset,this.privRequestSession.sessionId)}handleResponseMessage(h){const d=JSON.parse(h.textBody);switch(d.messageType.toLowerCase()){case"message":const l=h.requestId.toUpperCase(),f=e.ActivityPayloadResponse.fromJSON(h.textBody),v=this.privTurnStateManager.GetTurn(l);if(f.conversationId){const m=this.agentConfig.get();m.botInfo.conversationId=f.conversationId,this.agentConfig.set(m)}const g=v.processActivityPayload(f,u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),S=new o.ActivityReceivedEventArgs(f.messagePayload,g);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,S)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new o.TurnStatusReceivedEventArgs(h.textBody))}catch{}break;default:i.Events.instance.onEvent(new i.BackgroundEvent(`Unexpected response of type ${d.messageType}. Ignoring.`));break}}onEvent(h){this.privEvents.onEvent(h),i.Events.instance.onEvent(h)}addKeywordContextData(){const h=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(h===void 0)return;const d=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),l=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),f=h.split(";"),v=d===void 0?[]:d.split(";"),g=l===void 0?[]:l.split(";"),S=[];for(let m=0;m<f.length;m++){const C={};C.text=f[m],m<v.length&&(C.offset=Number(v[m])),m<g.length&&(C.duration=Number(g[m])),S.push(C)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:S,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}};return gi.DialogServiceAdapter=c,gi}var Ci={},xu;function Xf(){if(xu)return Ci;xu=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.AgentConfig=void 0;let r=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(i){this.iPrivConfig=i}};return Ci.AgentConfig=r,Ci}var Xn={},yi={},Ri={},Fu;function ms(){if(Fu)return Ri;Fu=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.ConversationConnectionConfig=void 0;const r=ah();let t=class Y extends r.RestConfigBase{static get host(){return Y.privHost}static get apiVersion(){return Y.privApiVersion}static get clientAppId(){return Y.privClientAppId}static get defaultLanguageCode(){return Y.privDefaultLanguageCode}static get restPath(){return Y.privRestPath}static get webSocketPath(){return Y.privWebSocketPath}static get transcriptionEventKeys(){return Y.privTranscriptionEventKeys}};return Ri.ConversationConnectionConfig=t,t.privHost="dev.microsofttranslator.com",t.privRestPath="/capito/room",t.privApiVersion="2.0",t.privDefaultLanguageCode="en-US",t.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",t.privWebSocketPath="/capito/translate",t.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],Ri}var Uu;function Zf(){if(Uu)return yi;Uu=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.ConversationManager=void 0;const r=k(),t=A(),i=y(),u=ms();let o=class{constructor(){this.privRequestParams=u.ConversationConnectionConfig.configParams,this.privErrors=u.ConversationConnectionConfig.restErrors,this.privHost=u.ConversationConnectionConfig.host,this.privApiVersion=u.ConversationConnectionConfig.apiVersion,this.privRestPath=u.ConversationConnectionConfig.restPath,this.privRestAdapter=new r.RestMessageAdapter({})}createOrJoin(n,e,s,c){try{t.Contracts.throwIfNullOrUndefined(n,"args");const p=n.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,u.ConversationConnectionConfig.defaultLanguageCode),h=n.getProperty(i.PropertyId.ConversationTranslator_Name,"conversation_host"),d=n.getProperty(i.PropertyId.ConversationTranslator_Host,this.privHost),l=n.getProperty(i.PropertyId.ConversationTranslator_CorrelationId),f=n.getProperty(i.PropertyId.SpeechServiceConnection_Key),v=n.getProperty(i.PropertyId.SpeechServiceConnection_Region),g=n.getProperty(i.PropertyId.SpeechServiceAuthorization_Token);t.Contracts.throwIfNullOrWhitespace(p,"languageCode"),t.Contracts.throwIfNullOrWhitespace(h,"nickname"),t.Contracts.throwIfNullOrWhitespace(d,"endpointHost");const S={};S[this.privRequestParams.apiVersion]=this.privApiVersion,S[this.privRequestParams.languageCode]=p,S[this.privRequestParams.nickname]=h;const m={};l&&(m[this.privRequestParams.correlationId]=l),m[this.privRequestParams.clientAppId]=u.ConversationConnectionConfig.clientAppId,e!==void 0?S[this.privRequestParams.roomId]=e:(t.Contracts.throwIfNullOrUndefined(v,this.privErrors.authInvalidSubscriptionRegion),m[this.privRequestParams.subscriptionRegion]=v,f?m[this.privRequestParams.subscriptionKey]=f:g?m[this.privRequestParams.authorization]=`Bearer ${g}`:t.Contracts.throwIfNullOrUndefined(f,this.privErrors.authInvalidSubscriptionKey));const C={};C.headers=m,this.privRestAdapter.options=C;const P=`https://${d}${this.privRestPath}`;this.privRestAdapter.request(r.RestRequestType.Post,P,S,null).then(R=>{const w=r.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,R.headers);if(!R.ok){if(c){let _=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",R.status.toString()),L;try{L=JSON.parse(R.data),_+=` [${L.error.code}: ${L.error.message}]`}catch{_+=` [${R.data}]`}w&&(_+=` ${w}`),c(_)}return}const D=JSON.parse(R.data);if(D&&(D.requestId=w),s){try{s(D)}catch(_){c&&c(_)}s=void 0}}).catch(()=>{})}catch(p){if(c)if(p instanceof Error){const h=p;c(h.name+": "+h.message)}else c(p)}}leave(n,e){return new Promise((s,c)=>{try{t.Contracts.throwIfNullOrUndefined(n,this.privErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","token"));const p=n.getProperty(i.PropertyId.ConversationTranslator_Host,this.privHost),h=n.getProperty(i.PropertyId.ConversationTranslator_CorrelationId),d={};d[this.privRequestParams.apiVersion]=this.privApiVersion,d[this.privRequestParams.sessionToken]=e;const l={};h&&(l[this.privRequestParams.correlationId]=h);const f={};f.headers=l,this.privRestAdapter.options=f;const v=`https://${p}${this.privRestPath}`;this.privRestAdapter.request(r.RestRequestType.Delete,v,d,null).then(g=>{g.ok,s()}).catch(()=>{})}catch(p){if(p instanceof Error){const h=p;c(h.name+": "+h.message)}else c(p)}})}};return yi.ConversationManager=o,yi}var Re={},Pi={},Ei={},Ii={},Wu;function gh(){if(Wu)return Ii;Wu=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.ConversationConnectionMessage=void 0;const r=I();let t=class extends r.ConnectionMessage{constructor(u,o,a,n){super(u,o,a,n);const e=JSON.parse(this.textBody);e.type!==void 0&&(this.privConversationMessageType=e.type)}get conversationMessageType(){return this.privConversationMessageType}};return Ii.ConversationConnectionMessage=t,Ii}var Vu;function Yf(){if(Vu)return Ei;Vu=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.ConversationWebsocketMessageFormatter=void 0;const r=I(),t=gh();let i=class{toConnectionMessage(o){const a=new r.Deferred;try{if(o.messageType===r.MessageType.Text){const n=new t.ConversationConnectionMessage(o.messageType,o.textContent,{},o.id);a.resolve(n)}else o.messageType===r.MessageType.Binary&&a.resolve(new t.ConversationConnectionMessage(o.messageType,o.binaryContent,void 0,o.id))}catch(n){a.reject(`Error formatting the message. Error: ${n}`)}return a.promise}fromConnectionMessage(o){const a=new r.Deferred;try{if(o.messageType===r.MessageType.Text){const n=`${o.textBody?o.textBody:""}`;a.resolve(new r.RawWebsocketMessage(r.MessageType.Text,n,o.id))}}catch(n){a.reject(`Error formatting the message. ${n}`)}return a.promise}};return Ei.ConversationWebsocketMessageFormatter=i,Ei}var Hu;function eg(){if(Hu)return Pi;Hu=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.ConversationConnectionFactory=void 0;const r=k(),t=I(),i=A(),u=y(),o=H(),a=ms(),n=Yf();let e=class extends o.ConnectionFactoryBase{create(c,p,h){const d=c.parameters.getProperty(u.PropertyId.ConversationTranslator_Host,a.ConversationConnectionConfig.host),l=c.parameters.getProperty(u.PropertyId.ConversationTranslator_CorrelationId,t.createGuid()),f=`wss://${d}${a.ConversationConnectionConfig.webSocketPath}`,v=c.parameters.getProperty(u.PropertyId.ConversationTranslator_Token,void 0);i.Contracts.throwIfNullOrUndefined(v,"token");const g={};g[a.ConversationConnectionConfig.configParams.apiVersion]=a.ConversationConnectionConfig.apiVersion,g[a.ConversationConnectionConfig.configParams.token]=v,g[a.ConversationConnectionConfig.configParams.correlationId]=l;const S=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new r.WebsocketConnection(f,g,{},new n.ConversationWebsocketMessageFormatter,r.ProxyInfo.fromRecognizerConfig(c),S,h)}};return Pi.ConversationConnectionFactory=e,Pi}var Ai={},Ti={},Ku;function tg(){if(Ku)return Ti;Ku=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.ConversationRequestSession=void 0;const r=I();let t=class{constructor(u){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=u,this.privRequestId=r.createNoDashGuid(),this.privRequestCompletionDeferral=new r.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(u,o){this.privSessionId=o}onAuthCompleted(u){u&&this.onComplete()}onConnectionEstablishCompleted(u){u!==200&&u===403&&this.onComplete()}onServiceTurnEndResponse(u){u?this.privRequestId=r.createNoDashGuid():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const u of this.privDetachables)await u.detach()}}onComplete(){}};return Ti.ConversationRequestSession=t,Ti}var z={},$u;function Sh(){if($u)return z;$u=1,Object.defineProperty(z,"__esModule",{value:!0}),z.ConversationReceivedTranslationEventArgs=z.ParticipantsListEventArgs=z.ParticipantAttributeEventArgs=z.ParticipantEventArgs=z.LockRoomEventArgs=z.MuteAllEventArgs=void 0;const r=y();class t extends r.SessionEventArgs{constructor(s,c){super(c),this.privIsMuted=s}get isMuted(){return this.privIsMuted}}z.MuteAllEventArgs=t;class i extends r.SessionEventArgs{constructor(s,c){super(c),this.privIsLocked=s}get isMuted(){return this.privIsLocked}}z.LockRoomEventArgs=i;class u extends r.SessionEventArgs{constructor(s,c){super(c),this.privParticipant=s}get participant(){return this.privParticipant}}z.ParticipantEventArgs=u;class o extends r.SessionEventArgs{constructor(s,c,p,h){super(h),this.privKey=c,this.privValue=p,this.privParticipantId=s}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}z.ParticipantAttributeEventArgs=o;class a extends r.SessionEventArgs{constructor(s,c,p,h,d,l,f,v,g){super(g),this.privRoomId=s,this.privSessionToken=c,this.privTranslateTo=p,this.privProfanityFilter=h,this.privRoomProfanityFilter=d,this.privIsRoomLocked=l,this.privIsRoomLocked=f,this.privParticipants=v}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}z.ParticipantsListEventArgs=a;class n{constructor(s,c,p){this.privPayload=c,this.privCommand=s,this.privSessionId=p}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return z.ConversationReceivedTranslationEventArgs=n,z}var Q={},Ju;function mh(){if(Ju)return Q;Ju=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.ConversationTranslatorCommandTypes=Q.ConversationTranslatorMessageTypes=Q.InternalParticipants=void 0;class r{constructor(i=[],u){this.participants=i,this.meId=u}addOrUpdateParticipant(i){if(i===void 0)return;const u=this.getParticipantIndex(i.id);return u>-1?this.participants.splice(u,1,i):this.participants.push(i),this.getParticipant(i.id)}getParticipantIndex(i){return this.participants.findIndex(u=>u.id===i)}getParticipant(i){return this.participants.find(u=>u.id===i)}deleteParticipant(i){this.participants=this.participants.filter(u=>u.id!==i)}get host(){return this.participants.find(i=>i.isHost===!0)}get me(){return this.getParticipant(this.meId)}}return Q.InternalParticipants=r,Q.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},Q.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},Q}var Zn={},wi={},Gu;function rg(){if(Gu)return wi;Gu=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.CommandResponsePayload=void 0;const r=i=>JSON.parse(i);let t=class Ch{constructor(u){this.privCommandResponse=r(u)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(u){return new Ch(u)}};return wi.CommandResponsePayload=t,wi}var Pe={},Qu;function ig(){if(Qu)return Pe;Qu=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.ParticipantPayloadResponse=Pe.ParticipantsListPayloadResponse=void 0;const r=o=>JSON.parse(o),t=o=>JSON.parse(o);class i{constructor(a){this.privParticipantsPayloadResponse=r(a)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(a){return new i(a)}}Pe.ParticipantsListPayloadResponse=i;class u{constructor(a){this.privParticipantPayloadResponse=t(a)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(a){return new u(a)}}return Pe.ParticipantPayloadResponse=u,Pe}var Ee={},Xu;function ng(){if(Xu)return Ee;Xu=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.TextResponsePayload=Ee.SpeechResponsePayload=void 0;const r=o=>JSON.parse(o),t=o=>JSON.parse(o);class i{constructor(a){this.privSpeechResponse=r(a)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(a){return new i(a)}}Ee.SpeechResponsePayload=i;class u{constructor(a){this.privTextResponse=t(a)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(a){return new u(a)}}return Ee.TextResponsePayload=u,Ee}var Zu;function sg(){return Zu||(Zu=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=rg();Object.defineProperty(r,"CommandResponsePayload",{enumerable:!0,get:function(){return t.CommandResponsePayload}});var i=ig();Object.defineProperty(r,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return i.ParticipantsListPayloadResponse}}),Object.defineProperty(r,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return i.ParticipantPayloadResponse}});var u=ng();Object.defineProperty(r,"SpeechResponsePayload",{enumerable:!0,get:function(){return u.SpeechResponsePayload}}),Object.defineProperty(r,"TextResponsePayload",{enumerable:!0,get:function(){return u.TextResponsePayload}})}(Zn)),Zn}var Yu;function og(){if(Yu)return Ai;Yu=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.ConversationServiceAdapter=void 0;const r=I(),t=y(),i=E(),u=gh(),o=tg(),a=Sh(),n=mh(),e=sg();let s=class extends i.ServiceRecognizerBase{constructor(p,h,d,l,f){super(p,h,d,l,f),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=f,this.privConversationAuthentication=p,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=v=>this.conversationConnectImpl(v),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new o.ConversationRequestSession(r.createNoDashGuid()),this.privConversationConnectionFactory=h,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(p){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(p),await super.dispose(p)}async sendMessage(p){return(await this.fetchConnection()).send(new u.ConversationConnectionMessage(r.MessageType.Text,p))}async sendMessageAsync(p){await(await this.fetchConnection()).send(new u.ConversationConnectionMessage(r.MessageType.Text,p))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,t.CancellationReason.Error,t.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(p,h,d,l,f){this.terminateMessageLoop=!0;const v=new t.ConversationTranslationCanceledEventArgs(d,f,l,void 0,p);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,v)}catch{}}async conversationConnectImpl(p){return this.privConnectionLoop=this.startMessageLoop(),p}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const p=new r.Deferred;try{const d=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return p.resolve(),Promise.resolve();if(!d)return this.receiveConversationMessageOverride();const l=this.privConversationRequestSession.sessionId,f=d.conversationMessageType.toLowerCase();let v=!1;try{switch(f){case"info":case"participant_command":case"command":const g=e.CommandResponsePayload.fromJSON(d.textBody);switch(g.command.toLowerCase()){case"participantlist":const w=e.ParticipantsListPayloadResponse.fromJSON(d.textBody),D=w.participants.map(q=>({avatar:q.avatar,displayName:q.nickname,id:q.participantId,isHost:q.ishost,isMuted:q.ismuted,isUsingTts:q.usetts,preferredLanguage:q.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new a.ParticipantsListEventArgs(w.roomid,w.token,w.translateTo,w.profanityFilter,w.roomProfanityFilter,w.roomLocked,w.muteAll,D,l));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(g.participantId,n.ConversationTranslatorCommandTypes.setTranslateToLanguages,g.value,l));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(g.participantId,n.ConversationTranslatorCommandTypes.setProfanityFiltering,g.value,l));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(g.participantId,n.ConversationTranslatorCommandTypes.setMute,g.value,l));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new a.MuteAllEventArgs(g.value,l));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new t.ConversationExpirationEventArgs(g.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(g.participantId,n.ConversationTranslatorCommandTypes.setUseTTS,g.value,l));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new a.LockRoomEventArgs(g.value,l));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(g.participantId,n.ConversationTranslatorCommandTypes.changeNickname,g.value,l));break;case"joinsession":const _=e.ParticipantPayloadResponse.fromJSON(d.textBody),L={avatar:_.avatar,displayName:_.nickname,id:_.participantId,isHost:_.ishost,isMuted:_.ismuted,isUsingTts:_.usetts,preferredLanguage:_.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new a.ParticipantEventArgs(L,l));break;case"leavesession":const be={id:g.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new a.ParticipantEventArgs(be,l));break;case"disconnectsession":const Wi={id:g.participantId};break;case"token":const Vi=new i.CognitiveTokenAuthentication(()=>{const q=g.token;return Promise.resolve(q)},()=>{const q=g.token;return Promise.resolve(q)});this.authentication=Vi,this.privConversationServiceConnector.onToken(Vi);break;default:break}break;case"partial":case"final":const S=e.SpeechResponsePayload.fromJSON(d.textBody),m=f==="final"?t.ResultReason.TranslatedParticipantSpeech:t.ResultReason.TranslatingParticipantSpeech,C=new t.ConversationTranslationResult(S.participantId,this.getTranslations(S.translations),S.language,S.id,m,S.recognition,void 0,void 0,d.textBody,void 0);S.isFinal?((C.text!==void 0&&C.text.length>0||S.id===this.privLastPartialUtteranceId)&&(v=!0),v&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(n.ConversationTranslatorMessageTypes.final,C,l))):C.text!==void 0&&(this.privLastPartialUtteranceId=S.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(n.ConversationTranslatorMessageTypes.partial,C,l)));break;case"translated_message":const P=e.TextResponsePayload.fromJSON(d.textBody),R=new t.ConversationTranslationResult(P.participantId,this.getTranslations(P.translations),P.language,void 0,void 0,P.originalText,void 0,void 0,void 0,d.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(n.ConversationTranslatorMessageTypes.instantMessage,R,l));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return p.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const p=this.receiveConversationMessageOverride();try{return await p}catch(h){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",t.CancellationReason.Error,t.CancellationErrorCode.RuntimeError,h),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(p=>p.state()===r.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(p=>p),this.privConnectionConfigPromise)}getTranslations(p){let h;if(p!==void 0){h=new t.Translations;for(const d of p)h.set(d.lang,d.translation)}return h}};return Ai.ConversationServiceAdapter=s,Ai}var ep;function ag(){if(ep)return Re;ep=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.ConversationTranslatorRecognizer=Re.ConversationRecognizerFactory=void 0;const r=E(),t=I(),i=A(),u=y(),o=eg(),a=og();class n{static fromConfig(c,p,h){return new e(c,p,h)}}Re.ConversationRecognizerFactory=n;let e=class extends u.Recognizer{constructor(c,p,h){const d=p;i.Contracts.throwIfNull(d,"speechConfig");const l=c;i.Contracts.throwIfNull(l,"conversationImpl"),super(h,d.properties,new o.ConversationConnectionFactory),this.privConversation=l,this.privIsDisposed=!1,this.privProperties=d.properties.clone(),this.privConnection=u.Connection.fromRecognizer(this),this.privProperties.getProperty(u.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=t.Timeout.setTimeout,this.privClearTimeout=t.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(c){this.privConnection.connected=c}set disconnected(c){this.privConnection.disconnected=c}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(c,p,h){try{i.Contracts.throwIfDisposed(this.privIsDisposed),i.Contracts.throwIfNullOrWhitespace(c,"token"),this.privReco.conversationTranslatorToken=c,this.resetConversationTimeout(),this.privReco.connectAsync(p,h)}catch(d){if(h)if(d instanceof Error){const l=d;h(l.name+": "+l.message)}else h(d)}}disconnect(c,p){try{i.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{c&&c()},h=>{p&&p(h)})}catch(h){if(p)if(h instanceof Error){const d=h;p(d.name+": "+d.message)}else p(h);this.dispose(!0).catch(d=>{t.Events.instance.onEvent(new t.BackgroundEvent(d))})}}sendRequest(c,p,h){try{i.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(c,p,h)}catch(d){if(h)if(d instanceof Error){const l=d;h(l.name+": "+l.message)}else h(d);this.dispose(!0).catch(l=>{t.Events.instance.onEvent(new t.BackgroundEvent(l))})}}onToken(c){this.privConversation.onToken(c)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(c){this.privIsDisposed||c&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(c))}createRecognizerConfig(c){return new r.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,p,h,d){const l=h;return new a.ConversationServiceAdapter(c,p,l,d,this)}sendMessage(c,p,h){const d=this.privReco;((f,v,g)=>{f!==void 0?f.then(()=>{try{v&&v()}catch(S){g&&g(`'Unhandled error on promise callback: ${S}'`)}},S=>{try{g&&g(S)}catch{}}):g&&g("Null promise")})(d.sendMessageAsync(c),p,h),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return Re.ConversationTranslatorRecognizer=e,Re}var _i={},tp;function cg(){if(tp)return _i;tp=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.TranscriberRecognizer=void 0;const r=I(),t=A(),i=y(),u=E();let o=class extends i.Recognizer{constructor(n,e){const s=n;t.Contracts.throwIfNull(s,"speechTranslationConfig");const c=e;t.Contracts.throwIfNull(c,"audioConfigImpl"),t.Contracts.throwIfNullOrWhitespace(s.speechRecognitionLanguage,i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(e,s.properties,new u.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return t.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){t.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,n)}set conversation(n){t.Contracts.throwIfNullOrUndefined(n,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=n}getConversationInfo(){return t.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(n){t.Contracts.throwIfNullOrUndefined(n,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=n}getMeetingInfo(){return t.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(n,e){r.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(u.RecognitionMode.Conversation),n,e)}stopContinuousRecognitionAsync(n,e){r.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),n,e)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(n,e){const s=this.privReco;t.Contracts.throwIfNullOrUndefined(s,"serviceRecognizer"),await s.sendSpeechEventAsync(n,e)}async pushMeetingEvent(n,e){const s=this.privReco;t.Contracts.throwIfNullOrUndefined(s,"serviceRecognizer"),await s.sendMeetingSpeechEventAsync(n,e)}async enforceAudioGating(){const s=(await this.audioConfig.format).channels;if(s===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(s!==8)throw new Error(`Unsupported audio configuration: Detected ${s}-channel audio`)}connectMeetingCallbacks(n){this.isMeetingRecognizer=!0,this.canceled=(e,s)=>{n.canceled&&n.canceled(n,s)},this.recognizing=(e,s)=>{n.transcribing&&n.transcribing(n,s)},this.recognized=(e,s)=>{n.transcribed&&n.transcribed(n,s)},this.sessionStarted=(e,s)=>{n.sessionStarted&&n.sessionStarted(n,s)},this.sessionStopped=(e,s)=>{n.sessionStopped&&n.sessionStopped(n,s)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(n){this.privDisposedRecognizer||(n&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(n))}createRecognizerConfig(n){return new u.RecognizerConfig(n,this.properties)}createServiceRecognizer(n,e,s,c){const p=s;return new u.TranscriptionServiceRecognizer(n,e,p,c,this)}};return _i.TranscriberRecognizer=o,_i}var rp;function ug(){return rp||(rp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=Zf();Object.defineProperty(r,"ConversationManager",{enumerable:!0,get:function(){return t.ConversationManager}});var i=ms();Object.defineProperty(r,"ConversationConnectionConfig",{enumerable:!0,get:function(){return i.ConversationConnectionConfig}});var u=ag();Object.defineProperty(r,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return u.ConversationRecognizerFactory}});var o=cg();Object.defineProperty(r,"TranscriberRecognizer",{enumerable:!0,get:function(){return o.TranscriberRecognizer}});var a=Sh();Object.defineProperty(r,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return a.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(r,"LockRoomEventArgs",{enumerable:!0,get:function(){return a.LockRoomEventArgs}}),Object.defineProperty(r,"MuteAllEventArgs",{enumerable:!0,get:function(){return a.MuteAllEventArgs}}),Object.defineProperty(r,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return a.ParticipantAttributeEventArgs}}),Object.defineProperty(r,"ParticipantEventArgs",{enumerable:!0,get:function(){return a.ParticipantEventArgs}}),Object.defineProperty(r,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return a.ParticipantsListEventArgs}});var n=mh();Object.defineProperty(r,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return n.ConversationTranslatorCommandTypes}}),Object.defineProperty(r,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return n.ConversationTranslatorMessageTypes}}),Object.defineProperty(r,"InternalParticipants",{enumerable:!0,get:function(){return n.InternalParticipants}})}(Xn)),Xn}var Yn={},ip;function yh(){return ip||(ip=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SynthesisAudioMetadata=r.MetadataType=void 0,function(i){i.WordBoundary="WordBoundary",i.Bookmark="Bookmark",i.Viseme="Viseme",i.SentenceBoundary="SentenceBoundary",i.SessionEnd="SessionEnd",i.AvatarSignal="TalkingAvatarSignal"}(r.MetadataType||(r.MetadataType={}));class t{constructor(u){this.privSynthesisAudioMetadata=JSON.parse(u)}static fromJSON(u){return new t(u)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}r.SynthesisAudioMetadata=t}(Yn)),Yn}var bi={},V={},np;function pg(){if(np)return V;np=1,Object.defineProperty(V,"__esModule",{value:!0}),V.SynthesisStartedEvent=V.ConnectingToSynthesisServiceEvent=V.SynthesisTriggeredEvent=V.SpeechSynthesisEvent=void 0;const r=I();class t extends r.PlatformEvent{constructor(n,e,s=r.EventType.Info){super(n,s),this.privRequestId=e}get requestId(){return this.privRequestId}}V.SpeechSynthesisEvent=t;class i extends t{constructor(n,e,s){super("SynthesisTriggeredEvent",n),this.privSessionAudioDestinationId=e,this.privTurnAudioDestinationId=s}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}V.SynthesisTriggeredEvent=i;class u extends t{constructor(n,e){super("ConnectingToSynthesisServiceEvent",n),this.privAuthFetchEventId=e}get authFetchEventId(){return this.privAuthFetchEventId}}V.ConnectingToSynthesisServiceEvent=u;class o extends t{constructor(n,e){super("SynthesisStartedEvent",n),this.privAuthFetchEventId=e}get authFetchEventId(){return this.privAuthFetchEventId}}return V.SynthesisStartedEvent=o,V}var sp;function hg(){if(sp)return bi;sp=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.SynthesisTurn=void 0;const r=I(),t=Oe(),i=y(),u=yh(),o=pg();let a=class ps{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=r.createNoDashGuid(),this.privTurnDeferral=new r.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const e=new i.PropertyCollection;return e.setProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),e}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const e=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(e),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(e,s,c,p){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=s,this.privIsSSML=c,this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",p!==void 0&&(this.privTurnAudioDestination=p,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new o.SynthesisTriggeredEvent(this.requestId,void 0,p===void 0?void 0:p.id()))}onPreConnectionStart(e){this.privAuthFetchEventId=e,this.onEvent(new o.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){if(e===200){this.onEvent(new o.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else e===403&&this.onComplete()}onServiceResponseMessage(e){const s=JSON.parse(e);this.streamId=s.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(e){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new r.Deferred;const s=JSON.parse(e);s.webrtc&&(this.privWebRTCSDP=s.webrtc.connectionString)}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(e))}onTextBoundaryEvent(e){this.updateTextOffset(e.Data.text.Text,e.Type)}onVisemeMetadataReceived(e){e.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=e.Data.AnimationChunk)}onSessionEnd(e){this.privAudioDuration=e.Data.Offset}async constructSynthesisResult(){const e=await this.getAllReceivedAudioWithHeader();return new i.SpeechSynthesisResult(this.requestId,i.ResultReason.SynthesizingAudioCompleted,e,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const e=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",e}onEvent(e){r.Events.instance.onEvent(e)}static isXmlTag(e){return e.length>=2&&e[0]==="<"&&e[e.length-1]===">"}updateTextOffset(e,s){s===u.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!ps.isXmlTag(e)&&this.updateTextOffset(e,s))):(this.privSentenceOffset=this.privRawText.indexOf(e,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!ps.isXmlTag(e)&&this.updateTextOffset(e,s)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(e){return this.privRawText.indexOf("<",e+1)>this.privRawText.indexOf(">",e+1)}};return bi.SynthesisTurn=a,bi}var Mi={},op;function dg(){if(op)return Mi;op=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.SynthesisAdapterBase=void 0;const r=I(),t=y(),i=E(),u=De();let o=class{constructor(n,e,s,c){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!n)throw new r.ArgumentNullError("authentication");if(!e)throw new r.ArgumentNullError("connectionFactory");if(!s)throw new r.ArgumentNullError("synthesizerConfig");this.privAuthentication=n,this.privConnectionFactory=e,this.privSynthesizerConfig=s,this.privIsDisposed=!1,this.privSessionAudioDestination=c,this.privSynthesisTurn=new i.SynthesisTurn,this.privConnectionEvents=new r.EventSource,this.privServiceEvents=new r.EventSource,this.privSynthesisContext=new i.SynthesisContext,this.privAgentConfig=new i.AgentConfig,this.connectionEvents.attach(p=>{if(p.name==="ConnectionClosedEvent"){const h=p;h.statusCode!==1e3&&this.cancelSynthesisLocal(t.CancellationReason.Error,h.statusCode===1007?t.CancellationErrorCode.BadRequestParameters:t.CancellationErrorCode.ConnectionFailure,`${h.reason} websocket error code: ${h.statusCode}`)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(n){this.privActivityTemplate=n}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(n){this.privAudioOutputFormat=n,this.privSynthesisTurn.audioOutputFormat=n,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=n),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=n)}isDisposed(){return this.privIsDisposed}async dispose(n){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(n)}async connect(){await this.connectImpl()}async sendNetworkMessage(n,e){const s=typeof e=="string"?r.MessageType.Text:r.MessageType.Binary,c=typeof e=="string"?"application/json":"";return(await this.fetchConnection()).send(new u.SpeechConnectionMessage(s,n,this.privSynthesisTurn.requestId,c,e))}async Speak(n,e,s,c,p,h){let d;if(e?d=n:d=this.privSynthesizer.buildSsml(n),this.speakOverride!==void 0)return this.speakOverride(d,s,c,p);this.privSuccessCallback=c,this.privErrorCallback=p,this.privSynthesisTurn.startNewSynthesis(s,n,e,h);try{await this.connectImpl();const l=await this.fetchConnection();await this.sendSynthesisContext(l),await this.sendSsmlMessage(l,d,s),this.onSynthesisStarted(s),this.receiveMessage()}catch(l){return this.cancelSynthesisLocal(t.CancellationReason.Error,t.CancellationErrorCode.ConnectionFailure,l),Promise.reject(l)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new u.SpeechConnectionMessage(r.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(n,e,s,c){const p=new t.PropertyCollection;p.setProperty(i.CancellationErrorCodePropertyName,t.CancellationErrorCode[s]);const h=new t.SpeechSynthesisResult(n,t.ResultReason.Canceled,void 0,c,p);if(this.onSynthesisCancelled(h),this.privSuccessCallback)try{this.privSuccessCallback(h)}catch{}}cancelSynthesisLocal(n,e,s){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,n,e,s))}processTypeSpecificMessages(n){return!0}async receiveMessage(){try{const e=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!e)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const s=u.SpeechConnectionMessage.fromConnectionMessage(e);if(s.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(s.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(s.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(s.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===s.streamId.toLowerCase()&&s.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(s.binaryBody),this.onSynthesizing(s.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(s.binaryBody));break;case"audio.metadata":const c=i.SynthesisAudioMetadata.fromJSON(s.textBody).Metadata;for(const h of c)switch(h.Type){case i.MetadataType.WordBoundary:case i.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(h);const d=new t.SpeechSynthesisWordBoundaryEventArgs(h.Data.Offset,h.Data.Duration,h.Data.text.Text,h.Data.text.Length,h.Type===i.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,h.Data.text.BoundaryType);this.onWordBoundary(d);break;case i.MetadataType.Bookmark:const l=new t.SpeechSynthesisBookmarkEventArgs(h.Data.Offset,h.Data.Bookmark);this.onBookmarkReached(l);break;case i.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(h),h.Data.IsLastAnimation){const f=new t.SpeechSynthesisVisemeEventArgs(h.Data.Offset,h.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(f)}break;case i.MetadataType.AvatarSignal:this.onAvatarEvent(h);break;case i.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(h);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let p;try{p=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(p)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.onSynthesisCompleted(p);break;default:this.processTypeSpecificMessages(s)||this.privServiceEvents&&this.serviceEvents.onEvent(new r.ServiceEvent(s.path.toLowerCase(),s.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(n){this.setSynthesisContextSynthesisSection();const e=this.synthesisContext.toJSON();if(e)return n.send(new u.SpeechConnectionMessage(r.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",e))}setSpeechConfigSynthesisSection(){}connectImpl(n=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(s=>s.state()===r.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=r.createNoDashGuid(),this.privConnectionId=r.createNoDashGuid(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const e=n?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=e.then(async s=>{this.privSynthesisTurn.onAuthCompleted(!1);const c=this.privConnectionFactory.create(this.privSynthesizerConfig,s,this.privConnectionId);c.events.attach(h=>{this.connectionEvents.onEvent(h)});const p=await c.open();return p.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.resolve(c)):p.statusCode===403&&!n?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${p.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Url)} Reason: ${p.reason}`))},s=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(s)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(n,e){if(e)return n.send(new u.SpeechConnectionMessage(r.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",e))}sendSsmlMessage(n,e,s){return n.send(new u.SpeechConnectionMessage(r.MessageType.Text,"ssml",s,"application/ssml+xml",e))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(n=>n.state()===r.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const n=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(n):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(n,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),n)}onAvatarEvent(n){}onSynthesisStarted(n){}onSynthesizing(n){}onSynthesisCancelled(n){}onSynthesisCompleted(n){}onWordBoundary(n){}onVisemeReceived(n){}onBookmarkReached(n){}};return Mi.SynthesisAdapterBase=o,o.telemetryDataEnabled=!0,Mi}var Oi={},ap;function lg(){if(ap)return Oi;ap=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.AvatarSynthesisAdapter=void 0;const r=y(),t=E();let i=class extends t.SynthesisAdapterBase{constructor(o,a,n,e,s){super(o,a,n,void 0),this.privAvatarSynthesizer=e,this.privSynthesizer=e,this.privAvatarConfig=s}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:this.privAvatarConfig.videoFormat?.bitrate,codec:this.privAvatarConfig.videoFormat?.codec,crop:{bottomRight:{x:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.y},topLeft:{x:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.y}},resolution:{height:this.privAvatarConfig.videoFormat?.height,width:this.privAvatarConfig.videoFormat?.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(r.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:this.privAvatarConfig.backgroundImage?.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(o){if(this.privAvatarSynthesizer.avatarEventReceived){const a=new r.AvatarEventArgs(o.Data.Offset,o.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,a)}catch{}}}};return Oi.AvatarSynthesisAdapter=i,Oi}var Di={},cp;function vg(){if(cp)return Di;cp=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.SpeechSynthesisAdapter=void 0;const r=y(),t=E();let i=class extends t.SynthesisAdapterBase{constructor(o,a,n,e,s){super(o,a,n,s),this.privSpeechSynthesizer=e,this.privSynthesizer=e}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(o){const a=new r.SpeechSynthesisEventArgs(new r.SpeechSynthesisResult(o,r.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,a)}onSynthesizing(o){if(this.privSpeechSynthesizer.synthesizing)try{const a=this.privSynthesisTurn.audioOutputFormat.addHeader(o),n=new r.SpeechSynthesisEventArgs(new r.SpeechSynthesisResult(this.privSynthesisTurn.requestId,r.ResultReason.SynthesizingAudio,a));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,n)}catch{}}onSynthesisCancelled(o){if(this.privSpeechSynthesizer.SynthesisCanceled){const a=new r.SpeechSynthesisEventArgs(o);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,a)}catch{}}}onSynthesisCompleted(o){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new r.SpeechSynthesisEventArgs(o))}catch{}}onWordBoundary(o){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,o)}catch{}}onVisemeReceived(o){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,o)}catch{}}onBookmarkReached(o){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,o)}catch{}}};return Di.SpeechSynthesisAdapter=i,Di}var ki={},up;function fg(){if(up)return ki;up=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.SynthesisRestAdapter=void 0;const r=k(),t=y(),i=H(),u=N();let o=class{constructor(n,e){let s=n.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!s){const p=n.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"westus"),h=i.ConnectionFactoryBase.getHostSuffix(p);s=n.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`https://${p}.tts.speech${h}`)}this.privUri=`${s}/cognitiveservices/voices/list`;const c=r.RestConfigBase.requestOptions;this.privRestAdapter=new r.RestMessageAdapter(c),this.privAuthentication=e}getVoicesList(n){return this.privRestAdapter.setHeaders(u.HeaderNames.ConnectionId,n),this.privAuthentication.fetch(n).then(e=>(this.privRestAdapter.setHeaders(e.headerName,e.token),this.privRestAdapter.request(r.RestRequestType.Get,this.privUri)))}};return ki.SynthesisRestAdapter=o,ki}var es={},pp;function gg(){return pp||(pp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.SynthesizerConfig=r.SynthesisServiceType=void 0;const t=E();var i;(function(o){o[o.Standard=0]="Standard",o[o.Custom=1]="Custom"})(i=r.SynthesisServiceType||(r.SynthesisServiceType={}));class u{constructor(a,n){this.privSynthesisServiceType=i.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=a||new t.SpeechServiceConfig(new t.Context(null)),this.privParameters=n}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(a){this.privSynthesisServiceType=a}set synthesisVideoSection(a){this.privSpeechServiceConfig.Context.synthesis={video:a}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}r.SynthesizerConfig=u}(es)),es}var zi={},hp;function Sg(){if(hp)return zi;hp=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.SynthesisContext=void 0;const r=y();let t=class{constructor(){this.privContext={}}setSection(u,o){this.privContext[u]=o}set audioOutputFormat(u){this.privAudioOutputFormat=u}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(u){const o=this.buildSynthesisContext(u);this.setSection("synthesis",o)}buildSynthesisContext(u){return{audio:{metadataOptions:{bookmarkEnabled:!!u?.bookmarkReached,punctuationBoundaryEnabled:u?.properties.getProperty(r.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!u?.wordBoundary),sentenceBoundaryEnabled:u?.properties.getProperty(r.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!u?.visemeReceived,wordBoundaryEnabled:u?.properties.getProperty(r.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!u?.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:u?.autoDetectSourceLanguage}}}};return zi.SynthesisContext=t,zi}var Ni={},dp;function mg(){if(dp)return Ni;dp=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.SpeakerRecognitionConfig=void 0;const r=E();let t=class{constructor(u,o){this.privContext=u||new r.Context(null),this.privParameters=o}get parameters(){return this.privParameters}get Context(){return this.privContext}};return Ni.SpeakerRecognitionConfig=t,Ni}var ji={},lp;function Cg(){if(lp)return ji;lp=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.SpeakerServiceRecognizer=void 0;const r=k(),t=I(),i=y(),u=E(),o=De();let a=class extends u.ServiceRecognizerBase{constructor(e,s,c,p,h){super(e,s,c,p,h),this.privSpeakerRecognizer=h,this.privSpeakerAudioSource=c,this.recognizeSpeaker=d=>this.recognizeSpeakerOnce(d),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(e){let s=!1;const c=new i.PropertyCollection;switch(e.messageType===t.MessageType.Text&&c.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.response":const h=JSON.parse(e.textBody);let d;h.status.statusCode.toLowerCase()!=="success"?d=new i.SpeakerRecognitionResult(h,i.ResultReason.Canceled,i.CancellationErrorCode.ServiceError,h.status.reason):d=new i.SpeakerRecognitionResult(h,i.ResultReason.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(d),s=!0;break}const p=new t.Deferred;return p.resolve(s),p.promise}cancelRecognition(e,s,c,p,h){if(new i.PropertyCollection().setProperty(u.CancellationErrorCodePropertyName,i.CancellationErrorCode[p]),this.privResultDeferral){const l=new i.SpeakerRecognitionResult({scenario:this.privSpeakerModel.scenario,status:{statusCode:h,reason:h}},i.ResultReason.Canceled,p,h);try{this.privResultDeferral.resolve(l)}catch(f){this.privResultDeferral.reject(f)}}}async recognizeSpeakerOnce(e){this.privSpeakerModel=e,this.voiceProfileType=e.scenario,this.privResultDeferral||(this.privResultDeferral=new t.Deferred),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(i.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const s=this.connectImpl(),c=this.sendPreAudioMessages(this.extractSpeakerContext(e)),p=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),h=await this.privSpeakerAudioSource.format,d=await this.privSpeakerAudioSource.deviceInfo,l=new r.ReplayableAudioNode(p,h.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(l,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:d};try{await s,await c}catch(g){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,g)}const f=new i.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,f),this.receiveMessage(),this.sendAudio(l).then(()=>{},g=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,g)}),this.privResultDeferral.promise}async sendPreAudioMessages(e){const s=await this.fetchConnection();await this.sendSpeakerRecognition(s,e)}async sendSpeakerRecognition(e,s){const c=JSON.stringify(s);return e.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",c))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}};return ji.SpeakerServiceRecognizer=a,ji}var Li={},vp;function yg(){if(vp)return Li;vp=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.VoiceServiceRecognizer=void 0;const r=k(),t=I(),i=y(),u=E(),o=De();let a=class extends u.ServiceRecognizerBase{constructor(e,s,c,p,h){super(e,s,c,p,h),this.privDeferralMap=new t.DeferralMap,this.privSpeakerAudioSource=c,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(e){this.privSpeakerAudioSource=e}processTypeSpecificMessages(e){let s=!1;const c=new i.PropertyCollection;switch(e.messageType===t.MessageType.Text&&c.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.profiles":const h=JSON.parse(e.textBody);switch(h.operation.toLowerCase()){case"create":this.handleCreateResponse(h,e.requestId);break;case"delete":case"reset":this.handleResultResponse(h,e.requestId);break;case"fetch":const v=JSON.parse(e.textBody);this.handleFetchResponse(v,e.requestId);break}s=!0;break;case"speaker.phrases":const d=JSON.parse(e.textBody);this.handlePhrasesResponse(d,e.requestId),s=!0;break;case"speaker.profile.enrollment":const l=JSON.parse(e.textBody),f=new i.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(l.enrollment?l.enrollment.enrollmentStatus:l.status.statusCode),l.enrollment?JSON.stringify(l.enrollment):void 0,l.status.reason);this.privDeferralMap.getId(e.requestId)&&this.privDeferralMap.complete(e.requestId,f),this.privRequestSession.onSpeechEnded(),s=!0;break}const p=new t.Deferred;return p.resolve(s),p.promise}cancelRecognition(e,s,c,p,h){new i.PropertyCollection().setProperty(u.CancellationErrorCodePropertyName,i.CancellationErrorCode[p]);const l=new i.VoiceProfileEnrollmentResult(i.ResultReason.Canceled,h,h);this.privDeferralMap.getId(s)&&this.privDeferralMap.complete(s,l)}async createProfile(e,s){this.voiceProfileType=e.toString();const c=this.connectImpl();try{const p=new t.Deferred;return await c,await this.sendCreateProfile(p,e,s),this.receiveMessage(),p.promise}catch(p){throw p}}async resetProfile(e){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("reset",e.profileType,e)}async deleteProfile(e){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("delete",e.profileType,e)}async retrieveEnrollmentResult(e){return this.voiceProfileType=e.profileType.toString(),this.privExpectedProfileId=e.profileId,this.sendCommonRequest("fetch",e.profileType,e)}async getAllProfiles(e){return this.voiceProfileType=e.toString(),this.sendCommonRequest("fetch",e)}async getActivationPhrases(e,s){this.voiceProfileType=e.toString();const c=this.connectImpl();try{const p=new t.Deferred;return await c,await this.sendPhrasesRequest(p,e,s),this.receiveMessage(),p.promise}catch(p){throw p}}async enrollProfile(e){this.voiceProfileType=e.profileType.toString();const s=new t.Deferred;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(i.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const c=this.connectImpl(),p=this.sendPreAudioMessages(e,s),h=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),d=await this.privSpeakerAudioSource.format,l=await this.privSpeakerAudioSource.deviceInfo,f=new r.ReplayableAudioNode(h,d.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(f,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:l};try{await c,await p}catch(S){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,S)}const v=new i.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,v),this.receiveMessage(),this.sendAudio(f).then(()=>{},S=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,S)}),s.promise}async sendPreAudioMessages(e,s){const c=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,s),await this.sendBaseRequest(c,"enroll",this.scenarioFrom(e.profileType),e)}async sendPhrasesRequest(e,s,c){const p=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);const h=this.scenarioFrom(s),d={locale:c,scenario:h};return p.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(d)))}async sendCreateProfile(e,s,c){const p=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);const h=s===i.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":s===i.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",d={locale:c,number:"1",scenario:h};return p.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(d)))}async sendCommonRequest(e,s,c=void 0){const p=this.connectImpl();try{const h=new t.Deferred;this.privRequestSession.onSpeechContext(),await p;const d=await this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,h),await this.sendBaseRequest(d,e,this.scenarioFrom(s),c),this.receiveMessage(),h.promise}catch(h){throw h}}async sendBaseRequest(e,s,c,p){const h={scenario:c};return p?h.profileIds=[p.profileId]:h.maxPageSize=-1,e.send(new o.SpeechConnectionMessage(t.MessageType.Text,`speaker.profile.${s}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(h)))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}handlePhrasesResponse(e,s){if(this.privDeferralMap.getId(s))if(e.status.statusCode.toLowerCase()!=="success"){const c=i.ResultReason.Canceled,p=new i.VoiceProfilePhraseResult(c,e.status.statusCode,e.passPhraseType,[]);this.privDeferralMap.complete(s,p)}else if(e.phrases&&e.phrases.length>0){const c=i.ResultReason.EnrollingVoiceProfile,p=new i.VoiceProfilePhraseResult(c,e.status.statusCode,e.passPhraseType,e.phrases);this.privDeferralMap.complete(s,p)}else throw new Error("Voice Profile get activation phrases failed, no phrases received");else throw new Error(`Voice Profile get activation phrases request for requestID ${s} not found`)}handleCreateResponse(e,s){if(e.profiles&&e.profiles.length>0)if(this.privDeferralMap.getId(s)){const c=e.profiles.map(p=>p.profileId);this.privDeferralMap.complete(s,c)}else throw new Error(`Voice Profile create request for requestID ${s} not found`);else throw new Error("Voice Profile create failed, no profile id received")}handleResultResponse(e,s){if(this.privDeferralMap.getId(s)){const c=e.operation.toLowerCase()==="delete"?i.ResultReason.DeletedVoiceProfile:i.ResultReason.ResetVoiceProfile,p=e.status.statusCode.toLowerCase()==="success"?c:i.ResultReason.Canceled,h=new i.VoiceProfileResult(p,`statusCode: ${e.status.statusCode}, errorDetails: ${e.status.reason}`);this.privDeferralMap.complete(s,h)}else throw new Error(`Voice Profile create request for requestID ${s} not found`)}handleFetchResponse(e,s){if(this.privDeferralMap.getId(s)&&e.profiles[0]){if(this.privExpectedProfileId&&e.profiles.length===1&&e.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;const c=e.profiles[0],p=new i.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(c.enrollmentStatus),JSON.stringify(c),e.status.reason);this.privDeferralMap.complete(s,p)}else if(e.profiles.length>0){const c=e.profiles,p=[];for(const h of c)p.push(new i.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(h.enrollmentStatus),JSON.stringify(h),e.status.reason));this.privDeferralMap.complete(s,p)}}else throw new Error(`Voice Profile fetch request for requestID ${s} not found`)}enrollmentReasonFrom(e){switch(e.toLowerCase()){case"enrolled":return i.ResultReason.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return i.ResultReason.Canceled;default:return i.ResultReason.EnrollingVoiceProfile}}scenarioFrom(e){return e===i.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":e===i.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}};return Li.VoiceServiceRecognizer=a,Li}var ts={},fp;function Rg(){return fp||(fp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.type=r.connectivity=r.Device=r.OS=r.System=r.Context=r.SpeechServiceConfig=void 0;class t{constructor(e){this.context=e}serialize(){return JSON.stringify(this,(e,s)=>{if(s&&typeof s=="object"&&!Array.isArray(s)){const c={};for(const p in s)Object.hasOwnProperty.call(s,p)&&(c[p&&p.charAt(0).toLowerCase()+p.substring(1)]=s[p]);return c}return s})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}}r.SpeechServiceConfig=t;class i{constructor(e){this.system=new u,this.os=e}}r.Context=i;class u{constructor(){const e="1.43.1";this.name="SpeechSDK",this.version=e,this.build="JavaScript",this.lang="JavaScript"}}r.System=u;class o{constructor(e,s,c){this.platform=e,this.name=s,this.version=c}}r.OS=o;class a{constructor(e,s,c){this.manufacturer=e,this.model=s,this.version=c}}r.Device=a,function(n){n.Bluetooth="Bluetooth",n.Wired="Wired",n.WiFi="WiFi",n.Cellular="Cellular",n.InBuilt="InBuilt",n.Unknown="Unknown"}(r.connectivity||(r.connectivity={})),function(n){n.Phone="Phone",n.Speaker="Speaker",n.Car="Car",n.Headset="Headset",n.Thermostat="Thermostat",n.Microphones="Microphones",n.Deskphone="Deskphone",n.RemoteControl="RemoteControl",n.Unknown="Unknown",n.File="File",n.Stream="Stream"}(r.type||(r.type={}))}(ts)),ts}var gp;function E(){return gp||(gp=1,function(r){var t=re&&re.__createBinding||(Object.create?function(a,n,e,s){s===void 0&&(s=e),Object.defineProperty(a,s,{enumerable:!0,get:function(){return n[e]}})}:function(a,n,e,s){s===void 0&&(s=e),a[s]=n[e]}),i=re&&re.__exportStar||function(a,n){for(var e in a)e!=="default"&&!n.hasOwnProperty(e)&&t(n,a,e)};Object.defineProperty(r,"__esModule",{value:!0}),r.AutoDetectSourceLanguagesOpenRangeOptionName=r.ForceDictationPropertyName=r.ServicePropertiesPropertyName=r.CancellationErrorCodePropertyName=r.OutputFormatPropertyName=void 0,i(cl(),r),i(ul(),r),i(ds(),r),i(pl(),r),i(hl(),r),i(vf(),r),i(ff(),r),i(Ss(),r),i(gf(),r),i(Sf(),r),i(mf(),r),i(Cf(),r),i(yf(),r),i(Rf(),r),i(Pf(),r),i(Ef(),r),i(If(),r),i(sh(),r),i(Af(),r),i(Tf(),r),i(wf(),r),i(_f(),r),i(bf(),r),i(Mf(),r),i(Of(),r),i(Df(),r),i(kf(),r),i(zf(),r),i(Nf(),r),i(jf(),r),i(Lf(),r),i(qf(),r),i(Bf(),r),i(xf(),r),i(Ff(),r),i(Uf(),r),i(Vf(),r),i(Hf(),r),i(Kf(),r),i($f(),r),i(Qf(),r),i(Xf(),r),i(ug(),r),i(yh(),r),i(hg(),r),i(dg(),r);var u=lg();Object.defineProperty(r,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return u.AvatarSynthesisAdapter}});var o=vg();Object.defineProperty(r,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return o.SpeechSynthesisAdapter}}),i(fg(),r),i(gg(),r),i(Sg(),r),i(mg(),r),i(Cg(),r),i(yg(),r),i(Rg(),r),r.OutputFormatPropertyName="OutputFormat",r.CancellationErrorCodePropertyName="CancellationErrorCode",r.ServicePropertiesPropertyName="ServiceProperties",r.ForceDictationPropertyName="ForceDictation",r.AutoDetectSourceLanguagesOpenRangeOptionName="UND"}(re)),re}var Sp;function Pg(){return Sp||(Sp=1,function(r){var t=te&&te.__createBinding||(Object.create?function(o,a,n,e){e===void 0&&(e=n),Object.defineProperty(o,e,{enumerable:!0,get:function(){return a[n]}})}:function(o,a,n,e){e===void 0&&(e=n),o[e]=a[n]}),i=te&&te.__exportStar||function(o,a){for(var n in o)n!=="default"&&!a.hasOwnProperty(n)&&t(a,o,n)};Object.defineProperty(r,"__esModule",{value:!0});const u=E();new u.AgentConfig,i(y(),r)}(te)),te}var b=Pg();class Bi{static instance;audio=null;isPlaying=!1;currentAudioBlob=null;currentMessageId=null;configLoaded=!1;configLoading=!1;siliconFlowApiKey="";useSiliconFlowStream=!1;openaiApiKey="";useOpenAI=!1;openaiModel="tts-1";openaiVoice="alloy";openaiResponseFormat="mp3";openaiSpeed=1;useOpenAIStream=!1;azureApiKey="";azureRegion="eastus";useAzure=!1;azureVoiceName="zh-CN-XiaoxiaoNeural";azureLanguage="zh-CN";azureOutputFormat="audio-24khz-160kbitrate-mono-mp3";azureRate="medium";azurePitch="medium";azureVolume="medium";azureStyle="general";azureStyleDegree=1;azureRole="default";azureUseSSML=!0;defaultModel="FunAudioLLM/CosyVoice2-0.5B";defaultVoice="FunAudioLLM/CosyVoice2-0.5B:alex";audioContext=null;sourceNode=null;isStreamPlaying=!1;constructor(){console.log("初始化TTSService"),"speechSynthesis"in window&&window.speechSynthesis.getVoices(),this.audio=new Audio,this.audio.onended=()=>{this.isPlaying=!1,this.currentMessageId=null},this.audio.onerror=()=>{console.error("音频播放错误"),this.isPlaying=!1,this.currentMessageId=null};try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch(t){console.warn("AudioContext初始化失败，流式播放可能不可用",t)}}static getInstance(){return Bi.instance||(Bi.instance=new Bi),Bi.instance}setApiKey(t){this.siliconFlowApiKey=t}setUseSiliconFlowStream(t){this.useSiliconFlowStream=t}setOpenAIApiKey(t){this.openaiApiKey=t}setUseOpenAI(t){this.useOpenAI=t}setAzureApiKey(t){this.azureApiKey=t}setAzureRegion(t){this.azureRegion=t}setUseAzure(t){this.useAzure=t}setAzureVoiceName(t){this.azureVoiceName=t}setAzureLanguage(t){this.azureLanguage=t}setAzureOutputFormat(t){this.azureOutputFormat=t}setAzureRate(t){this.azureRate=t}setAzurePitch(t){this.azurePitch=t}setAzureVolume(t){this.azureVolume=t}setAzureStyle(t){this.azureStyle=t}setAzureStyleDegree(t){this.azureStyleDegree=Math.max(.01,Math.min(2,t))}setAzureRole(t){this.azureRole=t}setAzureUseSSML(t){this.azureUseSSML=t}setOpenAIModel(t){this.openaiModel=t}setOpenAIVoice(t){this.openaiVoice=t}setOpenAIResponseFormat(t){this.openaiResponseFormat=t}setOpenAISpeed(t){t<.25&&(t=.25),t>4&&(t=4),this.openaiSpeed=t}setUseOpenAIStream(t){this.useOpenAIStream=t}setDefaultVoice(t,i){t&&(this.defaultModel=t),i&&(this.defaultVoice=i)}async initializeConfig(){if(this.configLoaded)return!0;if(this.configLoading)return new Promise(t=>{const i=()=>{this.configLoaded?t(!0):this.configLoading?setTimeout(i,50):t(!1)};i()});this.configLoading=!0;try{const{getStorageItem:t}=await wd(async()=>{const{getStorageItem:n}=await import("./index-Bp4oiTTd.js").then(e=>e.hz);return{getStorageItem:n}},__vite__mapDeps([0,1])),[i,u,o,a]=await Promise.all([t("siliconflow_api_key"),t("tts_model"),t("tts_voice"),t("enable_tts")]);return i&&this.setApiKey(i),u&&(this.defaultModel=u),o&&(this.defaultVoice=o.includes(":")?o:`${u||this.defaultModel}:${o}`),this.configLoaded=!0,this.configLoading=!1,!0}catch(t){return console.error("TTSService配置初始化失败:",t),this.configLoading=!1,!1}}isConfigLoaded(){return this.configLoaded}stop(){this.audio&&(this.audio.pause(),this.audio.currentTime=0),"speechSynthesis"in window&&window.speechSynthesis.cancel(),this.stopStream(),this.isPlaying=!1,this.currentMessageId=null,this.releaseBlobUrl()}releaseBlobUrl(){this.currentAudioBlob&&(URL.revokeObjectURL(this.currentAudioBlob),this.currentAudioBlob=null)}dispose(){this.stop(),this.audio&&(this.audio.src="",this.audio=null),this.audioContext&&this.audioContext.state!=="closed"&&(this.audioContext.close(),this.audioContext=null)}stopStream(){if(this.sourceNode){try{this.sourceNode.stop(),this.sourceNode.disconnect()}catch(t){console.error("停止音频源时出错",t)}this.sourceNode=null}this.isStreamPlaying=!1}getIsPlaying(){return this.isPlaying||this.isStreamPlaying}getCurrentMessageId(){return this.currentMessageId}async togglePlayback(t,i,u=this.defaultVoice){if((this.isPlaying||this.isStreamPlaying)&&this.currentMessageId===t)return this.stop(),!1;(this.isPlaying||this.isStreamPlaying)&&this.stop();const o=await this.speak(i,u);return o&&(this.currentMessageId=t),o}async speak(t,i=this.defaultVoice){try{if((this.isPlaying||this.isStreamPlaying)&&this.stop(),!t||t.trim()==="")return console.error("文本为空，无法播放"),!1;if(console.log(`开始播放文本，语音: ${i}`),this.isPlaying=!0,this.useAzure&&await this.speakWithAzure(t))return!0;if(this.useOpenAI){if(this.useOpenAIStream&&this.audioContext){if(await this.speakWithOpenAIStream(t))return!0}else if(await this.speakWithOpenAI(t))return!0}return await this.speakWithSiliconFlow(t,i)||this.speakWithWebSpeechAPI(t,i)?!0:(console.warn("所有TTS方法播放失败"),this.isPlaying=!1,!1)}catch(u){return console.error("播放文本失败:",u),this.isPlaying=!1,this.currentMessageId=null,!1}}async speakWithOpenAI(t){try{if(!this.openaiApiKey)return console.warn("OpenAI API密钥未设置，尝试其他方法"),!1;const i="https://api.openai.com/v1/audio/speech",u={model:this.openaiModel,input:t,voice:this.openaiVoice,response_format:this.openaiResponseFormat,speed:this.openaiSpeed};console.log("OpenAI TTS请求参数:",{model:this.openaiModel,voice:this.openaiVoice,response_format:this.openaiResponseFormat,speed:this.openaiSpeed});const o=await fetch(i,{method:"POST",headers:{Authorization:`Bearer ${this.openaiApiKey}`,"Content-Type":"application/json"},body:JSON.stringify(u)});if(!o.ok){const n=await o.json().catch(()=>({}));return console.error("OpenAI TTS API请求失败:",o.status,n),!1}const a=await o.blob();if(this.releaseBlobUrl(),this.currentAudioBlob=URL.createObjectURL(a),this.audio){this.audio.src=this.currentAudioBlob;try{await this.audio.play()}catch(n){return console.error("OpenAI TTS API播放失败:",n),this.isPlaying=!1,!1}return!0}return!1}catch(i){return console.error("OpenAI TTS API播放失败:",i),!1}}async speakWithOpenAIStream(t){try{if(!this.openaiApiKey)return console.warn("OpenAI API密钥未设置，尝试其他方法"),!1;if(!this.audioContext)return console.warn("AudioContext不可用，无法使用流式播放"),!1;const i="https://api.openai.com/v1/audio/speech",u={model:this.openaiModel,input:t,voice:this.openaiVoice,response_format:this.openaiResponseFormat,speed:this.openaiSpeed,stream:!0};console.log("OpenAI TTS流式请求参数:",{model:this.openaiModel,voice:this.openaiVoice,response_format:this.openaiResponseFormat,speed:this.openaiSpeed});const o=await fetch(i,{method:"POST",headers:{Authorization:`Bearer ${this.openaiApiKey}`,"Content-Type":"application/json"},body:JSON.stringify(u)});if(!o.ok){const h=await o.json().catch(()=>({}));return console.error("OpenAI TTS API流式请求失败:",o.status,h),!1}this.stopStream(),this.isStreamPlaying=!0;const a=o.body?.getReader();if(!a)return console.error("无法获取响应流"),!1;let n="audio/mp3";switch(this.openaiResponseFormat){case"mp3":n="audio/mp3";break;case"opus":n="audio/opus";break;case"aac":n="audio/aac";break;case"flac":n="audio/flac";break}const e=new MediaSource,s=new Audio;s.src=URL.createObjectURL(e);const c=[];return(async()=>{let h=!1;for(;!h;){const{value:d,done:l}=await a.read();if(h=l,d&&c.push(d),h){const f=c.reduce((C,P)=>C+P.length,0),v=new Uint8Array(f);let g=0;for(const C of c)v.set(C,g),g+=C.length;const S=new Blob([v],{type:n}),m=URL.createObjectURL(S);if(this.audio){this.audio.src=m;try{return await this.audio.play(),this.audio.onended=()=>{URL.revokeObjectURL(m),this.isStreamPlaying=!1,this.currentMessageId=null},!0}catch(C){return console.error("OpenAI TTS API流式播放失败:",C),URL.revokeObjectURL(m),this.isStreamPlaying=!1,!1}}}}return!1})().catch(h=>{console.error("处理音频流时出错:",h),this.isStreamPlaying=!1}),!0}catch(i){return console.error("OpenAI TTS API流式播放失败:",i),this.isStreamPlaying=!1,!1}}async speakWithSiliconFlow(t,i){try{if(!this.siliconFlowApiKey)return console.warn("硅基流动API密钥未设置，尝试其他方法"),!1;const u="https://api.siliconflow.cn/v1/audio/speech",o=this.defaultModel;let a=i||this.defaultVoice;a&&!a.includes(":")&&(a=`${o}:${a}`),console.log("硅基流动TTS请求参数:",{model:o,voice:a,textLength:t.length,useStream:this.useSiliconFlowStream}),console.log("硅基流动TTS文本内容:",t.substring(0,100)+(t.length>100?"...":""));const n={model:o,input:t,voice:a,response_format:"mp3",stream:this.useSiliconFlowStream};return console.log("硅基流动TTS完整请求体:",JSON.stringify(n,null,2)),this.useSiliconFlowStream?await this.speakWithSiliconFlowStream(u,n):await this.speakWithSiliconFlowNormal(u,n)}catch(u){return console.error("硅基流动API播放失败:",u),!1}}async speakWithSiliconFlowNormal(t,i){try{const u=await fetch(t,{method:"POST",headers:{Authorization:`Bearer ${this.siliconFlowApiKey}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok){const a=await u.json().catch(()=>({}));return console.error("硅基流动API请求失败:",u.status,a),!1}const o=await u.blob();if(this.releaseBlobUrl(),this.currentAudioBlob=URL.createObjectURL(o),this.audio){this.audio.src=this.currentAudioBlob;try{await this.audio.play()}catch(a){return console.error("硅基流动API播放失败:",a),this.isPlaying=!1,!1}return!0}return!1}catch(u){return console.error("硅基流动API标准模式播放失败:",u),!1}}async speakWithSiliconFlowStream(t,i){try{if(console.log("硅基流动TTS开始流式播放..."),!this.audioContext)return console.warn("AudioContext不可用，回退到标准模式"),await this.speakWithSiliconFlowNormal(t,{...i,stream:!1});const u=await fetch(t,{method:"POST",headers:{Authorization:`Bearer ${this.siliconFlowApiKey}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok){const o=await u.json().catch(()=>({}));return console.error("硅基流动API流式请求失败:",u.status,o),!1}if(u.body){this.isStreamPlaying=!0;const o=u.body.getReader(),a=[];try{for(;;){const{done:p,value:h}=await o.read();if(p)break;h&&a.push(h)}const n=a.reduce((p,h)=>p+h.length,0),e=new Uint8Array(n);let s=0;for(const p of a)e.set(p,s),s+=p.length;const c=new Blob([e],{type:"audio/mpeg"});if(this.releaseBlobUrl(),this.currentAudioBlob=URL.createObjectURL(c),this.audio){this.audio.src=this.currentAudioBlob;try{return await this.audio.play(),console.log("硅基流动TTS流式播放成功"),!0}catch(p){return console.error("硅基流动API流式播放失败:",p),this.isStreamPlaying=!1,!1}}return!1}finally{o.releaseLock(),this.isStreamPlaying=!1}}else return console.error("响应体为空"),!1}catch(u){return console.error("硅基流动API流式模式播放失败:",u),this.isStreamPlaying=!1,!1}}speakWithWebSpeechAPI(t,i){try{if(!("speechSynthesis"in window))return console.error("浏览器不支持Web Speech API"),!1;window.speechSynthesis.cancel();const u=new SpeechSynthesisUtterance(t);let o=window.speechSynthesis.getVoices();return console.log("可用的语音合成声音:",o),o.length===0?(setTimeout(()=>{o=window.speechSynthesis.getVoices(),this.setVoiceAndPlay(u,o,i)},100),!0):this.setVoiceAndPlay(u,o,i)}catch(u){return console.error("Web Speech API播放失败:",u),this.isPlaying=!1,!1}}setVoiceAndPlay(t,i,u){try{let o=i.find(a=>a.name===u);if(o)console.log("使用指定语音:",o.name);else if(console.warn("未找到指定的语音:",u),o=i.find(a=>a.lang==="zh-CN"),o)console.log("使用替代中文语音:",o.name);else if(i.length>0)o=i[0],console.log("使用第一个可用的语音:",o.name);else return console.warn("没有可用的语音"),this.isPlaying=!1,!1;return t.voice=o,t.rate=1,t.pitch=1,t.volume=1,t.onend=()=>{console.log("语音播放结束"),this.isPlaying=!1,this.currentMessageId=null},t.onerror=a=>{console.error("语音播放错误:",a),this.isPlaying=!1,this.currentMessageId=null},window.speechSynthesis.speak(t),!0}catch(o){return console.error("设置语音失败:",o),this.isPlaying=!1,!1}}async speakWithAzure(t){try{if(!this.azureApiKey||!this.azureRegion)return console.warn("Azure API密钥或区域未设置，尝试其他方法"),!1;console.log("Azure TTS请求参数:",{region:this.azureRegion,voiceName:this.azureVoiceName,language:this.azureLanguage,outputFormat:this.azureOutputFormat,rate:this.azureRate,pitch:this.azurePitch,volume:this.azureVolume,style:this.azureStyle,styleDegree:this.azureStyleDegree,role:this.azureRole,useSSML:this.azureUseSSML});const i=b.SpeechConfig.fromSubscription(this.azureApiKey,this.azureRegion);i.speechSynthesisOutputFormat=this.getAzureOutputFormat(),i.speechSynthesisVoiceName=this.azureVoiceName;const u=b.AudioConfig.fromDefaultSpeakerOutput(),o=new b.SpeechSynthesizer(i,u);let a=t;return this.azureUseSSML&&(a=this.buildSSMLText(t)),console.log("Azure TTS开始合成，文本长度:",a.length),new Promise(n=>{const e=Date.now();this.azureUseSSML?o.speakSsmlAsync(a,s=>{const c=Date.now()-e;console.log(`Azure TTS合成完成，耗时: ${c}ms`),s.reason===b.ResultReason.SynthesizingAudioCompleted?(console.log("Azure TTS语音合成成功"),this.isPlaying=!1,this.currentMessageId=null,n(!0)):(console.error("Azure TTS语音合成失败:",s.errorDetails),this.isPlaying=!1,n(!1)),o.close()},s=>{console.error("Azure TTS合成错误:",s),this.isPlaying=!1,o.close(),n(!1)}):o.speakTextAsync(a,s=>{const c=Date.now()-e;console.log(`Azure TTS合成完成，耗时: ${c}ms`),s.reason===b.ResultReason.SynthesizingAudioCompleted?(console.log("Azure TTS语音合成成功"),this.isPlaying=!1,this.currentMessageId=null,n(!0)):(console.error("Azure TTS语音合成失败:",s.errorDetails),this.isPlaying=!1,n(!1)),o.close()},s=>{console.error("Azure TTS合成错误:",s),this.isPlaying=!1,o.close(),n(!1)})})}catch(i){return console.error("Azure TTS播放失败:",i),this.isPlaying=!1,!1}}buildSSMLText(t){let i=`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="${this.azureLanguage}">`;i+=`<voice name="${this.azureVoiceName}">`;const u=[];if(this.azureRate!=="medium"&&u.push(`rate="${this.azureRate}"`),this.azurePitch!=="medium"&&u.push(`pitch="${this.azurePitch}"`),this.azureVolume!=="medium"&&u.push(`volume="${this.azureVolume}"`),u.length>0&&(i+=`<prosody ${u.join(" ")}>`),this.azureStyle!=="general"&&this.azureVoiceName.includes("Neural")){const a=[`style="${this.azureStyle}"`];this.azureStyleDegree!==1&&a.push(`styledegree="${this.azureStyleDegree}"`),this.azureRole!=="default"&&a.push(`role="${this.azureRole}"`),i+=`<mstts:express-as ${a.join(" ")}>`}const o=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;");return i+=o,this.azureStyle!=="general"&&this.azureVoiceName.includes("Neural")&&(i+="</mstts:express-as>"),u.length>0&&(i+="</prosody>"),i+="</voice>",i+="</speak>",console.log("构建的SSML:",i),i}getAzureOutputFormat(){return{"audio-16khz-32kbitrate-mono-mp3":b.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3,"audio-16khz-64kbitrate-mono-mp3":b.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3,"audio-16khz-128kbitrate-mono-mp3":b.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3,"audio-24khz-48kbitrate-mono-mp3":b.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3,"audio-24khz-96kbitrate-mono-mp3":b.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3,"audio-24khz-160kbitrate-mono-mp3":b.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3,"audio-48khz-96kbitrate-mono-mp3":b.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3,"audio-48khz-192kbitrate-mono-mp3":b.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3,"webm-16khz-16bit-mono-opus":b.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus,"webm-24khz-16bit-mono-opus":b.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus,"ogg-16khz-16bit-mono-opus":b.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus,"ogg-24khz-16bit-mono-opus":b.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus,"raw-16khz-16bit-mono-pcm":b.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm,"raw-24khz-16bit-mono-pcm":b.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm,"raw-48khz-16bit-mono-pcm":b.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm,"riff-16khz-16bit-mono-pcm":b.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm,"riff-24khz-16bit-mono-pcm":b.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm,"riff-48khz-16bit-mono-pcm":b.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm}[this.azureOutputFormat]||b.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3}}export{Bi as TTSService};
