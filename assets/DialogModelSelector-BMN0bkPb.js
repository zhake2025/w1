import{a0 as E,a1 as A,a2 as D,r as o,V as W,j as a,k as _,m as B,I as O,a3 as Y,e as $,B as k,G as z,n as G,X as V,Y as X,a4 as F,a5 as H,Z as Q}from"./index-5OteHtpV.js";import{I as Z}from"./InputAdornment-a3_xDuZj.js";import{S as q}from"./search-Dw_6t9R9.js";import{T as J,a as S}from"./Tabs-CDQ1XREM.js";import{C as K}from"./check-xghfeBSR.js";const v={dialogPaper:e=>({borderRadius:e?0:2,height:e?"100%":"auto",maxHeight:e?"100%":"80vh"}),dialogTitle:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},tabsContainer:{borderBottom:1,borderColor:"divider"},dialogContent:{px:1,py:2},list:{pt:0}},g={listItem:(e,s)=>({borderRadius:1,mb:.5,cursor:"pointer",bgcolor:e?s?"rgba(144, 202, 249, 0.16)":"rgba(25, 118, 210, 0.08)":"transparent","&:hover":{bgcolor:e?s?"rgba(144, 202, 249, 0.24)":"rgba(25, 118, 210, 0.12)":s?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)"}}),listItemIcon:{minWidth:40},avatar:(e,s,p)=>({width:28,height:28,bgcolor:e?.color||(s?p:"grey.400"),color:"white"}),primaryText:e=>({variant:"body1",fontWeight:e?"medium":"normal"}),secondaryText:{variant:"caption",noWrap:!0}},U=[],or=({selectedModel:e,availableModels:s,handleModelSelect:p,handleMenuClick:T,handleMenuClose:x,menuOpen:c})=>{const l=E(),d=A(l.breakpoints.down("sm")),[u,C]=D.useState("all"),[m,j]=o.useState(""),b=W(r=>r.settings.providers||U),f=o.useMemo(()=>{const r=new Map;return b.forEach(t=>{r.set(t.id,t.name)}),r},[b]),h=o.useCallback(r=>f.get(r)||r,[f]),N=o.useCallback(r=>{j(r.target.value)},[]),I=o.useMemo(()=>{if(!m.trim())return s;const r=m.toLowerCase();return s.filter(t=>{const y=(t.name||t.id).toLowerCase(),n=t.id.toLowerCase(),i=h(t.provider||t.providerType||"").toLowerCase();return y.includes(r)||n.includes(r)||i.includes(r)})},[s,m,h]),M=o.useMemo(()=>{const r={},t={};I.forEach(n=>{const i=n.provider||n.providerType||"未知",R=h(i);t[i]||(t[i]={id:i,displayName:R}),r[i]||(r[i]=[]),r[i].push(n)});const y=Object.values(t);return y.sort((n,i)=>n.displayName.localeCompare(i.displayName)),{groups:r,providers:y}},[I,h]),P=o.useCallback((r,t)=>{C(t)},[]),L=o.useCallback(r=>{p(r)},[p]);return a.jsxs(_,{open:c,onClose:x,fullScreen:d,maxWidth:"sm",fullWidth:!0,slotProps:{paper:{sx:v.dialogPaper(d)}},children:[a.jsxs(B,{sx:v.dialogTitle,children:["选择模型",a.jsx(O,{edge:"end",onClick:x,"aria-label":"close",children:a.jsx(Y,{})})]}),a.jsx($,{}),a.jsx(k,{sx:{p:2,pb:1},children:a.jsx(z,{fullWidth:!0,size:"small",placeholder:"搜索模型...",value:m,onChange:N,InputProps:{startAdornment:a.jsx(Z,{position:"start",children:a.jsx(q,{size:20})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),a.jsx(k,{sx:v.tabsContainer,children:a.jsxs(J,{value:u,onChange:P,variant:"scrollable",scrollButtons:"auto","aria-label":"model provider tabs",children:[a.jsx(S,{label:"全部",value:"all"}),M.providers.map(r=>a.jsx(S,{label:r.displayName,value:r.id},r.id))]})}),a.jsx(G,{sx:v.dialogContent,children:a.jsx(V,{sx:v.list,children:u==="all"?I.map(r=>a.jsx(w,{model:r,isSelected:e?.id===r.id&&e?.provider===r.provider,onSelect:()=>L(r),providerDisplayName:h(r.provider||r.providerType||"未知"),providers:b},`${r.id}-${r.provider}`)):M.groups[u]?.map(r=>a.jsx(w,{model:r,isSelected:e?.id===r.id&&e?.provider===r.provider,onSelect:()=>L(r),providerDisplayName:h(r.provider||r.providerType||"未知"),providers:b},`${r.id}-${r.provider}`))})})]})},w=D.memo(({model:e,isSelected:s,onSelect:p,providerDisplayName:T,providers:x})=>{const c=E(),l=o.useMemo(()=>c.palette.mode==="dark",[c.palette.mode]),d=o.useMemo(()=>x?.find(j=>j.id===(e.provider||e.providerType)),[x,e.provider,e.providerType]),u=o.useMemo(()=>g.listItem(s,l),[s,l]),C=o.useMemo(()=>g.avatar(d,s,c.palette.primary.main),[d,s,c.palette.primary.main]),m=o.useMemo(()=>g.primaryText(s),[s]);return a.jsxs(X,{onClick:p,sx:{...u,cursor:"pointer","&:hover":{...u["&:hover"],backgroundColor:s?l?"rgba(144, 202, 249, 0.16)":"rgba(25, 118, 210, 0.08)":l?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)"}},children:[a.jsx(F,{sx:g.listItemIcon,children:a.jsx(H,{sx:C,children:d?.avatar||T[0]})}),a.jsx(Q,{primary:e.name,secondary:e.description||`${T}模型`,slotProps:{primary:m,secondary:g.secondaryText}}),s&&a.jsx(K,{color:"primary",fontSize:"small"})]})});export{or as D};
