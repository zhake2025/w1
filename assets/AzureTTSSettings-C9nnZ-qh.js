import{r as u,j as e,d as S,H as h,G as Z,I as O,br as J,J as m,S as x,K as s,L as y,B as f,N as q,af as X,ag as V,u as Q,ae as o,A as $,T as ee,b as ae,f as le,a as D,g as re,P as te,e as ue,ad as i}from"./index-BFQp9Otg.js";import{TTSService as se}from"./TTSService-BBlDDpe4.js";import{S as oe}from"./Stack-CItDq_hs.js";import{E as ie}from"./eye-off-dxYQvFn2.js";import{T as ne}from"./TTSTestSection-CHxUs3GS.js";import"./useThemeProps-CgvgVSEB.js";import"./volume-2-BJhvHOCX.js";const ce=[{value:"eastus",label:"美国东部 (East US)"},{value:"westus",label:"美国西部 (West US)"},{value:"westus2",label:"美国西部2 (West US 2)"},{value:"eastus2",label:"美国东部2 (East US 2)"},{value:"southeastasia",label:"东南亚 (Southeast Asia)"},{value:"westeurope",label:"西欧 (West Europe)"},{value:"northeurope",label:"北欧 (North Europe)"},{value:"japaneast",label:"日本东部 (Japan East)"},{value:"australiaeast",label:"澳大利亚东部 (Australia East)"},{value:"centralindia",label:"印度中部 (Central India)"}],de=[{value:"zh-CN-XiaoxiaoNeural",label:"晓晓 (女性，温柔甜美)"},{value:"zh-CN-YunxiNeural",label:"云希 (男性，成熟稳重)"},{value:"zh-CN-YunjianNeural",label:"云健 (男性，年轻活力)"},{value:"zh-CN-XiaoyiNeural",label:"晓伊 (女性，亲切自然)"},{value:"zh-CN-YunyangNeural",label:"云扬 (男性，新闻播报)"},{value:"zh-CN-XiaochenNeural",label:"晓辰 (女性，温暖治愈)"},{value:"zh-CN-XiaohanNeural",label:"晓涵 (女性，严肃正式)"},{value:"zh-CN-XiaomengNeural",label:"晓梦 (女性，可爱活泼)"},{value:"zh-CN-XiaomoNeural",label:"晓墨 (女性，知性优雅)"},{value:"zh-CN-XiaoqiuNeural",label:"晓秋 (女性，成熟知性)"},{value:"zh-CN-XiaoruiNeural",label:"晓睿 (女性，亲和力强)"},{value:"zh-CN-XiaoshuangNeural",label:"晓双 (女性，年轻甜美)"},{value:"zh-CN-XiaoxuanNeural",label:"晓萱 (女性，温柔体贴)"},{value:"zh-CN-XiaoyanNeural",label:"晓颜 (女性，清新自然)"},{value:"zh-CN-XiaoyouNeural",label:"晓悠 (女性，悠扬动听)"},{value:"zh-CN-XiaozhenNeural",label:"晓甄 (女性，专业严谨)"},{value:"zh-CN-YunfengNeural",label:"云枫 (男性，磁性深沉)"},{value:"zh-CN-YunhaoNeural",label:"云皓 (男性，阳光开朗)"},{value:"zh-CN-YunxiaNeural",label:"云夏 (男性，清新自然)"},{value:"zh-CN-YunyeNeural",label:"云野 (男性，豪放不羁)"},{value:"zh-CN-YunzeNeural",label:"云泽 (男性，温润如玉)"},{value:"en-US-JennyNeural",label:"Jenny (女性，美式英语)"},{value:"en-US-GuyNeural",label:"Guy (男性，美式英语)"},{value:"en-US-AriaNeural",label:"Aria (女性，美式英语)"},{value:"en-US-DavisNeural",label:"Davis (男性，美式英语)"}],he=[{value:"audio-24khz-160kbitrate-mono-mp3",label:"MP3 24kHz 160kbps (推荐)"},{value:"audio-24khz-96kbitrate-mono-mp3",label:"MP3 24kHz 96kbps"},{value:"audio-16khz-128kbitrate-mono-mp3",label:"MP3 16kHz 128kbps"},{value:"webm-24khz-16bit-mono-opus",label:"WebM Opus 24kHz"},{value:"ogg-24khz-16bit-mono-opus",label:"OGG Opus 24kHz"},{value:"riff-24khz-16bit-mono-pcm",label:"WAV 24kHz 16bit"},{value:"riff-16khz-16bit-mono-pcm",label:"WAV 16kHz 16bit"}],be=[{value:"general",label:"通用 (默认)"},{value:"cheerful",label:"愉快开心"},{value:"sad",label:"悲伤沮丧"},{value:"angry",label:"愤怒生气"},{value:"fearful",label:"恐惧害怕"},{value:"disgruntled",label:"不满抱怨"},{value:"serious",label:"严肃正经"},{value:"affectionate",label:"亲切关爱"},{value:"gentle",label:"温柔体贴"},{value:"embarrassed",label:"尴尬羞涩"},{value:"calm",label:"平静冷静"}],ve=[{value:"default",label:"默认"},{value:"Girl",label:"女孩"},{value:"Boy",label:"男孩"},{value:"YoungAdultFemale",label:"年轻女性"},{value:"YoungAdultMale",label:"年轻男性"},{value:"OlderAdultFemale",label:"成年女性"},{value:"OlderAdultMale",label:"成年男性"},{value:"SeniorFemale",label:"老年女性"},{value:"SeniorMale",label:"老年男性"}],me=({settings:t,onSettingsChange:a})=>{const z=u.useCallback(l=>{a({...t,apiKey:l})},[t,a]),c=u.useCallback(()=>{a({...t,showApiKey:!t.showApiKey})},[t,a]),k=u.useCallback(l=>{a({...t,region:l})},[t,a]),r=u.useCallback(l=>{a({...t,voiceName:l})},[t,a]),T=u.useCallback(l=>{a({...t,outputFormat:l})},[t,a]),b=u.useCallback(l=>{a({...t,rate:l})},[t,a]),p=u.useCallback(l=>{a({...t,pitch:l})},[t,a]),g=u.useCallback(l=>{a({...t,volume:l})},[t,a]),N=u.useCallback(l=>{a({...t,style:l})},[t,a]),j=u.useCallback(l=>{a({...t,styleDegree:l})},[t,a]),w=u.useCallback(l=>{a({...t,role:l})},[t,a]),A=u.useCallback(l=>{a({...t,useSSML:l})},[t,a]),_=u.useCallback(l=>{l.preventDefault()},[]);return e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:"subtitle1",sx:{mb:2,fontWeight:600},children:"微软Azure TTS API 设置"}),e.jsx("form",{onSubmit:_,children:e.jsxs(oe,{spacing:3,children:[e.jsx(h,{fullWidth:!0,variant:"outlined",children:e.jsx(Z,{label:"Azure API密钥",variant:"outlined",value:t.apiKey,onChange:l=>z(l.target.value),type:t.showApiKey?"text":"password",placeholder:"请输入Azure Speech Services API密钥",helperText:"获取API密钥请访问：https://portal.azure.com/",slotProps:{input:{endAdornment:e.jsx(O,{onClick:c,edge:"end",children:t.showApiKey?e.jsx(ie,{}):e.jsx(J,{})})}},sx:{mb:2}})}),e.jsxs(h,{fullWidth:!0,children:[e.jsx(m,{children:"服务区域"}),e.jsx(x,{value:t.region,onChange:l=>k(l.target.value),label:"服务区域",MenuProps:{disableAutoFocus:!0,disableRestoreFocus:!0},children:ce.map(l=>e.jsx(s,{value:l.value,children:l.label},l.value))}),e.jsx(y,{children:"选择离您最近的Azure服务区域以获得最佳性能"})]}),e.jsxs(h,{fullWidth:!0,children:[e.jsx(m,{children:"语音选择"}),e.jsx(x,{value:t.voiceName,onChange:l=>r(l.target.value),label:"语音选择",MenuProps:{disableAutoFocus:!0,disableRestoreFocus:!0},children:de.map(l=>e.jsx(s,{value:l.value,children:l.label},l.value))}),e.jsx(y,{children:"选择您喜欢的语音风格，Neural语音支持更多表达风格"})]}),e.jsxs(h,{fullWidth:!0,children:[e.jsx(m,{children:"输出格式"}),e.jsx(x,{value:t.outputFormat,onChange:l=>T(l.target.value),label:"输出格式",children:he.map(l=>e.jsx(s,{value:l.value,children:l.label},l.value))}),e.jsx(y,{children:"推荐使用MP3格式，兼容性最好"})]}),e.jsxs(f,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(h,{fullWidth:!0,children:[e.jsx(m,{children:"语速"}),e.jsxs(x,{value:t.rate,onChange:l=>b(l.target.value),label:"语速",children:[e.jsx(s,{value:"x-slow",children:"很慢"}),e.jsx(s,{value:"slow",children:"慢"}),e.jsx(s,{value:"medium",children:"正常"}),e.jsx(s,{value:"fast",children:"快"}),e.jsx(s,{value:"x-fast",children:"很快"})]})]}),e.jsxs(h,{fullWidth:!0,children:[e.jsx(m,{children:"音调"}),e.jsxs(x,{value:t.pitch,onChange:l=>p(l.target.value),label:"音调",children:[e.jsx(s,{value:"x-low",children:"很低"}),e.jsx(s,{value:"low",children:"低"}),e.jsx(s,{value:"medium",children:"正常"}),e.jsx(s,{value:"high",children:"高"}),e.jsx(s,{value:"x-high",children:"很高"})]})]})]}),e.jsxs(f,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(h,{fullWidth:!0,children:[e.jsx(m,{children:"音量"}),e.jsxs(x,{value:t.volume,onChange:l=>g(l.target.value),label:"音量",children:[e.jsx(s,{value:"silent",children:"静音"}),e.jsx(s,{value:"x-soft",children:"很轻"}),e.jsx(s,{value:"soft",children:"轻"}),e.jsx(s,{value:"medium",children:"正常"}),e.jsx(s,{value:"loud",children:"响"}),e.jsx(s,{value:"x-loud",children:"很响"})]})]}),e.jsxs(h,{fullWidth:!0,children:[e.jsx(m,{children:"说话风格"}),e.jsx(x,{value:t.style,onChange:l=>N(l.target.value),label:"说话风格",children:be.map(l=>e.jsx(s,{value:l.value,children:l.label},l.value))})]})]}),e.jsxs(h,{fullWidth:!0,children:[e.jsx(S,{gutterBottom:!0,children:"风格强度"}),e.jsx(q,{value:t.styleDegree,min:.01,max:2,step:.01,onChange:(l,C)=>j(C),valueLabelDisplay:"auto",marks:[{value:.01,label:"0.01"},{value:1,label:"1.0"},{value:2,label:"2.0"}]}),e.jsx(y,{children:"调整说话风格的强度 (0.01-2.0，默认1.0)"})]}),e.jsxs(h,{fullWidth:!0,children:[e.jsx(m,{children:"角色扮演"}),e.jsx(x,{value:t.role,onChange:l=>w(l.target.value),label:"角色扮演",children:ve.map(l=>e.jsx(s,{value:l.value,children:l.label},l.value))}),e.jsx(y,{children:"选择语音的角色扮演风格"})]}),e.jsx(X,{control:e.jsx(V,{checked:t.useSSML,onChange:l=>A(l.target.checked)}),label:"使用SSML标记语言"}),e.jsx(y,{children:"启用SSML可以获得更精细的语音控制，包括语速、音调、停顿等效果"})]})})]})},je=()=>{const t=Q(),a=u.useMemo(()=>se.getInstance(),[]),z=u.useRef(null),c=u.useRef(null),k=u.useRef(null),[r,T]=u.useState({apiKey:"",showApiKey:!1,region:"eastus",voiceName:"zh-CN-XiaoxiaoNeural",language:"zh-CN",outputFormat:"audio-24khz-160kbitrate-mono-mp3",rate:"medium",pitch:"medium",volume:"medium",style:"general",styleDegree:1,role:"default",useSSML:!0}),[b,p]=u.useState({saveError:"",isTestPlaying:!1}),[g,N]=u.useState("你好，我是微软Azure语音合成服务，感谢你的使用！"),[j,w]=u.useState(!0),[A,_]=u.useState(!1);u.useEffect(()=>{(async()=>{try{const v=await i("azure_tts_api_key")||"",d=await i("azure_tts_region")||"eastus",R=await i("azure_tts_voice")||"zh-CN-XiaoxiaoNeural",P=await i("azure_tts_language")||"zh-CN",E=await i("azure_tts_format")||"audio-24khz-160kbitrate-mono-mp3",F=await i("azure_tts_rate")||"medium",I=await i("azure_tts_pitch")||"medium",M=await i("azure_tts_volume")||"medium",U=await i("azure_tts_style")||"general",L=parseFloat(await i("azure_tts_style_degree")||"1.0"),K=await i("azure_tts_role")||"default",W=await i("azure_tts_use_ssml")!=="false",H=await i("enable_tts")!=="false",G=await i("selected_tts_service")||"siliconflow";T({apiKey:v,showApiKey:!1,region:d,voiceName:R,language:P,outputFormat:E,rate:F,pitch:I,volume:M,style:U,styleDegree:L,role:K,useSSML:W}),w(H),_(G==="azure"),a.setAzureApiKey(v),a.setAzureRegion(d),a.setAzureVoiceName(R),a.setAzureLanguage(P),a.setAzureOutputFormat(E),a.setAzureRate(F),a.setAzurePitch(I),a.setAzureVolume(M),a.setAzureStyle(U),a.setAzureStyleDegree(L),a.setAzureRole(K),a.setAzureUseSSML(W)}catch(v){console.error("加载Azure TTS设置失败:",v)}})()},[a]);const l=u.useCallback(async()=>{try{await o("azure_tts_api_key",r.apiKey),await o("azure_tts_region",r.region),await o("azure_tts_voice",r.voiceName),await o("azure_tts_language",r.language),await o("azure_tts_format",r.outputFormat),await o("azure_tts_rate",r.rate),await o("azure_tts_pitch",r.pitch),await o("azure_tts_volume",r.volume),await o("azure_tts_style",r.style),await o("azure_tts_style_degree",r.styleDegree.toString()),await o("azure_tts_role",r.role),await o("azure_tts_use_ssml",r.useSSML.toString()),await o("enable_tts",j.toString()),A?(await o("selected_tts_service","azure"),await o("use_azure_tts","true"),await o("use_openai_tts","false")):await o("use_azure_tts","false"),a.setAzureApiKey(r.apiKey),a.setAzureRegion(r.region),a.setAzureVoiceName(r.voiceName),a.setAzureLanguage(r.language),a.setAzureOutputFormat(r.outputFormat),a.setAzureRate(r.rate),a.setAzurePitch(r.pitch),a.setAzureVolume(r.volume),a.setAzureStyle(r.style),a.setAzureStyleDegree(r.styleDegree),a.setAzureRole(r.role),a.setAzureUseSSML(r.useSSML),A?(a.setUseAzure(!0),a.setUseOpenAI(!1)):a.setUseAzure(!1),z.current&&clearTimeout(z.current),setTimeout(()=>{t("/settings/voice")},0)}catch(n){console.error("保存Azure TTS设置失败:",n),p(v=>({...v,saveError:"保存设置失败，请重试"}))}},[r,j,A,a]),C=u.useCallback(n=>{_(n)},[]),B=u.useCallback(async()=>{if(b.isTestPlaying){a.stop(),c.current&&clearInterval(c.current),p(d=>({...d,isTestPlaying:!1}));return}p(d=>({...d,isTestPlaying:!0})),a.setUseAzure(!0),a.setUseOpenAI(!1),a.setAzureApiKey(r.apiKey),a.setAzureRegion(r.region),a.setAzureVoiceName(r.voiceName),a.setAzureLanguage(r.language),a.setAzureOutputFormat(r.outputFormat),a.setAzureRate(r.rate),a.setAzurePitch(r.pitch),a.setAzureVolume(r.volume),a.setAzureStyle(r.style),a.setAzureStyleDegree(r.styleDegree),a.setAzureRole(r.role),a.setAzureUseSSML(r.useSSML),await a.speak(g)||p(d=>({...d,isTestPlaying:!1})),c.current&&clearInterval(c.current);const v=()=>{a.getIsPlaying()?c.current=setTimeout(v,1e3):(p(d=>({...d,isTestPlaying:!1})),c.current&&(clearInterval(c.current),c.current=null))};setTimeout(v,1e3)},[b.isTestPlaying,r,g,a]),Y=()=>{t("/settings/voice")};return u.useEffect(()=>()=>{z.current&&clearTimeout(z.current),c.current&&clearInterval(c.current),k.current&&clearTimeout(k.current),b.isTestPlaying&&a.stop()},[b.isTestPlaying,a]),e.jsxs(f,{sx:{display:"flex",flexDirection:"column",height:"100vh",width:"100vw",overflow:"hidden",bgcolor:"background.default"},children:[e.jsx($,{position:"fixed",elevation:0,sx:{zIndex:n=>n.zIndex.drawer+1,bgcolor:"background.paper",color:"text.primary",borderBottom:1,borderColor:"divider",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",background:"rgba(255, 255, 255, 0.8)","@media (prefers-color-scheme: dark)":{background:"rgba(18, 18, 18, 0.8)"}},children:e.jsxs(ee,{sx:{minHeight:{xs:56,sm:64},px:{xs:1,sm:2,md:3}},children:[e.jsx(O,{edge:"start",onClick:Y,"aria-label":"返回",size:"large",sx:{color:"primary.main",mr:{xs:1,sm:2},"&:hover":{bgcolor:"primary.main",color:"primary.contrastText",transform:"scale(1.05)"},transition:"all 0.2s ease-in-out"},children:e.jsx(ae,{size:20})}),e.jsx(S,{variant:"h6",component:"div",sx:{flexGrow:1,fontWeight:600,backgroundImage:"linear-gradient(90deg, #9333EA, #754AB4)",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent"},children:"微软Azure TTS 设置"}),e.jsx(le,{onClick:l,variant:"contained",sx:{bgcolor:"primary.main",color:"primary.contrastText","&:hover":{bgcolor:"primary.dark"},borderRadius:2,px:3},children:"保存"})]})}),e.jsx(f,{sx:{flexGrow:1,overflowY:"auto",p:2,mt:8,bgcolor:n=>n.palette.mode==="light"?D(n.palette.primary.main,.02):D(n.palette.background.default,.9),"&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.1)",borderRadius:"3px"}},children:e.jsxs(f,{sx:{width:"100%"},children:[b.saveError&&e.jsx(re,{severity:"error",sx:{mb:{xs:1.5,sm:2},borderRadius:{xs:1,sm:2}},children:b.saveError}),e.jsxs(te,{elevation:0,sx:{p:3,mb:3,borderRadius:2,border:"1px solid",borderColor:"divider",background:"background.paper",boxShadow:"0 4px 12px rgba(0,0,0,0.05)"},children:[e.jsx(S,{variant:"h6",sx:{mb:3,fontWeight:600},children:"API配置"}),e.jsxs(f,{sx:{mb:3},children:[e.jsx(X,{control:e.jsx(V,{checked:A,onChange:n=>C(n.target.checked)}),label:"启用微软Azure TTS 服务"}),e.jsx(S,{variant:"body2",color:"text.secondary",sx:{mt:1,ml:4},children:"启用后，此服务将成为默认的文本转语音服务。启用其他TTS服务会自动禁用此服务。"})]}),e.jsx(ue,{sx:{mb:3}}),e.jsx(me,{settings:r,onSettingsChange:T})]}),e.jsx(ne,{testText:g,setTestText:N,handleTestTTS:B,isTestPlaying:b.isTestPlaying,enableTTS:j,selectedTTSService:"azure",openaiApiKey:"",azureApiKey:r.apiKey,siliconFlowApiKey:""})]})})]})};export{je as default};
