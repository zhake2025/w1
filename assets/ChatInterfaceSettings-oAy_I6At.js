import{db as Q,dk as V,r as w,b8 as Z,j as e,bc as ee,bd as ae,be as se,u as te,a6 as oe,bn as re,B as n,a as D,A as le,T as ne,I as M,b as ie,d as o,P as g,aj as P,ak as R,H as j,J as v,S as y,K as u,ai as U,af as z,ag as F,f as E,a3 as ce,aP as de,g as ue,N as xe,$ as l}from"./index-5OteHtpV.js";import{g as he,a as me,b as pe,c as T,v as be,d as ge}from"./backgroundUtils-Dcy3kyPL.js";import{u as je}from"./useScrollPosition-DBZJSISC.js";import{C as ve}from"./Card-0S04eo67.js";import{C as ye}from"./CardActions-DtoYwIKo.js";import{I as Ce}from"./image-XaM80MAg.js";function fe(i){return Q("MuiCardMedia",i)}V("MuiCardMedia",["root","media","img"]);const ke=i=>{const{classes:t,isMediaComponent:r,isImageComponent:c}=i;return se({root:["root",r&&"media",c&&"img"]},fe,t)},Be=ee("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(i,t)=>{const{ownerState:r}=i,{isMediaComponent:c,isImageComponent:m}=r;return[t.root,c&&t.media,m&&t.img]}})({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",variants:[{props:{isMediaComponent:!0},style:{width:"100%"}},{props:{isImageComponent:!0},style:{objectFit:"cover"}}]}),Me=["video","audio","picture","iframe","img"],we=["picture","img"],Ie=w.forwardRef(function(t,r){const c=Z({props:t,name:"MuiCardMedia"}),{children:m,className:C,component:d="div",image:x,src:f,style:h,...I}=c,p=Me.includes(d),S=!p&&x?{backgroundImage:`url("${x}")`,...h}:h,k={...c,component:d,isMediaComponent:p,isImageComponent:we.includes(d)},s=ke(k);return e.jsx(Be,{className:ae(s.root,C),as:d,role:!p&&x?"img":void 0,ref:r,style:S,ownerState:k,src:p?x||f:void 0,...I,children:m})}),Ae=()=>{const i=te(),t=oe(),r=re(a=>a.settings),{containerRef:c,handleScroll:m}=je("settings-chat-interface",{autoRestore:!0,restoreDelay:100}),[C,d]=w.useState(""),[x,f]=w.useState(!1),h=w.useRef(null),I=r.multiModelDisplayStyle||"horizontal",p=r.showToolDetails!==!1,S=r.showCitationDetails!==!1,k=r.showSystemPromptBubble!==!1,s=r.chatBackground||{enabled:!1,imageUrl:"",opacity:.3,size:"cover",position:"center",repeat:"no-repeat"},N=()=>{i("/settings/appearance")},G=a=>{t(l({multiModelDisplayStyle:a.target.value}))},W=a=>{t(l({showToolDetails:a.target.checked}))},O=a=>{t(l({showCitationDetails:a.target.checked}))},L=a=>{t(l({showSystemPromptBubble:a.target.value==="show"}))},_=a=>{t(l({chatBackground:{...s,enabled:a.target.checked}}))},J=(a,b)=>{t(l({chatBackground:{...s,opacity:b}}))},$=a=>{t(l({chatBackground:{...s,size:a.target.value}}))},H=a=>{t(l({chatBackground:{...s,position:a.target.value}}))},K=a=>{t(l({chatBackground:{...s,repeat:a.target.value}}))},X=async a=>{const b=a.target.files?.[0];if(b){d(""),f(!0);try{const B=be(b);if(!B.valid){d(B.error||"文件验证失败");return}const q=await ge(b);s.imageUrl&&T(s.imageUrl),t(l({chatBackground:{...s,imageUrl:q,enabled:!0}}))}catch(B){d("图片上传失败，请重试"),console.error("Background upload error:",B)}finally{f(!1),h.current&&(h.current.value="")}}},Y=()=>{s.imageUrl&&T(s.imageUrl),t(l({chatBackground:{...s,imageUrl:"",enabled:!1}}))},A=()=>{h.current?.click()};return e.jsxs(n,{sx:{flexGrow:1,display:"flex",flexDirection:"column",height:"100vh",bgcolor:a=>a.palette.mode==="light"?D(a.palette.primary.main,.02):D(a.palette.background.default,.9)},children:[e.jsx(le,{position:"fixed",elevation:0,sx:{zIndex:a=>a.zIndex.drawer+1,bgcolor:"background.paper",color:"text.primary",borderBottom:1,borderColor:"divider",backdropFilter:"blur(8px)"},children:e.jsxs(ne,{children:[e.jsx(M,{edge:"start",color:"inherit",onClick:N,"aria-label":"back",sx:{color:a=>a.palette.primary.main},children:e.jsx(ie,{size:20})}),e.jsx(o,{variant:"h6",component:"div",sx:{flexGrow:1,fontWeight:600,backgroundImage:"linear-gradient(90deg, #9333EA, #754AB4)",backgroundClip:"text",color:"transparent"},children:"聊天界面设置"})]})}),e.jsxs(n,{ref:c,onScroll:m,sx:{flexGrow:1,overflowY:"auto",p:{xs:1,sm:2},mt:8,"&::-webkit-scrollbar":{width:{xs:"4px",sm:"6px"}},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.1)",borderRadius:"3px"}},children:[e.jsxs(g,{elevation:0,sx:{mb:2,borderRadius:2,border:"1px solid",borderColor:"divider",overflow:"hidden",bgcolor:"background.paper",boxShadow:"0 4px 12px rgba(0,0,0,0.05)"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"subtitle1",children:"多模型对比显示"}),e.jsx(P,{title:"配置多模型对比时的布局方式",children:e.jsx(M,{size:"small",sx:{ml:1},children:e.jsx(R,{size:16})})})]}),e.jsxs(j,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(v,{children:"布局方式"}),e.jsxs(y,{value:I,onChange:G,label:"布局方式",MenuProps:{disableAutoFocus:!0,disableRestoreFocus:!0},children:[e.jsx(u,{value:"horizontal",children:"水平布局（默认）"}),e.jsx(u,{value:"vertical",children:"垂直布局（并排显示）"}),e.jsx(u,{value:"single",children:"单独布局（堆叠显示）"})]})]}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"设置多模型对比时的布局方式。水平布局将模型响应并排显示，垂直布局将模型响应上下排列，单独布局将模型响应堆叠显示。"})]}),e.jsxs(g,{elevation:0,sx:{p:2,mb:3,border:"1px solid #eee"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"subtitle1",children:"工具调用设置"}),e.jsx(P,{title:"配置工具调用的显示详情",children:e.jsx(M,{size:"small",sx:{ml:1},children:e.jsx(R,{size:16})})})]}),e.jsx(U,{children:e.jsx(z,{control:e.jsx(F,{checked:p,onChange:W}),label:"显示工具调用详情"})}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"控制是否显示工具调用的详细信息，包括调用参数和返回结果。"})]}),e.jsxs(g,{elevation:0,sx:{p:2,mb:3,border:"1px solid #eee"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"subtitle1",children:"引用设置"}),e.jsx(P,{title:"配置引用的显示详情",children:e.jsx(M,{size:"small",sx:{ml:1},children:e.jsx(R,{size:16})})})]}),e.jsx(U,{children:e.jsx(z,{control:e.jsx(F,{checked:S,onChange:O}),label:"显示引用详情"})}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"控制是否显示引用的详细信息，包括引用来源和相关内容。"})]}),e.jsxs(g,{elevation:0,sx:{p:2,mb:3,border:"1px solid #eee"},children:[e.jsx(o,{variant:"subtitle1",sx:{mb:2},children:"系统提示词气泡设置"}),e.jsxs(j,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(v,{id:"prompt-bubble-style-label",children:"系统提示词气泡显示"}),e.jsxs(y,{labelId:"prompt-bubble-style-label",value:k?"show":"hide",onChange:L,label:"系统提示词气泡显示",MenuProps:{disableAutoFocus:!0,disableRestoreFocus:!0},children:[e.jsx(u,{value:"show",children:"显示"}),e.jsx(u,{value:"hide",children:"隐藏"})]})]}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"控制是否在聊天界面顶部显示系统提示词气泡。系统提示词气泡可以帮助您查看和编辑当前会话的系统提示词。"})]}),e.jsxs(g,{elevation:0,sx:{p:2,mb:3,border:"1px solid #eee"},children:[e.jsx(o,{variant:"subtitle1",sx:{mb:2},children:"聊天背景设置"}),e.jsx(U,{sx:{mb:2},children:e.jsx(z,{control:e.jsx(F,{checked:s.enabled,onChange:_}),label:"启用自定义聊天背景"})}),e.jsxs(n,{sx:{mb:2},children:[e.jsx(o,{variant:"body2",sx:{mb:1},children:"背景图片"}),s.imageUrl?e.jsxs(ve,{sx:{maxWidth:200,mb:2},children:[e.jsx(Ie,{component:"img",height:"120",image:s.imageUrl,alt:"聊天背景预览",sx:{objectFit:"cover"}}),e.jsx(ye,{sx:{p:1},children:e.jsx(E,{size:"small",startIcon:e.jsx(ce,{size:16}),onClick:Y,color:"error",children:"移除"})})]}):e.jsxs(n,{sx:{border:"2px dashed #ccc",borderRadius:1,p:3,textAlign:"center",cursor:"pointer","&:hover":{borderColor:"primary.main",bgcolor:"action.hover"}},onClick:A,children:[e.jsx(Ce,{size:32,style:{color:"#ccc",marginBottom:8}}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"点击上传背景图片"}),e.jsx(o,{variant:"caption",color:"text.secondary",children:"支持 JPG、PNG、GIF、WebP 格式，最大 5MB"})]}),e.jsx("input",{ref:h,type:"file",accept:"image/*",onChange:X,style:{display:"none"}}),!s.imageUrl&&e.jsx(E,{variant:"outlined",startIcon:e.jsx(de,{size:16}),onClick:A,disabled:x,sx:{mt:1},children:x?"上传中...":"选择图片"}),C&&e.jsx(ue,{severity:"error",sx:{mt:1},children:C})]}),s.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{mb:2},children:[e.jsxs(o,{variant:"body2",sx:{mb:1},children:["背景透明度: ",Math.round(s.opacity*100),"%"]}),e.jsx(xe,{value:s.opacity,onChange:J,min:.1,max:1,step:.1,marks:[{value:.1,label:"10%"},{value:.5,label:"50%"},{value:1,label:"100%"}],sx:{mt:1}})]}),e.jsxs(j,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(v,{children:"背景尺寸"}),e.jsx(y,{value:s.size,onChange:$,label:"背景尺寸",MenuProps:{disableAutoFocus:!0,disableRestoreFocus:!0},children:he().map(a=>e.jsx(u,{value:a.value,children:e.jsxs(n,{children:[e.jsx(o,{variant:"body2",children:a.label}),e.jsx(o,{variant:"caption",color:"text.secondary",children:a.description})]})},a.value))})]}),e.jsxs(j,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(v,{children:"背景位置"}),e.jsx(y,{value:s.position,onChange:H,label:"背景位置",MenuProps:{disableAutoFocus:!0,disableRestoreFocus:!0},children:me().map(a=>e.jsx(u,{value:a.value,children:a.label},a.value))})]}),e.jsxs(j,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(v,{children:"背景重复"}),e.jsx(y,{value:s.repeat,onChange:K,label:"背景重复",MenuProps:{disableAutoFocus:!0,disableRestoreFocus:!0},children:pe().map(a=>e.jsx(u,{value:a.value,children:a.label},a.value))})]})]}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"自定义聊天界面背景图片。背景只会显示在聊天消息区域，不会影响顶部工具栏和侧边栏。消息气泡和其他界面元素会显示在背景之上。"})]}),e.jsx(n,{sx:{height:"20px"}})]})]})};export{Ae as default};
